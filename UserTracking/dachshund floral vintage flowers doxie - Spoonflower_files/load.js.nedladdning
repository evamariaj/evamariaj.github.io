var eiv = '2.0.0'; var exitintelAccount = 359;exitintelBetaStats = true;window.exitintelConfig = window.exitintelConfig || {}
            window.exitintelConfig.clientId = 359;
            window.exitintelConfig.skipPreloading = false;
            window.exitintelConfig.loadEvent = 'load';
        if (typeof window.exitintelLoaded === 'undefined' || !window.exitintelLoaded) {/* globals window, jQuery, document, Image, alert, XDomainRequest, Prototype, sessionStorage, atob */

(function(root, undefined) {

  "use strict";

  if (!Array.prototype.indexOf)
  {
    Array.prototype.indexOf = function(elt /*, from*/)
    {
      var len = this.length >>> 0;

      var from = Number(arguments[1]) || 0;
      from = (from < 0) ? Math.ceil(from) : Math.floor(from);
      if (from < 0) {
        from += len;
      }

      for (from = from; from < len; from++)
      {
        if (from in this && this[from] === elt) {
          return from;
        }
      }
      return -1;
    };
  }

  if (!Array.prototype.filter) {
    Array.prototype.filter = function(fun/*, thisArg*/) {

      if (this === void 0 || this === null) {
        throw new TypeError();
      }

      var t = Object(this);
      var len = t.length >>> 0;
      if (typeof fun !== 'function') {
        throw new TypeError();
      }

      var res = [];
      var thisArg = arguments.length >= 2 ? arguments[1] : void 0;
      for (var i = 0; i < len; i++) {
        if (i in t) {
          var val = t[i];

          if (fun.call(thisArg, val, i, t)) {
            res.push(val);
          }
        }
      }

      return res;
    };
  }



/* ei-snippet main */

var exitintel = {};

try {
  // Version.
  exitintel.VERSION = '1.5.0';



root.exitintelConfig = root.exitintelConfig || {};

exitintel.config = {
    apiURL: root.exitintelConfig.apiURL || '//app3.exitintel.com/api/v1',
    cdnURL: root.exitintelConfig.cdnURL || '//cdn2.exitintel.com/api/v1',
    profilerLibURL: 'http://52.6.28.228:3333/socket.io/socket.io.js',
		profilerURL: 'http://52.6.28.228:3333/',
		integrationsApiUrl: root.exitintelConfig.integrationsApiURL || 'https://app3.exitintel.com/integrations',
    reportURL: root.exitintelConfig.reportURL || 'https://oroqbbwxk3.execute-api.us-east-1.amazonaws.com/production/send',
    compatibleJQueryVersions: "2.1.4 2.1.3 2.1.1 2.1.0 2.0.3 2.0.2 2.0.1 2.0.0 1.11.3 1.11.2 1.11.1 1.11.0 1.10.2 1.10.1 1.10.0 1.9.1 1.9.0 1.8.3 1.8.2 1.8.1 1.8.0 1.7.2 1.7.1 1.7.0".split(' '),
    cookieExpirationDays: 1825, // 5 years
    debug: false,
    clientId: null,
    whitelabel: true, // default. Will be overwritten when loading account,
    brandingType: 'standard', // default. Will be overwritten when loading account,
    primaryBrandColor: '#333', // default. Will be overwritten when loading account,
    schemaVersion: 2,
    profilerEnabled: root.exitintelConfig.profilerEnabled || false,
    skipPreloading: root.exitintelConfig.skipPreloading || false,
    prefetchedConfiguration: root.exitintelConfig.prefetchedConfiguration || false,
    storageEngine: root.exitintelConfig.storageEngine || 'cookie-domain',
    cookieStorageEngine: root.exitintelConfig.cookieStorageEngine || 'cookie-domain',
    audiences: [],
    disabled: false,
    historyKeepLastNPageviews: 14
};

/*global localStorage, navigator */

exitintel.util = {

  jQuery: null,

  detectDevice: {}, // loaded by dependencies/isMobile.js

  loadJQuery: function (callback) {

      if (window.jQei && window.jQei.fn && exitintel.util.isJQueryCompatible(window.jQei)) {
        exitintel.util.jQuery = window.jQei;

        callback(exitintel.util.jQuery);
        exitintel.util.log('Using legacy snippet jQuery.');
        return;
      }

      if (typeof window.jQuery == 'undefined' || !exitintel.util.isJQueryCompatible(window.jQuery)) {

          exitintel.util.log('Loading jQuery');

          exitintel.util.loadJS('//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js', function () {
            exitintel.util.log('jQuery loaded (' + jQuery.fn.jquery + ')');
            var jq = jQuery.noConflict(true);
            exitintel.util.jQuery = jq;
            callback(exitintel.util.jQuery);
          });

          return;
      }

      exitintel.util.jQuery = window.jQuery;
      callback(exitintel.util.jQuery);

      exitintel.util.log('jQuery already loaded');
  },

  loadJS: function (url, callback) {
      var head = document.getElementsByTagName('head')[0];
      var script = document.createElement('script');
      script.type = 'text/javascript';
      script.src = url;

      if (typeof script.onreadystatechange !== 'undefined') {
        script.onreadystatechange = function () {
          if (script.readyState == 'complete' || script.readyState == 'loaded') {
            setTimeout(callback, 100);
          }
        };
      } else {
        script.onload = callback;
      }

      head.appendChild(script);
  },

  onDOMReady: function (callback) {

    if (document.readyState && ['complete'].indexOf(document.readyState) !== -1) {
      callback();
    }

    // Mozilla, Opera and Webkit
    if (document.addEventListener) {
      document.addEventListener("DOMContentLoaded", callback, false);

    // If IE event model is used
    } else if (document.attachEvent) {
      document.attachEvent("onreadystatechange", function() {
        if (document.readyState === "complete" ) {
          callback();
        }
      });

    // A fallback to window.onload, that will always work
    } else {
      var oldOnload = window.onload;
      window.onload = function () {
        if (oldOnload) {
          oldOnload();
        }
        callback();
      };
    }
  },

  loadCSS: function () {

  },

  getUniqueId: function () {
    var d = new Date().getTime();
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        var r = (d + Math.random()*16)%16 | 0;
        d = Math.floor(d/16);
        return (c=='x' ? r : (r&0x3|0x8)).toString(16);
    });
    return uuid;
  },

  log: function (message) {
      if (exitintel.config.debug) {
          console.log(message);
      }
  },

  warn: function (message) {
      if (exitintel.config.debug) {
          console.warn(message);
      }
  },

  error: function (message) {
      if (exitintel.config.debug) {
          console.error(message);
      }
  },

  pageURLIs: function (url) {

    var strings = url.toLowerCase().split(',');

    for (var i = 0; i < strings.length; i++) {
      var u = strings[i].trim();

      if (document.URL.toLowerCase() == u) {
        return true;
      }
    }

    return false;
  },

  pageURLContains: function (string) {

    var strings = string.toLowerCase().split(',');

    for (var i = 0; i < strings.length; i++) {
      var s = strings[i].trim();
      if (document.URL.toLowerCase().indexOf(s) > -1) {
        return true;
      }
    }

    return false;
  },

  referrerURLIs: function (url) {

    var strings = url.toLowerCase().split(',');

    for (var i = 0; i < strings.length; i++) {
      var u = strings[i].trim();

      if (exitintel.visitor.session.originalReferrer.toLowerCase() == u) {
        return true;
      }
    }

    return false;
  },

  referrerURLContains: function (string) {

    var strings = string.toLowerCase().split(',');

    for (var i = 0; i < strings.length; i++) {
      var s = strings[i].trim();

      if (exitintel.visitor.session.originalReferrer.toLowerCase().indexOf(s) > -1) {
        return true;
      }
    }

    return false;
  },

  landingPageURLIs: function (url) {

    var strings = url.toLowerCase().split(',');

    for (var i = 0; i < strings.length; i++) {
      var u = strings[i].trim();

      if (exitintel.visitor.session.landingPage.toLowerCase() == u) {
        return true;
      }
    }

    return false;
  },

  landingPageURLContains: function (string) {
    var strings = string.toLowerCase().split(',');

    for (var i = 0; i < strings.length; i++) {
      var u = strings[i].trim();

      if (exitintel.visitor.session.landingPage.toLowerCase().indexOf(u) > -1) {
        return true;
      }
    }

    return false;
  },

  pagePathIs: function (url) {

    var strings = url.toLowerCase().split(',');

    for (var i = 0; i < strings.length; i++) {
      var u = strings[i].trim();

      if (window.location.pathname.toLowerCase() == u) {
        return true;
      }
    }

    return false;
  },

  pagePathContains: function (string) {

    var strings = string.toLowerCase().split(',');

    for (var i = 0; i < strings.length; i++) {
      var s = strings[i].trim();
      if (window.location.pathname.toLowerCase().indexOf(s) > -1) {
        return true;
      }
    }

    return false;
  },

  visitedURLIs: function (url) {

    var strings = url.toLowerCase().split(',');

    return strings.map(function (s) {
      return exitintel.visitorHistory.hasBeenToUrlThatIs(s.trim());
    });
  },

  visitedURLIsNot: function (url) {

    var strings = url.toLowerCase().split(',');

    return strings.map(function (s) {
      return exitintel.visitorHistory.hasBeenToUrlThatIsNot(s.trim());
    });
  },

  visitedURLContains: function (string) {

    var strings = string.toLowerCase().split(',');

    return strings.map(function (s) {
      return exitintel.visitorHistory.hasBeenToUrlThatContains(s.trim());
    });
  },

  visitedURLNotContains: function (string) {

    var strings = string.toLowerCase().split(',');

    return strings.map(function (s) {
      return exitintel.visitorHistory.hasBeenToUrlThatNotContains(s.trim());
    });
  },

  preloadImage: function (url) {
    var d = new exitintel.util.jQuery.Deferred();

    var img = new Image();
    img.onload = function () {
      d.resolve();
    };

    img.src = url;

    return d;
  },

  getDayOffset: function (days) {
    if (!days) {
      return null;
    }

    var now = Math.floor((new Date()).getTime() / 1000);

    var expires = now + (days * 3600 * 24);

    return expires;
  },

  ieVersion: function() {

    var undef,
        v = 3,
        div = document.createElement('div'),
        all = div.getElementsByTagName('i');

    while (
        div.innerHTML = '<!--[if gt IE ' + (++v) + ']><i></i><![endif]-->',
        all[0]
    ) {
    }

    return v > 4 ? v : undef;

  },

  iOSversion: function() {
    if (/iP(hone|od|ad)/.test(navigator.appVersion)) {
      var v = (navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);
      return [parseInt(v[1], 10), parseInt(v[2], 10), parseInt(v[3] || 0, 10)];
    }

    return false;
  },

  isPlaceholderSupported: function () {
    var isOperaMini = Object.prototype.toString.call(window.operamini) == '[object OperaMini]';
    var isPlaceholderSupported = 'placeholder' in document.createElement('input') && !isOperaMini;

    return isPlaceholderSupported;
  },

  campaignCookieWithinTimeOffset: function (campaignCookiePart, offsetFrom, offsetTo) {
    var now = Math.floor((new Date()).getTime() / 1000);

    // > than offset from
    if (offsetFrom && campaignCookiePart.timestamp && campaignCookiePart.timestamp + offsetFrom * 24 * 3600 > now) {
      return false;
    }

    // < than offset to
    if (offsetTo && campaignCookiePart.timestamp && campaignCookiePart.timestamp + offsetTo * 24 * 3600 < now) {
      return false;
    }

    return true;
  },

  getPublicationId: function () {
    var pubId = exitintel.storage.get('publication');
    if (!pubId) {
      return null;
    }

    return pubId;
  },

  sizeFormat: function (size) {

    // preformatted (px or %)
    if (typeof size === 'string' && (size.match(/px/) || size.match(/%/))) {
      return size;
    }

    // number
    return size + 'px';
  },

  isJQueryCompatible: function (jq) {

    var version = jq.fn.jquery.split('.');
    var majorVersion = parseInt(version[0], 10);
    var minorVersion = parseInt(version[1], 10);

    if (majorVersion >= 2) {
      return true;
    }

    if (majorVersion == 1 && minorVersion > 10) {
      return true;
    }

    return exitintel.config.compatibleJQueryVersions.indexOf(jq.fn.jquery) !== -1;

  },

  runAnimation: function (element, animation, duration) {

    var resolved = false;

    var animationDone = function () {

      if (resolved) {
        return;
      }

      element.removeClass('animated');
      element.removeClass(animation);

      resolved = true;
      defer.resolve();
    };

    var defer = exitintel.util.jQuery.Deferred();

    element.css({
      'animation-duration': (duration || '1') + 's'
    });

    element.one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', animationDone);
    element.addClass('animated');
    element.addClass(animation);

    // Safeguard
    setTimeout(animationDone, (duration+1)*1000);

    return defer.promise();
  },

  getGeoLocation: function () {
    var defer = exitintel.util.jQuery.Deferred();

    try {
      if (localStorage.getItem('exitintel_geo')) {
        defer.resolve();
      } else {
        exitintel.util.jQuery.ajax({
          url: 'https://j576j5dsib.execute-api.us-east-1.amazonaws.com/prod/custom/common/geolocate?callback=?',
          dataType: 'json',
          timeout: 10000,
          success: function (resp) {
            localStorage.setItem('exitintel_geo', JSON.stringify(resp));
            defer.resolve();
          },
          error: function () {
            exitintel.report.error('timeout', 'getGeoLocation request reached timeout.');

            defer.reject();

            if (exitintel.ad.visibleAds.popup) {
              exitintel.ad.visibleAds.popup.hide();
            }

            if (exitintel.ad.visibleAds.persistent) {
              exitintel.ad.visibleAds.persistent.hide();
            }
          }
        });

        // Geolocate
        /*exitintel.util.jQuery.getJSON(, function (resp) {
          localStorage.setItem('exitintel_geo', JSON.stringify(resp));
          defer.resolve();
        });*/
      }
    } catch (e) {
      defer.resolve();
    }

    return defer.promise();
  },

  getCountry: function () {
    var d = exitintel.util.jQuery.Deferred();

    exitintel.util.jQuery.ajax({
      url: 'https://qlishxpg68.execute-api.us-east-1.amazonaws.com/dev/cf-geo-locate?callback=?',
      dataType: 'json',
      timeout: 10000,
      success: function (resp) {
        if (resp.status === 'success') {
          d.resolve(resp.country);
        }
      },
      error: function () {
        exitintel.report.error('timeout', 'getCountry request reached timeout.');

        d.reject();

        if (exitintel.ad.visibleAds.popup) {
          exitintel.ad.visibleAds.popup.hide();
        }

        if (exitintel.ad.visibleAds.persistent) {
          exitintel.ad.visibleAds.persistent.hide();
        }
      }
    });

    return d.promise();
  },


  padLeft: function (n, width, z) {
    z = z || '0';
    n = n + '';
    return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;
  },

  getContrastingColor: function (color, bw) {

    var hex = color;
    var r, g, b, a;

    // Convert first gradient color to rgba
    if (color.match(/gradient/)) {
      color = color.match(/gradient\((.*)\)/)[1].match(/rgba\([^\)]+\)/)[0];
    }

    // Convert rgb* to hex
    if (color.match(/^rgb/)) {
      var parts = color.substring(color.indexOf("(")).split(",");
      r = parseInt((parts[0].replace(/^\s+|\s+$/gm,'').substring(1)), 10);
      g = parseInt((parts[1].replace(/^\s+|\s+$/gm,'')), 10);
      b = parseInt((parts[2].replace(/^\s+|\s+$/gm,'')), 10);
      a = parseFloat((parts[3].replace(/^\s+|\s+$/gm,'').substring(0, parts[3].length - 1))).toFixed(2);

      hex = ('#' + r.toString(16) + g.toString(16) + b.toString(16));
    }

    if (hex.indexOf('#') === 0) {
        hex = hex.slice(1);
    }

    // convert 3-digit hex to 6-digits.
    if (hex.length === 3) {
        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
    }
    if (hex.length !== 6) {
        throw new Error('Invalid HEX color.');
    }

    r = parseInt(hex.slice(0, 2), 16);
    g = parseInt(hex.slice(2, 4), 16);
    b = parseInt(hex.slice(4, 6), 16);

    if (bw) {
        // http://stackoverflow.com/a/3943023/112731
        return (r * 0.299 + g * 0.587 + b * 0.114) > 186 ? '#000000' : '#FFFFFF';
    }
    // invert color components
    r = (255 - r).toString(16);
    g = (255 - g).toString(16);
    b = (255 - b).toString(16);
    // pad each with zeros and return
    return "#" + exitintel.util.padLeft(r, 2) + exitintel.util.padLeft(g, 2) + exitintel.util.padLeft(b, 2);
  },

  getPlaceholderCSS: function(selector, color){

    var returnString = "";
    var placeHolderTypes = ["::placeholder",
      "::-webkit-input-placeholder",
      "::-moz-placeholder",
      ":-ms-input-placeholder",
      ":-moz-placeholder"];

    for (var i =0; i<placeHolderTypes.length; i++){
      returnString += selector+ placeHolderTypes[i]+"{"+
        "color:"+color+" !important;"+
        "opacity: 0.7 !important;" +
      "}\n";
    }

    return returnString;
  },
};


/**
 * isMobile.js v0.3.5
 *
 * A simple library to detect Apple phones and tablets,
 * Android phones and tablets, other mobile devices (like blackberry, mini-opera and windows phone),
 * and any kind of seven inch device, via user agent sniffing.
 *
 * @author: Kai Mallea (kmallea@gmail.com)
 *
 * @license: http://creativecommons.org/publicdomain/zero/1.0/
 */
/* globals navigator */
// jshint -W106
(function (global) {

    var apple_phone         = /iPhone/i,
        apple_ipod          = /iPod/i,
        apple_tablet        = /iPad/i,
        android_phone       = /(?=.*\bAndroid\b)(?=.*\bMobile\b)/i, // Match 'Android' AND 'Mobile'
        android_tablet      = /Android/i,
        windows_phone       = /IEMobile/i,
        windows_tablet      = /(?=.*\bWindows\b)(?=.*\bARM\b)/i, // Match 'Windows' AND 'ARM'
        other_blackberry    = /BlackBerry/i,
        other_blackberry_10 = /BB10/i,
        other_opera         = /Opera Mini/i,
        other_firefox       = /(?=.*\bFirefox\b)(?=.*\bMobile\b)/i, // Match 'Firefox' AND 'Mobile'
        seven_inch = new RegExp(
            '(?:' +         // Non-capturing group

            'Nexus 7' +     // Nexus 7

            '|' +           // OR

            'BNTV250' +     // B&N Nook Tablet 7 inch

            '|' +           // OR

            'Kindle Fire' + // Kindle Fire

            '|' +           // OR

            'Silk' +        // Kindle Fire, Silk Accelerated

            '|' +           // OR

            'GT-P1000' +    // Galaxy Tab 7 inch

            ')',            // End non-capturing group

            'i');           // Case-insensitive matching

    var match = function(regex, userAgent) {
        return regex.test(userAgent);
    };

    var IsMobileClass = function(userAgent) {
        var ua = userAgent || navigator.userAgent;

        this.apple = {
            phone:  match(apple_phone, ua),
            ipod:   match(apple_ipod, ua),
            tablet: match(apple_tablet, ua),
            device: match(apple_phone, ua) || match(apple_ipod, ua) || match(apple_tablet, ua)
        };
        this.android = {
            phone:  match(android_phone, ua),
            tablet: !match(android_phone, ua) && match(android_tablet, ua),
            device: match(android_phone, ua) || match(android_tablet, ua)
        };
        this.windows = {
            phone:  match(windows_phone, ua),
            tablet: match(windows_tablet, ua),
            device: match(windows_phone, ua) || match(windows_tablet, ua)
        };
        this.other = {
            blackberry:   match(other_blackberry, ua),
            blackberry10: match(other_blackberry_10, ua),
            opera:        match(other_opera, ua),
            firefox:      match(other_firefox, ua),
            device:       match(other_blackberry, ua) || match(other_blackberry_10, ua) || match(other_opera, ua) || match(other_firefox, ua)
        };
        this.seven_inch = match(seven_inch, ua);
        this.any = this.apple.device || this.android.device || this.windows.device || this.other.device || this.seven_inch;
        // excludes 'other' devices and ipods, targeting touchscreen phones
        this.phone = this.apple.phone || this.android.phone || this.windows.phone;
        // excludes 7 inch devices, classifying as phone or tablet is left to the user
        this.tablet = this.apple.tablet || this.android.tablet || this.windows.tablet;

        if (typeof window === 'undefined') {
            return this;
        }
    };

    var instantiate = function() {
        var IM = new IsMobileClass();
        IM.Class = IsMobileClass;
        return IM;
    };

    global.isMobile = instantiate();

})(exitintel.util.detectDevice);
// jshint +W106



exitintel.util.loadJQuery(function ($) {

// Fix legacy IE8-IE9 cors issues
if ( window.XDomainRequest ) {
  $.ajaxTransport(function( s ) {
    if ( s.crossDomain && s.async ) {
      if ( s.timeout ) {
        s.xdrTimeout = s.timeout;
        delete s.timeout;
      }
      var xdr;
      return {
        send: function( _, complete ) {
          function callback( status, statusText, responses, responseHeaders ) {
            xdr.onload = xdr.onerror = xdr.ontimeout = $.noop;
            xdr = undefined;
            complete( status, statusText, responses, responseHeaders );
          }
          xdr = new XDomainRequest();
          xdr.onload = function() {
            callback( 200, "OK", { text: xdr.responseText }, "Content-Type: " + xdr.contentType );
          };
          xdr.onerror = function() {
            callback( 404, "Not Found" );
          };
          xdr.onprogress = $.noop;
          xdr.ontimeout = function() {
            callback( 0, "timeout" );
          };
          xdr.timeout = s.xdrTimeout || Number.MAX_VALUE;
          xdr.open( s.type, s.url );
          xdr.send( ( s.hasContent && s.data ) || null );
        },
        abort: function() {
          if ( xdr ) {
            xdr.onerror = $.noop;
            xdr.abort();
          }
        }
      };
    }
  });
}



exitintel.api = {
  getCampaigns: function (clientId, publicationId) {

    var cacheBust = '';
    var superCacheBust = '';
    if (clientId === 240) {
      cacheBust = '?_t=' + Math.floor((new Date()).valueOf()/(1000 * 60 * 5));
    }

    superCacheBust = '?_t=' + Math.floor((new Date()).valueOf());

    var url = exitintel.config.cdnURL + '/serve/' + clientId + cacheBust;

    if (exitintel.debug.preview.isPreviewSession) {
      url = exitintel.config.apiURL + '/preview/' + clientId + '/' + exitintel.debug.preview.campaignId + '/' + exitintel.debug.preview.adId + superCacheBust;
    } else if (publicationId) {
      if (publicationId == 'master-preview') {
        url = exitintel.config.apiURL + '/serve/' + clientId + superCacheBust;
      } else {
        url = exitintel.config.apiURL + '/pub/' + clientId + '/' + publicationId + superCacheBust;
      }

    } else {
      url = exitintel.config.cdnURL + '/pub/' + clientId + cacheBust;
    }

    setTimeout(function () {
      $.ajax({
        url: url,
        jsonp: 'callback',
        jsonpCallback: 'exitintel.campaign.campaignsFileLoaded',
        dataType: 'jsonp',
        cache: true
      });
    });
  }
};



exitintel.asset = {
  loadedAssets: {},

  has: function (filename) {
    return this.loadedAssets[filename];
  },

  load: function (filename) {
    var deferred = this.has(filename);
    if (!deferred) {
      deferred = exitintel.util.jQuery.Deferred();
      this.loadedAssets[filename] = deferred;

      exitintel.util.jQuery.ajax({
        url: exitintel.config.cdnURL + '/file/get/' + filename,
        dataType: 'jsonp',
        jsonp: 'callback',
        jsonpCallback: 'exitintel.asset.loaded',
        cache: true
      });
    }

    return deferred.promise();
  },

  loaded: function (response) {
    exitintel.ad.enableCustomCSS('asset-' + response.filename.split('.').shift(), { customCSS: response.css });

    this.loadedAssets[response.filename].resolve();
  }
};


exitintel.ad = {

  installedAds: {},

  adTriggers: {},

  visibleAds: {
    popup: null,
    persistent: null
  },

  promises: {},

  install: function (ad, options) {

    var d = new exitintel.util.jQuery.Deferred();

    exitintel.util.log('Installing ' + ad.id);

    // Check if installed
    if (typeof this.installedAds[ad.id] != 'undefined') {
      exitintel.util.log(ad.id + ' is already installed');
      d.resolve(this.installedAds[ad.id]);
      return d;
    }

    // V3
    if (ad.schemaVersion && ad.schemaVersion === 3) {
      var adDisplay = exitintel.ad.render(ad);

      if (!options || !options.noTriggers) {
        exitintel.util.log('Installing trigger for ' + ad.id);
        exitintel.ad.installTrigger(ad, adDisplay, {
          displayLimitPerPage: options.displayLimitPerPage,
          priority: options.priority
        });
      }

      d.resolve(adDisplay);
    } else {

      exitintel.profiler.send('ad-installing:' + ad.id);

      this.makeCommonElements(ad);

      exitintel.util.log('Preloading images for ' + ad.id);

      this.preloadImages(ad, function () {

        exitintel.profiler.send('ad-preloaded:' + ad.id);

        exitintel.util.log('Images loaded for ' + ad.id);
        var adDisplay = exitintel.ad.render(ad);

        if (!adDisplay) {
          return;
        }

        exitintel.ad.installedAds[ad.id] = adDisplay;

        ad.pageImpressions = 0;

        if (!options || !options.noTriggers) {
          exitintel.util.log('Installing trigger for ' + ad.id);
          exitintel.ad.installTrigger(ad, adDisplay, {
            displayLimitPerPage: options.displayLimitPerPage,
            priority: options.priority
          });
        }

        d.resolve(adDisplay);
      });
    }

    return d;
  },

  makeCommonElements: function (ad) {

    // cleanup (delete) common elements from panels (if they have already been installed)
    for (var j = 0; j < ad.selectedVersion.template.panels.length; j++) {
      for (var k = 0; k < ad.selectedVersion.template.panels[j].elements.length; k++) {
        if (ad.selectedVersion.template.panels[j].elements[k].showOnMultipleSteps) {
          ad.selectedVersion.template.panels[j].elements.splice(k, 1);
        }
      }
    }

    if (ad.selectedVersion.template.commonElements) {
      exitintel.util.log('Making common elements ' + ad.id);

      for (var i = 0; i < ad.selectedVersion.template.commonElements.length; i++) {
        var common = ad.selectedVersion.template.commonElements[i];

        for (var panel = 0; panel < common.visibleOnSteps.length; panel++) {

          if (common.visibleOnSteps[panel] === true) {
            // check if panel exists (might have been deleted)
            if (ad.selectedVersion.template.panels[panel]) {
              ad.selectedVersion.template.panels[panel].elements.push(common);
            }
          }
        }
      }
    }
  },


  preloadImages: function (ad, callback) {
    var images = [];
    var loadPromises = [];
    var registeredAnimations = [];
    var registeredHoverAnimations = [];

    if (exitintel.config.skipPreloading) {
      callback();
      return;
    }

    // preload overlay background image
    if (ad.selectedVersion.template.overlayBackgroundImage) {
      images.push(exitintel.config.cdnURL + ad.selectedVersion.template.overlayBackgroundImage);
    }

    // preload ad background image (all panels)
    if (ad.selectedVersion.template.backgroundImage) {
      images.push(exitintel.config.cdnURL + ad.selectedVersion.template.backgroundImage);
    }

    for (var i = 0; i < ad.selectedVersion.template.panels.length; i++) {
      var p = ad.selectedVersion.template.panels[i];

      // preload panel background image
      if (p.backgroundImage) {
        images.push(exitintel.config.cdnURL + p.backgroundImage);
      }

      // preload element background images
      for (var j = 0; j < p.elements.length; j++) {
        if (p.elements[j].backgroundImage) {
          images.push(exitintel.config.cdnURL + p.elements[j].backgroundImage);
        }

        if (p.elements[j].animationEnabled && p.elements[j].animation.effect) {
          var effect = p.elements[j].animation.effect.split(':').pop();

          if (registeredAnimations.indexOf(effect) === -1) {
            registeredAnimations.push(effect);
          }
        }

        if (p.elements[j].hover && p.elements[j].hover.enabled && p.elements[j].hover.effect) {
          if (p.elements[j].hover.effect !== 'crossfade') {
            registeredHoverAnimations.push(p.elements[j].hover.effect);
          }

          if (p.elements[j].hover.image) {
            images.push(exitintel.config.cdnURL + p.elements[j].hover.image);
          }
        }
      }
    }

    // preload common elements animations
    var commonElements = ad.selectedVersion.template.commonElements;

    // Fix for older ads that do not have common elements
    if (!commonElements) {
      commonElements = [];
    }

    for (var ce = 0; ce < commonElements.length; ce++) {
      var common = commonElements[ce];

      for (var vp = 0; vp < common.visibleOnSteps.length; vp++) {
        if (common.visibleOnSteps[vp] && common.animationEnabled && common.animation.effect) {
          var commonEffect = common.animation.effect.split(':').pop();

          if (registeredAnimations.indexOf(commonEffect) === -1) {
            registeredAnimations.push(commonEffect);
          }
        }

        if (common.visibleOnSteps[vp] && common.hover && common.hover.enabled && common.hover.effect) {
          if (common.hover.effect !== 'crossfade') {
            registeredHoverAnimations.push(common.hover.effect);
          }

          if (common.hover.image) {
            images.push(exitintel.config.cdnURL + common.hover.image);
          }
        }
      }
    }

    for (var k = 0; k < images.length; k++) {
      loadPromises.push(exitintel.util.preloadImage(images[k]));
    }

    // Preload animations CSS
    this.promises[ad.id] = {};

    this.promises[ad.id].animations = exitintel.util.jQuery.Deferred();
    this.promises[ad.id].hoverAnimations = exitintel.util.jQuery.Deferred();

    if (typeof ad.selectedVersion.template.animations == 'object') {
     if (typeof ad.selectedVersion.template.animations.transition == 'object' && typeof ad.selectedVersion.template.animations.transition.effect == 'object' && ad.selectedVersion.template.animations.transition.effect && ad.selectedVersion.template.animations.transition.effect.animations) {
      registeredAnimations.push(ad.selectedVersion.template.animations.transition.effect.animations[0]);
      registeredAnimations.push(ad.selectedVersion.template.animations.transition.effect.animations[1]);
     }

     if (typeof ad.selectedVersion.template.animations.appearence == 'object' && ad.selectedVersion.template.animations.appearence.effect) {
      registeredAnimations.push(ad.selectedVersion.template.animations.appearence.effect);
     }

     if (typeof ad.selectedVersion.template.animations.closing == 'object' && ad.selectedVersion.template.animations.closing.effect) {
      registeredAnimations.push(ad.selectedVersion.template.animations.closing.effect);
     }

     // Overlay animations
     if (typeof ad.selectedVersion.template.animations.overlayAppearence == 'object' && ad.selectedVersion.template.animations.overlayAppearence.effect) {
      registeredAnimations.push(ad.selectedVersion.template.animations.overlayAppearence.effect);
     }

     if (typeof ad.selectedVersion.template.animations.overlayClosing == 'object' && ad.selectedVersion.template.animations.overlayClosing.effect) {
      registeredAnimations.push(ad.selectedVersion.template.animations.overlayClosing.effect);
     }
    }

    if (registeredAnimations.length) {
      /*exitintel.util.jQuery.get(exitintel.config.cdnURL + '/module/animations/?id=' + registeredAnimations.join(','), function (resp) {
        ad.selectedVersion.template.animationsCss = resp;
        animationCSSPromise.resolve();
      }.bind(this));*/
      exitintel.util.jQuery.ajax({
        url: exitintel.config.cdnURL + '/module/animations/?id=' + registeredAnimations.join(','),
        data: {
          ad: ad.id
        },
        dataType: 'jsonp',
        jsonp: 'callback',
        jsonpCallback: 'exitintel.ad.loadedAnimations',
	cache: true
      });

      loadPromises.push(this.promises[ad.id].animations);
    }

    if (registeredHoverAnimations.length) {
      exitintel.util.jQuery.ajax({
        url: exitintel.config.cdnURL + '/module/hover/?id=' + registeredHoverAnimations.join(','),
        data: {
          ad: ad.id
        },
        dataType: 'jsonp',
        jsonp: 'callback',
        jsonpCallback: 'exitintel.ad.loadedHoverAnimations',
        cache: true
      });

      loadPromises.push(this.promises[ad.id].hoverAnimations);
    }

    // Load assets css
    if (ad.selectedVersion.template.panels) {
      for (var pa = 0; pa < ad.selectedVersion.template.panels.length; pa++) {
        var panel = ad.selectedVersion.template.panels[pa];

        if (!panel.elements) {
          continue;
        }

        for (var e = 0; e < panel.elements.length; e++) {
          if (panel.elements[e].subtype === 'close-button') {
            loadPromises.push(exitintel.asset.load('close-button.css'));
          }

          if (panel.elements[e].actions && panel.elements[e].actions.length) {
            for (var ac = 0; ac < panel.elements[e].actions.length; ac++) {
              if (panel.elements[e].actions[ac].class === 'accept-decline-prompt') {
                loadPromises.push(exitintel.asset.load('accept-decline-prompt.css'));
              }
            }
          }
        }
      }
    }

    if (!loadPromises.length) {
      callback();
      return;
    }

    $.when.apply($, loadPromises).then(
      function allImagesLoaded() {
        callback();
      },
      function imagesFailed() {
        exitintel.util.log('Images failed to load. Aborting.');
        return;
      }
    );
  },

  loadedAnimations: function (resp) {
    var ad = this.findAdById(resp.ad);

    ad.selectedVersion.template.animationsCss = resp.css;
    this.promises[ad.id].animations.resolve();
  },

  loadedHoverAnimations: function (resp) {
    var ad = this.findAdById(resp.ad);

    ad.selectedVersion.template.customCSS += "\n" + resp.css;
    this.promises[ad.id].hoverAnimations.resolve();
  },

  loadedCloseButton: function (resp) {
    var ad = this.findAdById(resp.ad);

    ad.selectedVersion.template.customCSS += "\n" + resp.css;
    this.promises[ad.id].closeButton.resolve();
  },

  findAdById: function (adId) {
    var ad = null;

    for (var i = 0; i < exitintel.campaign.active.length; i++) {
      var c = exitintel.campaign.active[i];

      if (c.selectedAd && c.selectedAd.id === adId) {
        ad = c.selectedAd;
      }
    }

    if (ad) {
      return ad;
    }

    for (var ii = 0; ii < exitintel.campaign.available.length; ii++) {
      var cc = exitintel.campaign.available[ii];

      if (cc.selectedAd && cc.selectedAd.id === adId) {
        ad = cc.selectedAd;
      }
    }

    return ad;
  },

  installTrigger: function (ad, adDisplay, options) {
    // detect device
    var deviceDetect = exitintel.util.detectDevice.isMobile;

    var deviceType = 'desktop';
    if (deviceDetect.phone) {
      deviceType = 'phone';
    } else if (deviceDetect.tablet) {
      deviceType = 'tablet';
    }

    var trigger = null;

    if (ad.schemaVersion && ad.schemaVersion === 3) {

      // Change phone -> mobile for v3
      if (deviceType === 'phone') {
        deviceType = 'mobile';
      }

      var newTrigger = ad.selectedVersion.template.ad.triggers.find(function (t) {
        return t.deviceType === deviceType;
      });

      if (newTrigger) {
        trigger = {
          type: newTrigger.triggerType,
          delay: newTrigger.delay,
          selector: newTrigger.extraOptions ? newTrigger.extraOptions.selector : null,
          targetMode: newTrigger.targetMode,
          postpone: newTrigger.postponeDelay ? true : false,
          postponeBy: newTrigger.postponeDelay || 0
        };
      }
    } else {
      trigger = ad.selectedVersion.trigger ? ad.selectedVersion.trigger[deviceType] : null;
    }


    exitintel.util.log('Installing trigger for ' + deviceType);

    var triggerId = null;

    var handlerMap = {
      'on-load':                'onLoad',
      'on-stop-scrolling':      'onScrollTimeout',
      'on-scrolled-to-bottom':  'onScrolledToBottom',
      'on-scrolled-to-element': 'onScrolledToElement',
      'on-exit-intent':         'onExit',
      'on-mobile-scroll-up':    'onMobileScrollUp',
      'manual':                 null
    };

    if (!trigger || !trigger.type) {
      return;
    }

    // Install trigger
    if (handlerMap[trigger.type]) {

      // Init local adTrigger tracker
      if (typeof exitintel.ad.adTriggers[trigger.type] == 'undefined') {
        exitintel.ad.adTriggers[trigger.type] = {};
      }

      // If this trigger exists check priority
      if (exitintel.ad.adTriggers[trigger.type].triggerId) {
        if (options.priority > exitintel.ad.adTriggers[trigger.type].priority) {
          // Uninstall trigger (will be replaced)
          exitintel.trigger.uninstall(exitintel.ad.adTriggers[trigger.type].triggerId);
        } else {
          // Trigger of higher priority already set
          return;
        }
      }

      triggerId = exitintel.trigger.install(handlerMap[trigger.type], this.showAdFunction(ad, adDisplay, options), {
        delay: trigger.delay || 0,
        selector: trigger.selector || null,
        targetMode: trigger.targetMode || null,
        postpone: trigger.postpone || null,
        postponeBy: trigger.postponeBy || 0
      });

      exitintel.profiler.send('ad-trigger-installed:' + ad.id);
      exitintel.util.log('Installed trigger: ' + trigger.type + ' for ' + ad.id);

      ad.triggerId = triggerId;

      // Save trigger
      exitintel.ad.adTriggers[trigger.type] = {
        priority: options.priority,
        triggerId: triggerId
      };
    }
  },

  showAdFunction: function (ad, adDisplay, options) {

    if (ad.schemaVersion && ad.schemaVersion === 3) {
      var showFnV3 = function (callback) {

        if ((ad.selectedVersion.template.type == 'Popup' || ad.selectedVersion.template.type == 'popup') && exitintel.ad.visibleAds.popup !== null) {
          exitintel.util.log('Ad of type ' + ad.selectedVersion.template.type + ' already displayed.');
          return;
        }
        if ((ad.selectedVersion.template.type == 'Persistent' || ad.selectedVersion.template.type == 'persistent') && exitintel.ad.visibleAds.persistent !== null) {
          exitintel.util.log('Ad of type ' + ad.selectedVersion.template.type + ' already displayed.');
          return;
        }

        if (options.displayLimitPerPage && options.displayLimitPerPage <= ad.pageImpressions) {
          exitintel.util.log('Ad ' + ad.id + ' not shown because it reached page impression limit.');
          return;
        }

        adDisplay.show(options.stepNumber);

        ad.pageImpressions++;

        // Log impression
        exitintel.event.log('ad-impression', {
          campaignId: ad.campaignId,
          adId: ad.id
        });

        exitintel.profiler.send('ad-impression:' + ad.id);

        try {
          exitintel.events.emit('ad-impression', {
            campaignId: ad.campaignId,
            adId: ad.id
          });
        } catch (e) {
          exitintel.util.error(e);
        }

        // Set this campaign as seen
        exitintel.visitor.setSeenCampaign(ad.campaignId, { adId: ad.id });

        if (typeof callback == 'function') {
          callback();
        }

      };
      return showFnV3;
    }

    // Get the campaign object
    var campaign = null;
    try {
      campaign = exitintel.campaign.available.filter(function (c) {
        if (c.id == ad.campaignId) {
          return true;
        }

        return false;
      }).pop();
    } catch (e) {
      exitintel.util.log('Error: cannot find campaign: ' + ad.campaignId);
    }

    var showFn = function (callback) {
      // Check if ad of that type is already displayed
      if (ad.selectedVersion.template.type == 'Popup' && exitintel.ad.visibleAds.popup !== null) {
        exitintel.util.log('Ad of type ' + ad.selectedVersion.template.type + ' already displayed.');
        return;
      }
      if (ad.selectedVersion.template.type == 'Persistent' && exitintel.ad.visibleAds.persistent !== null) {
        exitintel.util.log('Ad of type ' + ad.selectedVersion.template.type + ' already displayed.');
        return;
      }

      if (options.displayLimitPerPage && options.displayLimitPerPage <= ad.pageImpressions) {
        exitintel.util.log('Ad ' + ad.id + ' not shown because it reached page impression limit.');
        return;
      }

      // Check and run all JS snippets
      var snippetPromises = [];

      var snippets = [];

      if (typeof ad.selectedVersion.template.JSSnippets !== 'undefined') {
        snippets = ad.selectedVersion.template.JSSnippets;
      }

      if (typeof ad.snippets !== 'undefined' && typeof ad.snippets['impression-js'] !== 'undefined' ) {
        snippets = snippets.concat(ad.snippets['impression-js']);
      }

      for (var i = 0; i < snippets.length; i++) {
        var snippet = snippets[i];

        // Pad with auto resolving for promises
        if (snippet.source.indexOf('deferred.resolve()') == -1) {
          snippet.source += ";\ndeferred.resolve();";
        }
        if (snippet.source.indexOf('return deferred.promise();') == -1) {
          snippet.source += ";\nreturn deferred.promise();";
        }

        // TODO: feed adDisplay object to the function (to manipulate elements)

        /*jshint -W054 */
        var fn = new Function('deferred', 'params', snippet.source);
        /*jshint +W054 */

        var d = new exitintel.util.jQuery.Deferred();

        snippetPromises.push(d);

        fn(d, {
          campaign: campaign,
          ad: ad,
          adDisplay: adDisplay
        });
      }

      $.when.apply($, snippetPromises).then(
        function snippetsLoaded() {
          adDisplay.show();
          ad.pageImpressions++;

          // Log impression
          exitintel.event.log('ad-impression', {
            campaignId: ad.campaignId,
            adId: ad.id
          });

          exitintel.profiler.send('ad-impression:' + ad.id);

          try {
            exitintel.events.emit('ad-impression', {
              campaignId: ad.campaignId,
              adId: ad.id
            });
          } catch (e) {
            exitintel.util.error(e);
          }

          // Set this campaign as seen
          exitintel.visitor.setSeenCampaign(ad.campaignId, { adId: ad.id });

          // Run impression code
          if (ad.selectedVersion.template.impressionJS) {

            /*jshint -W054 */
            var impressionFn = new Function('thisCampaign', 'thisAd', ad.selectedVersion.template.impressionJS);
            /*jshint +W054 */
            impressionFn(campaign, ad);
          }

          if (ad.selectedVersion.template.integrations && ad.selectedVersion.template.integrations.ga && ad.selectedVersion.template.integrations.ga.enabled) {
            if (typeof ad.selectedVersion.template.integrations.ga.onImpression !== 'object') {
              ad.selectedVersion.template.integrations.ga.onImpression = {};
            }
            exitintel.integrations.ga.trackEvent(
              ad.selectedVersion.template.integrations.ga.onImpression.eventCategory || 'Exit Intel',
              ad.selectedVersion.template.integrations.ga.onImpression.eventAction || 'Impression',
              ad.selectedVersion.template.integrations.ga.onImpression.eventLabel || campaign.title + ' / ' + ad.title,
              ad.selectedVersion.template.integrations.ga.onImpression.eventValue || 0
            );

          }

          if (typeof callback == 'function') {
            callback();
          }
        },
        function snippetsFailed() {
          exitintel.util.log('Some snippets failed');
          //showFn();
          //if (typeof callback == 'function') callback();
        }
      );
    };

    return showFn;
  },

  render: function (ad) {
    if (ad.schemaVersion && ad.schemaVersion === 3) {
      return new exitintel.renderers.v3(ad);
    }

    if (ad.selectedVersion.template.type == 'Popup') {
      return this.renderPopup(ad);
    } else if (ad.selectedVersion.template.type == 'Persistent') {
      return this.renderPersistent(ad);
    } else {
      exitintel.util.log('Cannot render ad of type: ' + ad.selectedVersion.template.type);
    }
  },

  renderPopup: function (ad) {
    var popup = new exitintel.renderers.popup(ad.campaignId, ad.id, ad.selectedVersion.template);

    return popup;
  },

  renderPersistent: function (ad) {
    var persistent = null;

    try {
      persistent = new exitintel.renderers.persistent(ad.campaignId, ad.id, ad.selectedVersion.template);
    } catch (e) {
      persistent = null;
    }

    return persistent;
  },

  getVersionDependencies: function (adVersion, selectedAd) {


    var dependencies = [];

    // For V3 ads execute the following block.
    if(selectedAd.schemaVersion && selectedAd.schemaVersion === 3) {

      var steps = adVersion.template.ad.steps; // steps

      // Append ads versions triggered by this ad.
      var iter = function(item) {
        if (
          item &&
          item.type &&
          item.type === 'element' &&
          item.subType === 'button' &&
          item.actions &&
          item.actions.length > 0
        ) {

          item.actions.forEach(function(action) {
            if (action.type === 'trigger-ad' && action.adId) {
              dependencies.push(action); // TODO: push only adId and campaignId ???
            }
          });
        }


        if (item.elements && Array.isArray(item.elements)) {
          item.elements.forEach(iter);
        }
      };

      steps.forEach(iter);

      // Append forced dependencies.
      var linkedAds = adVersion.template.ad.linkedAds;

      if (typeof linkedAds != 'undefined' && linkedAds && linkedAds.length) {
        for (var l = 0; l < linkedAds.length; l++) {
          dependencies.push(linkedAds[l]);
        }
      }

      return dependencies;
    }


    // For old ads execute the following code:

    if (!adVersion.template || !adVersion.template.panels) {
      return [];
    }

    // Append ads versions triggered by this ad
    for (var i = 0; i < adVersion.template.panels.length; i++) {
      var p = adVersion.template.panels[i];

      for (var j = 0; j < p.elements.length; j++) {
        var e = p.elements[j];

        if (!e.actions || !e.actions.length) {
          continue;
        }

        for (var k = 0; k < e.actions.length; k++) {
          var a = e.actions[k];

          if (a['class'] === 'trigger-ad') {
            if (a.params.adId) {
              dependencies.push(a.params);
            }
          }
        }
      }
    }

    // Append forced dependancies
    try {
      if (typeof adVersion.linkedAds != 'undefined' && adVersion.linkedAds && adVersion.linkedAds.length) {
        for (var ii = 0; ii < adVersion.linkedAds.length; ii++) {
          dependencies.push(adVersion.linkedAds[ii]);
        }
      }
    } catch (e) {

    }

    return dependencies;
  },

  enableCustomCSS: function (adId, adTemplate, adObject) {

    var customCSS = '';

    // Add animation CSS
    if (adTemplate.animationsCss) {
      customCSS += adTemplate.animationsCss;
    }

    var vendorPrefixes = ['-webkit','-moz' , '-o', '-khtml'];

    var autoFillHack = '';

    //Correct autofill text field styling
    for (var ii = 0; ii < vendorPrefixes.length; ii++) {
      autoFillHack +=
      '.exitintel-wrapper textarea:'+vendorPrefixes[ii]+'-autofill,' +
      '.exitintel-wrapper textarea:'+vendorPrefixes[ii]+'-autofill:hover,' +
      '.exitintel-wrapper textarea:'+vendorPrefixes[ii]+'-autofill:focus,' +
      '.exitintel-wrapper textarea:'+vendorPrefixes[ii]+'-autofill:active,' +
      '.exitintel-wrapper select:'+vendorPrefixes[ii]+'-autofill,' +
      '.exitintel-wrapper select:'+vendorPrefixes[ii]+'-autofill:hover,' +
      '.exitintel-wrapper select:'+vendorPrefixes[ii]+'-autofill:focus,' +
      '.exitintel-wrapper select:'+vendorPrefixes[ii]+'-autofill:active,' +
      '.exitintel-wrapper input:'+vendorPrefixes[ii]+'-autofill,' +
      '.exitintel-wrapper input:'+vendorPrefixes[ii]+'-autofill:hover,' +
      '.exitintel-wrapper input:'+vendorPrefixes[ii]+'-autofill:focus,' +
      '.exitintel-wrapper input:'+vendorPrefixes[ii]+'-autofill:active {' +
      '    border: none !important;' +
      '    '+vendorPrefixes[ii]+'-box-shadow: none !important;' +
      '    '+vendorPrefixes[ii]+'-transition-delay: 9999s;' +
      '    '+vendorPrefixes[ii]+'-transition: color 9999s ease-out, background-color 9999s ease-out;' +
      '}';
    }

    autoFillHack +=
    '.exitintel-wrapper input, .exitintel-wrapper select,'+
    '.exitintel-wrapper input:active, .exitintel-wrapper select:active,'+
    '.exitintel-wrapper input:focus, .exitintel-wrapper select:focus {'+
    '  box-shadow: none !important;'+
    ' }';

    customCSS += autoFillHack;

    // Add default CSS (legacy)
    if (adTemplate.customCSS) {
      customCSS += adTemplate.customCSS;
    }


    /*

    TODO: Enable this. Needs ad context.

    if (typeof ad !== 'undefined' && typeof ad.snippets !== 'undefined' && typeof ad.snippets['impression-css'] !== 'undefined') {
      for (var i = 0; i < ad.snippets['impression-css'].length; i++) {
        customCSS += ad.snippets['impression-css'][i].source + "\n";
      }
    }
    */


    // Add snippets
    if (adTemplate.CSSSnippets) {
      for (var i = 0; i < adTemplate.CSSSnippets.length; i++) {
        customCSS += "\n" + adTemplate.CSSSnippets[i].source + "\n";
      }
    }

    if (adObject && adObject.elementsCustomCSS && adObject.elementsCustomCSS.length > 0) {
      customCSS += "\n" + adObject.elementsCustomCSS.join("\n") + "\n";
    }

    if (customCSS !== '') {
      var styleBlock = $('<style>' + customCSS + '</style>')
              .attr('id', 'ei-style-' + adId)
              .attr('type', 'text/css');

      $('body').append(styleBlock);
    }

    // Enable stylesheets
    if (adObject && adObject.elementsStylesheets && adObject.elementsStylesheets.length > 0) {
      for (var j = 0; j < adObject.elementsStylesheets.length; j++) {
        $('head').append($('<link>').attr('rel', 'stylesheet').attr('href', exitintel.config.cdnURL + exitintel.ad.elementsStylesheets[j]));
      }
    }
  },

  disableCustomCSS: function (adId) {
    $('#ei-style-' + adId).remove();
  },

  registerCSS: function (css, ad) {
    ad.elementsCustomCSS.push(css);
  },

  registerStylesheet: function (stylesheet, ad) {
    if (exitintel.ad.elementsStylesheets.indexOf(stylesheet) !== -1) {
      return;
    }

    ad.elementsStylesheets.push(stylesheet);
  },

  runElementsAnimations: function (template, panelId) {
    for (var i = 0; i < template.panels[panelId].elements.length; i++) {
      var element = template.panels[panelId].elements[i];

      if (element.animationEnabled) {
        if (element.showOnMultipleSteps && element.alreadyAnimated) {
          continue;
        }
        if (element.showOnMultipleSteps) {
          element.alreadyAnimated = true;
        }

        exitintel.util.log('Running animation for ' + element.name);

        this.runElementAnimation(element, panelId);
      }
    }

    /*if (template.commonElements) {
      for (var ce = 0; ce < template.commonElements.length; ce++) {
        var common = template.commonElements[ce];

        if (common.animationEnabled && common.visibleOnSteps[panelId] && !common.alreadyAnimated) {
          exitintel.util.log('Running animation for ' + common.name);
          common.alreadyAnimated = true;

          this.runElementAnimation(common);
        }
      }
    }*/
  },

  runElementAnimation: function (element, panelId) {
    var $element = exitintel.util.jQuery('[data-exitintel-name="'+ element.name + '"][data-element-panel-id="'+panelId+'"]');
    var animation = element.animation.effect && element.animation.effect.split(':');

    var group = null;
    var effect = null;

    if (animation) {
      if (!animation[1]) {
        effect = animation[0];
        group = 'in';
      } else {
        effect = animation[1];
        group = animation[0];
      }
    }

    // If none is selected, just hide and show
    if (!element.animation.effect || (element.animation.effect && group === 'in')) {
      $element.hide();
    } else {
      $element.show();
    }

    setTimeout(function () {
      exitintel.util.log('Starting animation for ' + element.name);

      // If none is selected, just hide and show
      $element.show();

      exitintel.util.runAnimation(
        $element,
        effect,
        element.animation.duration
      ).then(function () {
        if (group === 'out') {
          $element.hide();
        }

        $element.css('animation-duration', '');
      });
    }, (element.animation.delay) * 1000);
  },

  findStepWithEmail: function(adDisplay){
    if(adDisplay.ad && adDisplay.ad.schemaVersion && adDisplay.ad.schemaVersion === 3) {
      try{
        return exitintel.findStepWithEmailV3(adDisplay.ad.selectedVersion.template.ad.steps);
      } catch(e){
        return 1;
      }
    }

    for (var i in adDisplay.template.panels){
      for (var j in adDisplay.template.panels[i].elements){
        if (adDisplay.template.panels[i].elements[j].type === "input-email"){
          var step = parseInt(i, 10) + 1;
          return step;
        }
      }
    }
    return -1;
  }
};


exitintel.elementActions = {
  timeout: null,

  runAction: function ($el, i) {
    var actions = exitintel.util.jQuery.data($el[0], 'ei-actions');

    exitintel.util.jQuery.data($el[0], 'ei-action-status', 'pending');

    exitintel.plugins.activityIndicator.show();

    if (actions[i]) {
      actions[i]().then(function () {
        if (actions[i+1]) {
          exitintel.elementActions.runAction($el, i+1);
        } else {
          exitintel.plugins.activityIndicator.hide();
         exitintel.util.jQuery.data($el[0], 'ei-action-status', 'done');

        }
      }, function () {
        exitintel.util.log('action ' + i + ' failed. Stopping');
        exitintel.plugins.activityIndicator.hide();
        exitintel.util.jQuery.data($el[0], 'ei-action-status', 'failed');
      });
    } else {
      exitintel.util.log('action queue done');
      exitintel.plugins.activityIndicator.hide();
      exitintel.util.jQuery.data($el[0], 'ei-action-status', 'done');
    }
  },

  install: function (element, action) {

    var promise = null;

    var ad = exitintel.util.jQuery.data(element, 'adObject');
    var trackedCampaign = exitintel.campaign.get(ad.campaignId);
    // jshint -W106
    var trackedAd = trackedCampaign.enabled_ads.filter(function (a) { return a.id == ad.adId; }).pop();
    // jshint +W106

    switch (action['class']) {
      case 'goto-step':
        promise = exitintel.elementActionTypes.gotoStep.install(element, action);
      break;

      case 'close-ad':
        promise = exitintel.elementActionTypes.closeAd.install(element, action);
      break;

      case 'goto-url':
        promise = exitintel.elementActionTypes.gotoUrl.install(element, action);
      break;

      case 'download-file':
        promise = exitintel.elementActionTypes.downloadFile.install(element, action);
      break;

      case 'submit-form':
        promise = exitintel.elementActionTypes.submitForm.install(element, action);
      break;

      case 'trigger-ad':
        promise = exitintel.elementActionTypes.triggerAd.install(element, action);
      break;

      case 'collect-data':
        promise = exitintel.elementActionTypes.collectData.install(element, action);
      break;

      case 'send-to-mailchimp':
        promise = exitintel.elementActionTypes.integrationMailchimp.install(element, action);
      break;

      case 'custom-code':
        promise = exitintel.elementActionTypes.customCode.install(element, action);
      break;

      case 'reload-ads':
        promise = exitintel.elementActionTypes.reloadAds.install(element, action);
      break;

      case 'send-to-google-analytics':
        promise = exitintel.elementActionTypes.integrationGoogleAnalytics.install(element, action);
      break;

      case 'send-to-integrations-manager':
        promise = exitintel.elementActionTypes.integrationsManager.install(element, action);
      break;

      case 'fb-lead-event':
        promise = exitintel.elementActionTypes.fbLeadEvent.install(element, action);
      break;

      case 'accept-decline-prompt':
        promise = exitintel.elementActionTypes.acceptDeclinePrompt.install(element, action);
      break;

      default:
        exitintel.util.log('Action class \'' + action['class'] + '\' is not supported');
    }

    var eiActions = exitintel.util.jQuery.data(element[0], 'ei-actions');

    if (!eiActions) {
      eiActions = [];

      exitintel.util.jQuery(element).on('click', function (e) {
        e.preventDefault();
        exitintel.elementActions.runAction($(this), 0);
      });
    }

    if (promise && action['class'] == 'collect-data') {

      // Add pre data collection js
      if (typeof trackedAd !== 'undefined' && typeof trackedAd.snippets !== 'undefined' && typeof trackedAd.snippets['data-collection-js-pre'] !== 'undefined') {
        for (var i = 0; i < trackedAd.snippets['data-collection-js-pre'].length; i++) {
          var act = {
            params: {
              code: trackedAd.snippets['data-collection-js-pre'][i].source
            }
          };

          var prePromise = exitintel.elementActionTypes.customCode.install(element, act);
          eiActions.push(prePromise);
        }
      }

      eiActions.push(promise);

      // Add post data collection js
      if (typeof trackedAd !== 'undefined' && typeof trackedAd.snippets !== 'undefined' && typeof trackedAd.snippets['data-collection-js-post'] !== 'undefined') {
        for (var j = 0; j < trackedAd.snippets['data-collection-js-post'].length; j++) {
          var act2 = {
            params: {
              code: trackedAd.snippets['data-collection-js-post'][j].source
            }
          };

          var postPromise = exitintel.elementActionTypes.customCode.install(element, act2);
          eiActions.push(postPromise);
        }
      }

    } else if (promise) {
      eiActions.push(promise);
    }

    exitintel.util.jQuery.data(element[0], 'ei-actions', eiActions);
  }
};

exitintel.elementActionTypes = {
  gotoStep: {
    install: function (element, action) {
      var ad = exitintel.util.jQuery.data(element, 'adObject');

      return function () {
        var d = new exitintel.util.jQuery.Deferred();

        if (action.params.validateStep) {
          // Validate
          var currentPanel = element.parents('.exitintel-panel');

          var inputElements = currentPanel.find('input[data-exitintel-name],select[data-exitintel-name]');

          for (var i = 0; i < inputElements.length; i++) {
            var inputElement = inputElements[i];

            var validators = $.data(inputElement, 'validators');
            var val = $(inputElement).val();

            if (validators) {
              for (var j = 0; j < validators.length; j++) {
                if (!validators[j](val)) {
                  d.reject();
                  return d.promise(); // Abandon submit
                }
              }
            }
          }
        }



        ad.showPanel(action.params.stepNumber, true);

        d.resolve();

        return d.promise();

      };
    }
  },
  closeAd: {
    install: function (element, action) {
      var ad = exitintel.util.jQuery.data(element, 'adObject');

      return function () {
        var d = new exitintel.util.jQuery.Deferred();

        ad.hide();

        exitintel.visitor.setDisabledCampaign(ad.campaignId);

        try {
          exitintel.events.emit('ad-closed', {
            campaignId: ad.campaignId,
            adId: ad.adId,
            element: element.attr('data-exitintel-label')
          });
        } catch (e) {
          exitintel.util.error(e);
        }

        // Reload ads
        if (action && action.params && action.params.reload) {
          exitintel.elementActionTypes.reloadAds.install(element)();
        }

        d.resolve();

        return d.promise();
      };
    }
  },
  gotoUrl: {
    install: function (element, action) {

      // Attach to element on click (to avoid popup blocker)
      if (action.params.newWindow) {
        element.on('click', function () {

          var win = window.open(action.params.url, '_blank');
          win.focus();

          /*
          var $el = exitintel.util.jQuery(this);

          var gotoURLCheck = setInterval(function () {

            if (exitintel.util.jQuery.data($el[0], 'ei-action-status') == 'failed') {
              clearTimeout(gotoURLCheck);
              return;
            } else if (exitintel.util.jQuery.data($el[0], 'ei-action-status') !== 'done') {
              return;
            }

            clearInterval(gotoURLCheck);
          }, 500);
          */
        });
      }

      return function () {
        var d = new exitintel.util.jQuery.Deferred();

        if (!action.params.newWindow) { // if newWindow it's already installed
          window.location.href = action.params.url;
          // return; // don't resolve so the animation keeps playing
        }

        d.resolve();

        return d.promise();
      };
    }
  },
  downloadFile: {
    install: function (element, action) {

      // Attach to element on click (to avoid popup blocker)
      if (action.params.newWindow) {
        element.on('click', function () {
          var win = window.open(exitintel.config.cdnURL + '/file/get/' +action.params.file._id + '?download=false', '_blank');
          win.focus();
        });
      }

      return function () {
        if (!action.params.newWindow) {
          // Download as attachment
          window.location.href = exitintel.config.cdnURL + '/file/get/' +action.params.file._id + '?download=true';
        }

        var d = new exitintel.util.jQuery.Deferred();
        d.resolve();

        return d.promise();
      };
    }
  },
  submitForm: {
    install: function (element, action) {

      // Directly attach the submit handler on click for new window (avoid popup blocker)
      if (action.params.submitMethod == 'new-window') {
        element.on('click', function (e) {
          submitFunction().then(function ($form) {
            if ($form) {
              $form.submit();
            }
          });
          e.preventDefault();
        });
      }

      var submitFunction = function () {
        var d = new exitintel.util.jQuery.Deferred();

        var ad = exitintel.util.jQuery.data(element, 'adObject');

        var $form = $('<form></form>')
                        .attr('action', action.params.url)
                        .attr('method', 'POST');

        // Handle submit methods
        switch (action.params.submitMethod) {
          case 'current-window':
            // Do nothing. Defaults work.
          break;

          case 'new-window':
            $form.attr('target', 'blank');
          break;

          case 'ajax':
            $form.on('submit', function (e) {
              e.preventDefault();

              exitintel.util.jQuery.post(action.params.url, $(this).serialize(), function () {
                // resolve on done
                d.resolve();
              }).fail(function() {
                alert( "An error occured. Please check your data and try again later." );
                d.reject();
              })
              ;
            });
          break;
        }

        // Add ad elements
        for (var i in action.params.includedData) {

          // Prototype.js fix
          if (typeof action.params.includedData[i] == 'function') {
            continue;
          }

          var container = ad.popupElement ? ad.popupElement : ad.persistentElement;

          var inputElement = container.find('[data-exitintel-name="' + i + '"]');
          var val = inputElement.val();
          var name = action.params.includedDataVarName[i];

          // Run element validators
          var validators = $.data(inputElement[0], 'validators');

          if (validators) {
            for (var j = 0; j < validators.length; j++) {
              if (!validators[j](val)) {
                d.reject();
                return d.promise(); // Abandon submit
              }
            }
          }

          var $el = $('<input/>')
                  .attr('name', name)
                  .val(val);

          $form.append($el);
        }

        // Add additional elements
        if (action.params.additionalVars) {
          for (var k in action.params.additionalVars) {
            var v = action.params.additionalVars[k];

            var $elem = $('<input/>')
                    .attr('name', v.name)
                    .val(v.value);
            $form.append($elem);
          }
        }

        // Add form to document
        exitintel.util.jQuery('body').append($form);

        // Submit
        $form.submit();

        // Resolve if not ajax (ajax handled by callback)
        if (action.params.submitMethod !== 'ajax') {
          d.resolve($form);
        }

        return d.promise();
      };

      if (action.params.submitMethod == 'new-window') {
        // Return a resolved promise (the handler is attached on the element onclick)
        return function () {
          var d = new exitintel.util.jQuery.Deferred();
          d.resolve();
          return d.promise();
        };
      }

      return submitFunction;
    }
  },
  triggerAd: {
    install: function (element, action) {
      return function () {
        var d = new exitintel.util.jQuery.Deferred();

        for (var i = 0; i < exitintel.campaign.available.length; i++) {
          var c = exitintel.campaign.available[i];

          if (c.id != action.params.campaignId) {
            continue;
          }

          var ad = null;

          // jshint -W106
          if (!action.params.adId) {
            // Check if there is a selected ad
            if (c.selectedAd) {
              ad = c.selectedAd;
            } else {
              // choose one at random
              var rand = Math.floor(Math.random()*(c.enabled_ads.length));
              ad = c.enabled_ads[rand];
            }
          } else {
            // Find ad
            for (var j = 0; j < c.enabled_ads.length; j++) {
              if (c.enabled_ads[j].id == action.params.adId) {
                ad = c.enabled_ads[j];
                break;
              }
            }
            exitintel.util.log('Could not find ad ' + action.params.adId + ' in enabled ads.');
          }
          // jshint +W106


          // jshint -W083
          // function in loop
          exitintel.ad.install(ad, { noTriggers: true })
            .then(function (adDisplay) {
              var step = 1;
              if (action.params.stepMode && action.params.stepMode === "auto"){
                step = exitintel.ad.findStepWithEmail(adDisplay);

                if (step === -1){
                  step = 1;
                }
              } else {
                if (typeof action.params.step != 'undefined' && action.params.step) {
                   step = parseInt(action.params.step, 10);
                }
              }
              exitintel.ad.showAdFunction(ad, adDisplay, {stepNumber: step-1})(function () {
                adDisplay.showPanel(step -1);
              });
              d.resolve();
            }, function () {
              // On fail
              d.reject();
            });
          // jshint +W083
        }
        return d.promise();

      };
    }
  },

  collectData: {
    install: function (element, action) {
      return function () {
        var d = new exitintel.util.jQuery.Deferred();

        var data = [];

        var ad = exitintel.util.jQuery.data(element, 'adObject');

        // Add elements
        if (action.params && action.params.includedData) {

          for (var i in action.params.includedData) {

            if (typeof action.params.includedData[i] == 'function') { // Prototype.js fix
              continue;
            }

            // Disabled
            if (action.params.includedData[i] === false) {
              continue;
            }

            var container = ad.overlayElement ? ad.overlayElement : ad.persistentElement;

            var inputElement = container.find('[data-exitintel-name="' + i + '"]');
            var val = inputElement.val();
            var name = action.params.includedDataVarName[i];

            /*

            // FIX ME. Find a way to support this.

            try {
              if (!inputElement[0].checkValidity()) {
                d.reject();
                return d.promise();
              }
            } catch (e) {
              // Business as usual
            }
            */

            // Run element validators
            var validators = $.data(inputElement[0], 'validators');

            if (validators) {
              for (var j = 0; j < validators.length; j++) {
                if (!validators[j](val)) {
                  d.reject();

                  return d.promise(); // Abandon submit
                }
              }
            }

            data.push({
              name: name,
              value: val,
              order: action.params.includedDataOrder && action.params.includedDataOrder[i] ? action.params.includedDataOrder[i] : 0
            });
          }
        }

        data.sort(function (a, b) {
          if (a.order < b.order) {
            return -1;
          }
          if (a.order > b.order) {
            return 1;
          }

          return 0;
        });

        var orderedData = {};

        var dataNames = [];

        try {
          dataNames = data.map(function (d) {
            return d.name;
          });
        } catch (e) {
          dataNames = [];
        }

        for (var k = 0; k < data.length; k++) {
          orderedData[data[k].name] = data[k].value;
        }

        var trackedCampaign = exitintel.campaign.get(ad.campaignId);
        var trackedAd = trackedCampaign.selectedAd;

        exitintel.visitor.setConvertedCampaign(ad.campaignId, { adId: ad.adId });

        exitintel.event.log('collect-data', {
          campaignId: ad.campaignId,
          adId: trackedAd.id,
          data: orderedData,
          onDone: function (success) {
            if (success) {
              d.resolve();

              // Record gathered data in profile
              for (var ki = 0; ki < dataNames.length; ki++) {
                exitintel.visitor.setGatheredData(dataNames[ki]);
              }

              try {
                exitintel.events.emit('data-collected', {
                  campaignId: ad.campaignId,
                  adId: ad.adId,
                  element: element.attr('data-exitintel-label'),
                  data: orderedData
                });
              } catch (e) {
                exitintel.util.error(e);
              }
            } else {
              alert('Your data was not sent. Please try again in a few moments.');
              d.reject();
            }
          }
        });


        return d.promise();
      };
    }
  },
  customCode: {
    install: function (element, action) {

      if (action.params.code.indexOf('deferred.resolve()') == -1) {
        action.params.code += ";\ndeferred.resolve();";
      }
      if (action.params.code.indexOf('return deferred.promise();') == -1) {
        action.params.code += ";\nreturn deferred.promise();";
      }

      /*jshint -W054 */
      var fn = new Function('deferred', 'element', 'action', action.params.code);
      /*jshint +W054 */

      return function () {
        var d = new exitintel.util.jQuery.Deferred();
        return fn(d, element, action);
      };
    }
  },

  integrationGoogleAnalytics: {
    install: function (element, action) {
      return function () {
        var ad = exitintel.util.jQuery.data(element, 'adObject');

        var d = new exitintel.util.jQuery.Deferred();

        var trackedCampaign = exitintel.campaign.get(ad.campaignId);
        var trackedAd = trackedCampaign.selectedAd;

        if (typeof action.params == 'undefined') {
          action.params = {};
        }

        exitintel.integrations.ga.trackEvent(
          action.params.eventCategory || 'Exit Intel',
          action.params.eventAction || 'Conversion',
          action.params.eventLabel || trackedCampaign.title + ' / ' + trackedAd.title,
          action.params.eventValue || 0
        );

        d.resolve();

        return d.promise();
      };
    }
  },

  integrationMailchimp: {
    install: function (element, action) {
      return function () {
        var ad = exitintel.util.jQuery.data(element, 'adObject');

        if (!action.params) {
          action.params = {};
        }

        var d = new exitintel.util.jQuery.Deferred();

        var data = {};

        // Add elements
        if (action.params && action.params.includedData) {
          for (var i in action.params.includedData) {

            if (typeof action.params.includedData[i] == 'function') { // Prototype.js fix
              continue;
            }

            var container = ad.popupElement ? ad.popupElement : ad.persistentElement;

            var inputElement = container.find('[data-exitintel-name="' + i + '"]');
            var val = inputElement.val();
            var name = action.params.includedDataVarName[i];

            // Run element validators
            var validators = $.data(inputElement[0], 'validators');

            if (validators) {
              for (var j = 0; j < validators.length; j++) {
                if (!validators[j](val)) {
                  d.reject();

                  return d.promise(); // Abandon submit
                }
              }
            }

            data[name] = val;
          }
        }

        if (exitintel.visitor.session.ip) {
	  /*jshint -W069 */
          data['optin_ip'] = exitintel.visitor.session.ip;
	  /*jshint +W069 */
        }

        $.ajax({
          url: exitintel.config.apiURL + '/integration/mailchimp/addToList/' + ad.adId,
          jsonp: 'callback',
          dataType: 'jsonp',
          data: data,
          timeout: 10000,
          success: function (response) {
            if (response.status != 'success') {
              alert("We were unable to process your information. Please check your email address and try again in a few moments.");
              d.reject();
              return;
            }

            d.resolve();
          },
          error: function () {
            alert("We were unable to process your information. Please check your email address and try again in a few moments.");
            d.reject();
          }
        });

        return d.promise();

      };
    }
  },
  reloadAds: {
    install: function () {
      return function () {
        var d = new exitintel.util.jQuery.Deferred();

        // Unselect ads
        for (var j = 0; j < exitintel.campaign.available.length; j++) {
          exitintel.campaign.available[j].selectedAd = null;
        }

        // Hide all visible ads
        for (var i in exitintel.ad.visibleAds) {

          var adDisplay = exitintel.ad.visibleAds[i];

          if (typeof adDisplay == 'function') {
            continue;
          }

          if (!adDisplay) {
            continue;
          }

          adDisplay.hide();
        }

        // Clear installed ads
        exitintel.ad.installedAds = {};

        // Clear active campagins
        exitintel.campaign.active = [];

        // Uninstall triggers
        exitintel.trigger.uninstallAll();
        exitintel.ad.adTriggers = {};

        // Re-init
        exitintel.campaign.campaignsLoaded();

        d.resolve();
        return d;
      };
    }
  },
  integrationsManager: {
    install: function (element, action) {
      return function () {
        var ad = exitintel.util.jQuery.data(element, 'adObject');

        if (!action.params) {
          action.params = {};
        }

        var d = new exitintel.util.jQuery.Deferred();

        var data = {};
        var container = ad.popupElement ? ad.popupElement : ad.persistentElement;

        // Add elements
        if (action.params && action.params.fields) {
          for (var i in action.params.fields) {
            var inputElement = container.find('[data-exitintel-name="' + i + '"]');
            var val = inputElement.val();
            var name = action.params.fields[i];

            // Run element validators
            var validators = $.data(inputElement[0], 'validators');

            if (validators) {
              for (var j = 0; j < validators.length; j++) {
                if (!validators[j](val)) {
                  d.reject();

                  return d.promise(); // Abandon submit
                }
              }
            }

            data[name] = val;
          }
        }

        //if (exitintel.visitor.session.ip) {
          /*jshint -W069 */
          //data['optin_ip'] = exitintel.visitor.session.ip;
          /*jshint +W069 */
        //}

        if (action.params) {
          var integration = action.params.integration.split(':');
          var integrationType = integration[0].toLowerCase();
          var integrationId = integration[1];

          var inputElem = container.find('[data-exitintel-name="' + action.params.emailField + '"]');
          var emailValue = inputElem.val();

          exitintel.integrations[integrationType].send(integrationId, emailValue, data, false)
            .fail(function () {
              alert("We were unable to process your information. Please check your email address and try again in a few moments.");

              d.reject();
            })
            .done(function () {
              d.resolve();
            });
        }

        return d.promise();
      };
    }
  },

  fbLeadEvent: {
    install: function (element, action) {
      return function () {
        if (!action.params) {
          action.params = {};
        }

        var d = new exitintel.util.jQuery.Deferred();

        if (window.fbq && typeof window.fbq === 'function') {
          window.fbq('track', 'Lead', action.params);
        }

        d.resolve();
        return d;
      };
    }
  },

  acceptDeclinePrompt: {
    install: function (element, action) {
      return function () {
        var d = exitintel.util.jQuery.Deferred();
        var c = exitintel.util.jQuery.Deferred();
        var countries = [
          { 'code': 'AT', 'name': 'Austria' },
          { 'code': 'BE', 'name': 'Belgium' },
          { 'code': 'BG', 'name': 'Bulgaria' },
          { 'code': 'HR', 'name': 'Croatia' },
          { 'code': 'CY', 'name': 'Republic of Cyprus' },
          { 'code': 'CZ', 'name': 'Czech Republic' },
          { 'code': 'DK', 'name': 'Denmark' },
          { 'code': 'EE', 'name': 'Estonia' },
          { 'code': 'FI', 'name': 'Finland' },
          { 'code': 'FR', 'name': 'France' },
          { 'code': 'DE', 'name': 'Germany' },
          { 'code': 'GR', 'name': 'Greece' },
          { 'code': 'HU', 'name': 'Hungary' },
          { 'code': 'IE', 'name': 'Ireland' },
          { 'code': 'IT', 'name': 'Italy' },
          { 'code': 'LV', 'name': 'Latvia' },
          { 'code': 'LT', 'name': 'Lithuania' },
          { 'code': 'LU', 'name': 'Luxembourg' },
          { 'code': 'MT', 'name': 'Malta' },
          { 'code': 'NL', 'name': 'Netherlands' },
          { 'code': 'PL', 'name': 'Poland' },
          { 'code': 'PT', 'name': 'Portugal' },
          { 'code': 'RO', 'name': 'Romania' },
          { 'code': 'SK', 'name': 'Slovakia' },
          { 'code': 'SI', 'name': 'Slovenia' },
          { 'code': 'ES', 'name': 'Spain' },
          { 'code': 'SE', 'name': 'Sweden' },
          { 'code': 'GB', 'name': 'UK' }
        ];

        if (!action.params) {
          action.params = {};
        }

        var userCountry = exitintel.storage.get('userCountry');

        if (!userCountry) {
          exitintel.util.getCountry().then(function (country) {
            exitintel.storage.set('userCountry', country, 100);

            c.resolve(country);
          });
        } else {
          setTimeout(function () {
            c.resolve(userCountry);
          });
        }

        c.promise().then(function (country) {
          var checkCountries = action.params.countries;
          // Check EU Economic Area
          if (checkCountries.indexOf('EU') !== -1) {
            checkCountries = checkCountries.filter(function (country) {
              return country !== 'EU';
            }).concat(countries.map(function (country) {
              return country.code;
            }));
          }

          if (checkCountries.length > 0 && checkCountries.indexOf(country) === -1) {
            d.resolve();
            return;
          }

          var promptHtml = '<div class="exi_alert">' +
            '<div class="exi_alert_overlay_cover"></div>' +
            '<div class="exi_css_reset exi_alert_container exi_alert_defaults">' +
              '<div class="exi_css_reset exi_alert_container_inner exi_alert_defaults">' +
                '<div class="exi_alert_title exi_alert_defaults">' +
                  '<img src="'+ (action.params.icon === 'eu' ? 'https://assets.exitintel.com/eu_gdpr.png' : exitintel.config.cdnURL + action.params.customIcon) + '" width="25" height="25" class="exi_gdpr_icon">' +
                  action.params.title +
                '</div>' +
                '<div class="exi_alert_body exi_alert_defaults">' +
                  action.params.body +
                '</div>' +
                '<div class="exi_alert_actions exi_alert_defaults">' +
                  '<a href="#" class="exi_css_reset exi_alert_defaults exi_alert_action_secondary">' + action.params.decline.text + '</a>' +
                  '<a href="#" class="exi_css_reset exi_alert_defaults exi_alert_action_primary">' + action.params.accept.text + '</a>' +
                '</div>' +
              '</div>' +
              '<div class="exi_below_alert_copy">' +
                action.params.footnote +
              '</div>' +
            '</div>' +
          '</div>';

          exitintel.util.jQuery('body').append(promptHtml);
          exitintel.util.jQuery('.exi_alert').fadeIn(200);

          exitintel.util.jQuery('.exi_alert .exi_alert_action_secondary').click(function () {
            exitintel.util.jQuery('.exi_alert').remove();

            if (action.params.decline.action === 'goto-step') {
              var ad = exitintel.util.jQuery.data(element, 'adObject');

              ad.showPanel(action.params.decline.step, true);
            }

            d.reject();
          });

          exitintel.util.jQuery('.exi_alert .exi_alert_action_primary').click(function () {
            exitintel.util.jQuery('.exi_alert').remove();
            d.resolve();
          });
        });

        return d;
      };
    }
  }
};


exitintel.renderers = {
  setZIndexes: function (container, layers, start) {
    start = start || 0;

    for (var obi = 0; obi < layers.length; obi++) {
      var el = container.find('[data-exitintel-name="' + layers[obi] + '"]');
      el.css({
        zIndex: start + layers.length - obi
      });
      if (el.parent().attr("data-exitintel-rotated") === "1"){
        el.parent().css({
          zIndex: start + layers.length - obi
        });
      }
    }
  },

  setAbsoluteElementAxisPosition: function (axisAnchorPoints, elementSpec, $el) {

    for (var j = 0; j < axisAnchorPoints.length; j++) {
      var p = axisAnchorPoints[j];
      if (elementSpec.position[p]) {
        $el.css(p, exitintel.util.sizeFormat(elementSpec.position[p]));
        break;
      }
    }

  },

  setElementPosition: function (el, elementSpec) {

    if (!elementSpec.position.mode) {
      elementSpec.position.mode = 'exact';
    }

    // Exact position - horizontal
    if (elementSpec.position.mode && elementSpec.position.mode === 'exact' || elementSpec.position.mode == 'exact-horizontal-relative-vertical') {
      exitintel.renderers.setAbsoluteElementAxisPosition(['left', 'right'], elementSpec, el);
    }

    // Exact position - vertical
    if (elementSpec.position.mode && elementSpec.position.mode === 'exact' || elementSpec.position.mode == 'relative-horizontal-exact-vertical') {
      exitintel.renderers.setAbsoluteElementAxisPosition(['top', 'bottom'], elementSpec, el);
    }

    // Relative position - horizontal
    if (elementSpec.position.mode && elementSpec.position.mode === 'relative' || elementSpec.position.mode == 'relative-horizontal-exact-vertical') {
      switch (elementSpec.position.setX) {
        case 'left':
          el.css('left', elementSpec.position.horizontalOffset || '0px');
          break;
        case 'right':
          el.css('right', elementSpec.position.horizontalOffset || '0px');
          break;
        case 'center':
          el.css('left', 'calc(50% - ' + elementSpec.size.width + ' / 2' + (elementSpec.position.horizontalOffset ? ' + (' + elementSpec.position.horizontalOffset + ')' : '') + ')');
          break;
      }
    }

    // Relative position - vertical
    if (elementSpec.position.mode && elementSpec.position.mode === 'relative' || elementSpec.position.mode == 'exact-horizontal-relative-vertical') {
      switch (elementSpec.position.setY) {
        case 'top':
          el.css('top', elementSpec.position.verticalOffset || '0px');
          break;
        case 'bottom':
          el.css('bottom', elementSpec.position.verticalOffset || '0px');
          break;
        case 'middle':
          el.css('top', 'calc(50% - ' + elementSpec.size.height + ' / 2' + (elementSpec.position.verticalOffset ? ' + (' + elementSpec.position.verticalOffset + ')' : '') + ')');
          break;
      }
    }
  },

  setElementBackground: function (el, elementSpec) {
    if (elementSpec.transparent) {
      el.css('background', 'transparent');
    } else {
      if (elementSpec.backgroundColor && elementSpec.backgroundColor.match(/gradient/)) {
        // Fallback color
        var fallbackColor = elementSpec.backgroundColor
          .match(/gradient\((.*)\)/)[1]
          .split(',')
          .slice(1)
          .join(',')
          .trim()
          .split('%')[0]
          .match(/(rgb\([^\)]+\)|rgba\([^\)]+\))/)[1];

        el.css('background', fallbackColor);
        el.css('background', elementSpec.backgroundColor);
      } else if(elementSpec.backgroundColor) {
        el.css('background', elementSpec.backgroundColor);
      } else {
        el.css('background', "transparent");
      }
    }

    if (elementSpec.backgroundImage) {
      var gradientColor = '';
      if (elementSpec.backgroundColor && elementSpec.backgroundColor.indexOf('gradient')!==-1){
        gradientColor = ','+elementSpec.backgroundColor;
      }
      el.css({
        'background-image': 'url(' + exitintel.config.cdnURL + elementSpec.backgroundImage + ')'+gradientColor,
        'background-repeat': 'no-repeat'
      });

      if (elementSpec.backgroundPosition) {
        el.css({
          'background-position': '' +
            elementSpec.backgroundPosition.horizontal +
            ' ' +
            elementSpec.backgroundPosition.vertical
        });
      }

      if (elementSpec.backgroundSize) {
        el.css({
          'background-size': elementSpec.backgroundSize
        });
      } else {
        el.css({
          'background-size': '100%'
        });
      }
    }
  },

  setElementOpacity: function (el, elementSpec) {
    el.css({
      'opacity': isNaN(parseInt(elementSpec.opacity)) ? 1 : (parseInt(elementSpec.opacity) / 100).toFixed(2)
    });
  },

  setElementRotation: function (el, elementSpec) {
    var rotation = parseInt(elementSpec.rotation);
    if (!isNaN(rotation)) {
      el.css({
        'transform': 'rotate(' + rotation + 'deg)',
        '-o-transform': 'rotate(' + rotation + 'deg)',
        '-ms-transform': 'rotate(' + rotation + 'deg)',
        '-moz-transform': 'rotate(' + rotation + 'deg)',
        '-webkit-transform': 'rotate(' + rotation + 'deg)'
      });
    }
  },

  setElementAlignment: function (el, elementSpec) {
     // Align
     if (elementSpec.align === 'left') {
      el.css('text-align', 'left');
    } else if (elementSpec.align === 'right') {
      el.css('text-align', 'right');
    } else {
      el.css('text-align', 'center');
    }
  },

  setElementPadding: function (el, elementSpec) {
     // Padding left
    if (elementSpec.padding && elementSpec.padding.left) {
      el.css('padding-left', elementSpec.padding.left);
      el.css('box-sizing', 'border-box');
    }

    // Padding right
    if (elementSpec.padding && elementSpec.padding.right) {
      el.css('padding-right', elementSpec.padding.right);
      el.css('box-sizing', 'border-box');
    }
 }
};


exitintel.renderers = exitintel.renderers || {};

exitintel.renderers.popup = function (campaignId, adId, template) {

  exitintel.util.log('Creating popup');

  this.campaignId = campaignId;
  this.adId = adId;
  this.version = "v2-popup";
  this.wrapperElement = $('<div></div>')
                    .addClass('exitintel-wrapper')
                    .attr('id', 'exitintel_wrapper_' + this.adId);

  this.animationsCss = '';

  this.currentPanel = null;

  this.showCallbacks = [];

  this.elementsCustomCSS = [];
  this.elementsStylesheets = [];

  this.template = template;

  this.overlayElement = $('<div></div>')
                    .addClass('exitintel-overlay')
                    .attr('id', 'exitintel_ovelay_' + this.adId)
                    .css({
                      'position': 'fixed',
                      'top': 0,
                      'left': 0,
                      //'background': template.overlayBackgroundColor || 'rgba(0, 0, 0, 0.8)',
                      'width': '100%',
                      'height': '100%',
                      'z-index': '81000003',
                      'display': 'none'
                    });

  exitintel.renderers.setElementBackground(this.overlayElement, {
    //transparent: false,
    backgroundColor: template.overlayBackgroundColor || 'rgba(0, 0, 0, 0.8)',
    backgroundImage: template.overlayBackgroundImage,
    backgroundPosition: template.overlayBackgroundPosition,
    backgroundSize: 'cover'
  });

  this.popupElement = $('<form></form>')
                    .addClass('exitintel-popup')
                    .attr('id', 'exitintel_popup_' + this.adId)
                    .css({
                      'position':   'absolute',
                      'width':      template.width,
                      'height':     template.height,
                      'margin':     0,
                      'padding':    0,

                      'left':       '50%',
                      'margin-left': ((-1)*parseInt(template.width, 10)/2) + 'px',

                      'top':        '50%',
                      'margin-top': ((-1)*parseInt(template.height, 10)/2) + 'px',

                      'display':    'none'
                    });

  this.popupElement.on('submit', function (e) {
    e.preventDefault();
  });

  exitintel.renderers.setElementBackground(this.popupElement, template);

  this.renderBrandingLink(template);

  // Render panels
  exitintel.util.log('Rendering panels');
  for (var i = 0; i < template.panels.length; i++) {
    this.renderPanel(i, template.panels[i]);
  }

  // Add popup to overlay
  this.overlayElement.append(this.popupElement);

  // Add to page
  this.wrapperElement.append(this.overlayElement);
  $('body').append(this.wrapperElement);


  // Install default handler (on Enter key)
  var theAd = this;
  var theTemplate = template;

  exitintel.util.log('Installing default handler for enter');
  this.popupElement.keypress(function(event){
    if(event.keyCode == 13){
        // Get current panel default action
        var currentPanel = theTemplate.panels[theAd.currentPanel];

        if (currentPanel === null) {
          exitintel.util.log('No current panel. Cannot trigger default action');
          return;
        }

        if (currentPanel.onEnter) {
          var $p = theAd.popupElement;

          // Click that button
          $p.find('#exitintel_panel_' + theAd.currentPanel + ' [data-exitintel-name="' + currentPanel.onEnter + '"]').click();
        }

    }
  });
};

exitintel.renderers.popup.prototype.renderPanel = function (panelId, panel) {
  var panelElement = $('<div></div>')
                      .addClass('exitintel-panel')
                      .attr('id', 'exitintel_panel_' + panelId)
                      .attr('data-panel-id', panelId)
                      .css({
                        'position': 'absolute',
                        'width': '100%',
                        'height': '100%'
                      });


  if (panel.backgroundImage) {

    if (typeof exitintel.util.ieVersion() != 'undefined' && exitintel.util.ieVersion() < 9) {
      var backgroundImage = $('<div></div>');

      backgroundImage.attr('style', "position:relative;width:100%;height:100%;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader( src='" + exitintel.config.cdnURL + panel.backgroundImage + "', sizingMethod='scale')");
/*
      backgroundImage.css({
        //'-ms-filter': "progid:DXImageTransform.Microsoft.AlphaImageLoader( src='" + exitintel.config.cdnURL + panel.backgroundImage + "', sizingMethod='scale')",
        //'filter': "progid:DXIageTransform.Microsoft.AlphaImageLoader( src='" + exitintel.config.cdnURL + panel.backgroundImage + "', sizingMethod='scale')",
        'position': 'relative',
        'width': '100%',
        'height': '100%'
      });
*/
      panelElement.append(backgroundImage);
    } else {
      panelElement.css({
        'background': 'transparent url(\'' + exitintel.config.cdnURL + panel.backgroundImage + '\') 0 0 no-repeat',
        'background-size': '100% 100%'
      });

    }
  }

  if (panel.backgroundPosition) {
    panelElement.css({
      'background-position': '' +
        panel.backgroundPosition.horizontal +
        ' ' +
        panel.backgroundPosition.vertical
    });
  }

  var renderersMap = {
    'label':          'label',
    'input-email':    'inputEmail',
    'input-general':  'inputGeneral',
    'button':         'button',
    'countdown':      'countdown'
  };

  for (var i = 0; i < panel.elements.length; i++) {

    var elementSpec = panel.elements[i];

    // Run element renderer
    var elementRenderer = renderersMap[elementSpec.type];
    var el = exitintel.renderers.element[elementRenderer](elementSpec, this);
    var wrapper = null;

    el.attr('data-element-panel-id', panelId);

    if (elementSpec.backgroundColor && typeof exitintel.util.ieVersion() != 'undefined') {
      if (exitintel.util.ieVersion() < 9) {
        elementSpec.backgroundColor = elementSpec.backgroundColor.replace(/^rgba\((\d+)[^\d]+(\d+)[^\d]+(\d+)*/, 'rgb($1, $2, $3)');
      }
    }

    var rotation = parseInt(elementSpec.rotation);

    if (!isNaN(rotation) && rotation !== 0) {
      wrapper = $('<div/>');

      // Position and style element
      wrapper.css({
        'position': 'absolute',
        'width': exitintel.util.sizeFormat(elementSpec.size.width),
        'height': exitintel.util.sizeFormat(elementSpec.size.height),
        'border': 'none',
        'padding': 0,
        'outline': 'none'
      });

      wrapper.attr('data-exitintel-rotated', 1);

      // Position and style element
      el.css({
        'text-align': elementSpec.align,
        'width': '100%',
        'height': '100%',
        'font': elementSpec.font.weight + ' ' + elementSpec.font.size + 'px ' + elementSpec.font.family,
        'line-height': elementSpec.font.height + 'px',
        'color': elementSpec.color,
        'border': 'none',
        'padding': 0,
        'outline': 'none',
        'position': 'absolute'
      });

      exitintel.renderers.setElementPosition(wrapper, elementSpec);
      exitintel.renderers.setElementBackground(el, elementSpec);
      exitintel.renderers.setElementOpacity(el, elementSpec);
      exitintel.renderers.setElementRotation(wrapper, elementSpec);
      exitintel.renderers.setElementAlignment(el, elementSpec);
      exitintel.renderers.setElementPadding(el, elementSpec);

      wrapper.append(el);
    } else {
      // Position and style element
      el.css({
        'text-align': elementSpec.align,
        'position': 'absolute',
        'width': exitintel.util.sizeFormat(elementSpec.size.width),
        'height': exitintel.util.sizeFormat(elementSpec.size.height),
        'font': elementSpec.font.weight + ' ' + elementSpec.font.size + 'px ' + elementSpec.font.family,
        'line-height': elementSpec.font.height + 'px',
        'color': elementSpec.color,
        'border': 'none',
        'padding': 0,
        'outline': 'none'
      });

      exitintel.renderers.setElementPosition(el, elementSpec);
      exitintel.renderers.setElementBackground(el, elementSpec);
      exitintel.renderers.setElementOpacity(el, elementSpec);
      exitintel.renderers.setElementAlignment(el, elementSpec);
      exitintel.renderers.setElementPadding(el, elementSpec);
    }

    // Custom element classes
    if (typeof elementSpec.classNames != 'undefined') {
      try {
        var additionalClasses = elementSpec.classNames.split(' ');
        for (var kk in additionalClasses) {
          el.addClass(additionalClasses[kk]);
        }
      } catch (e) {

      }
    }

    // Additional styles
    if (typeof elementSpec.additionalStyles == 'string') {
      el.attr('style', el.attr('style') + ';' + elementSpec.additionalStyles);
    }

    // Additional CSS
    if (elementSpec.customCSS) {
      this.elementsCustomCSS.push(elementSpec.customCSS);
    }

    // Hover effects
    if (elementSpec.hover && elementSpec.hover.enabled) {
      el.css('transition-duration', elementSpec.hover.duration + 's');

      if (elementSpec.hover.effect !== 'crossfade') {
        el.addClass('hvr-' + elementSpec.hover.effect);
      } else {
        el.css('transition-properties', 'all');
      }

      if (elementSpec.hover.image) {
        this.elementsCustomCSS.push('[data-exitintel-name="' + elementSpec.name + '"]:hover { background-image: url(\'' + exitintel.config.cdnURL + elementSpec.hover.image + '\') !important; } ');
      }
    }

    if (elementSpec.container == 'outer') {
      this.overlayElement.append(wrapper || el);
    } else {
      panelElement.append(wrapper || el);
    }
  }

  var layerIterationOrder = ["inner", "outer-above-inner", "outer-below-inner"];
  var tabindex = 1;

  // Add tabindex on each element, starting from the inner layer
  layerIterationOrder.forEach(function(layerType){

    // Fix for legacy ads
    if (typeof panel.layers === 'undefined' || typeof panel.layers[layerType] === 'undefined') {
      return;
    }

    for (var j = 0; j < panel.layers[layerType].length; j++) {
      var elementName = panel.layers[layerType][j];
      var elm = null;
      if (layerType === "inner"){
         elm = panelElement.find('[data-exitintel-name=' + elementName + '][data-element-panel-id='+ panelId +']');
      } else {
        elm = this.overlayElement.find('[data-exitintel-name=' + elementName + '][data-element-panel-id='+ panelId +']');
      }
      elm.attr('tabindex', tabindex);
      tabindex += 1;
    }
  }.bind(this));

  this.popupElement.append(panelElement);
};

exitintel.renderers.popup.prototype.showPanel = function (panelId, enableAnimations) {

  var animationOut = null;
  var animationIn = null;

  var animationDuration = 0.2;

  if (enableAnimations && this.template.animations && this.template.animations.transition && this.template.animations.transition.effect) {
    animationOut = this.template.animations.transition.effect.animations[0];
    animationIn = this.template.animations.transition.effect.animations[1];

    if (this.template.animations.transition.duration) {
      animationDuration = this.template.animations.transition.duration;
    }
  }

  if (animationOut) {
    exitintel.util.runAnimation(this.popupElement, animationOut, animationDuration/2).then(function () {
      this.showPanelNext(panelId, animationIn, animationDuration/2);
    }.bind(this));
  } else {
    this.showPanelNext(panelId, animationIn, animationDuration);
  }

};

exitintel.renderers.popup.prototype.showPanelNext = function(panelId, animation) {
  // Hide all panels
  this.popupElement.find('.exitintel-panel').hide();

  // Hide elements from other panels (in case attached to outer container)
  this.overlayElement.find('[data-element-panel-id][data-element-panel-id!=' + panelId + ']').hide();

  if (animation) {
    exitintel.util.runAnimation(this.popupElement, animation, 0.5);
  }

  // Show elements of this panel
  this.overlayElement.find('[data-element-panel-id=' + panelId + ']').show();

  // Show the one
  this.popupElement.find('[data-panel-id=' + panelId + ']').show();

  // Set current panel
  this.currentPanel = panelId;

  // Set Z-Indexes
  if (this.template.panels[panelId].layers) {
    exitintel.renderers.setZIndexes(this.overlayElement, this.template.panels[panelId].layers['outer-below-inner']);

    this.popupElement.css({
      zIndex: this.template.panels[panelId].layers['outer-below-inner'].length + 1
    });

    exitintel.renderers.setZIndexes(this.popupElement, this.template.panels[panelId].layers.inner);
    exitintel.renderers.setZIndexes(this.overlayElement, this.template.panels[panelId].layers['outer-above-inner'], this.template.panels[panelId].layers['outer-below-inner'].length + 1);
  }

  // Run element animations
  exitintel.ad.runElementsAnimations(this.template, panelId);
};

exitintel.renderers.popup.prototype.show = function () {

  exitintel.util.log('Showing ad');

  // Show overlay
  this.wrapperElement.show();
  this.overlayElement.show();


  if (this.template.animations && this.template.animations.appearence && this.template.animations.appearence.effect) {
    exitintel.util.runAnimation(this.popupElement, this.template.animations.appearence.effect, this.template.animations.appearence.duration || 0.2);
  }

  if (this.template.animations && this.template.animations.overlayAppearence && this.template.animations.overlayAppearence.effect) {
    exitintel.util.runAnimation(this.overlayElement, this.template.animations.overlayAppearence.effect, this.template.animations.overlayAppearence.duration || 0.2);
  }

  // Show popup
  this.popupElement.show();

  // Show the first panel
  this.showPanel(0);

  // Register
  exitintel.ad.visibleAds.popup = this;

  if (this.showCallbacks.length) {
    for (var i = 0; i < this.showCallbacks.length; i++) {
      this.showCallbacks[i].call();
    }
  }

  // Enable style
  exitintel.ad.enableCustomCSS(this.adId, this.template, this);

  // Fix for issue with iOS 11 misplacing the element
  if (typeof exitintel.util.iOSversion() == 'object' && exitintel.util.iOSversion()[0] == 11) {
    exitintel.visitor.session.currentScroll = exitintel.util.jQuery(window).scrollTop();
    exitintel.ad.enableCustomCSS('ios11-fix', { customCSS: 'body { position: fixed !important; } html,body{ -webkit-overflow-scrolling : touch !important; overflow: auto !important; height: 100% !important; width: 100% !important } '});
  }

};

exitintel.renderers.popup.prototype.hide = function () {

  var closingAnimationPromises = [];
  // Overlay closing animation
  if (this.template.animations && this.template.animations.overlayClosing && this.template.animations.overlayClosing.effect) {
    closingAnimationPromises.push(exitintel.util.runAnimation(this.overlayElement, this.template.animations.overlayClosing.effect, this.template.animations.overlayClosing.duration || 0.2));
  }

  // Popup closing animation
  if (this.template.animations && this.template.animations.closing && this.template.animations.closing.effect) {
    closingAnimationPromises.push(exitintel.util.runAnimation(this.popupElement, this.template.animations.closing.effect, this.template.animations.closing.duration || 0.2));
  }

  if (closingAnimationPromises.length) {
    $.when.apply($, closingAnimationPromises).then(this.hideDone.bind(this));

  } else {
    this.hideDone();
  }
};

exitintel.renderers.popup.prototype.hideDone = function () {
  this.wrapperElement.hide();
  this.overlayElement.hide();
  this.popupElement.hide();

  // Unregister
  exitintel.ad.visibleAds.popup = null;

  // disable style
  exitintel.ad.disableCustomCSS(this.adId);

  // Fix for issue with iOS 11 misplacing the element
  if (typeof exitintel.util.iOSversion() == 'object' && exitintel.util.iOSversion()[0] == 11) {
    exitintel.ad.disableCustomCSS('ios11-fix');
    exitintel.util.jQuery(window).scrollTop(exitintel.visitor.session.currentScroll);
  }

};

exitintel.renderers.popup.prototype.renderBrandingLink = function (template) {
  // Add branding
  if (exitintel.config.whitelabel || (template.brandingLink == 'dont-show')) {
    return;
  }

  var brandingLink = $('<a></a>')
                      .addClass('exitintel-branding-link')
                      .attr('href', 'https://exitintelligence.com/?utm_source=powered_by_link&utm_medium=referral&utm_campaign=' + window.location.hostname)
                      .attr('target', '_blank')
                      .html('Powered by <strong>Exit Intelligence</strong>')
                      .css({
                        'color': 'white',
                        'font-family': 'Arial, Helvetica, sans-serif',
                        'font-size': '12px',
                        'position': 'absolute',
                        'bottom': '20px',
                        'text-decoration': 'none'
                      });

  // Position
  if (template.brandingLink === '' || ! template.brandingLink) {
    brandingLink.css('left', '20px');
  }
  if (template.brandingLink === 'bottom-right') {
    brandingLink.css('right', '20px');
  }

  // Get contrasting color
  var color = 'white';
  try {
    color = exitintel.util.getContrastingColor(template.overlayBackgroundColor, true);
  } catch (e) {
    color = 'white';
  }

  var scheme, borderColor, customCSS, styleBlock;

  brandingLink.css({ 'color': color });

  // "Fancy" logo
  if (exitintel.config.brandingType == 'fancy') {

    scheme = 'light';
    borderColor = 'FFF';

    if (color == '#000000') {
      scheme = 'dark';
      borderColor = '000';
    }

    brandingLink.html('<img src="' + exitintel.config.cdnURL + '/file/get/ei-logo-' + scheme + '.svg' + '" />');
    brandingLink.find('img').css({
      'width': '200px',
      'height': 'auto'
    });

    // Add border
    brandingLink.css({
      'border': '1px solid #' + borderColor + 'b',
      'border-radius': '5px',
      'padding': '5px 10px'
    });

    customCSS = '';

    customCSS += '.exitintel-branding-link:hover { transform: scale(1.1); opacity: 1; }';

    customCSS += '.exitintel-branding-link { transition: .3s; opacity: 0.8; }';

    styleBlock = $('<style>' + customCSS + '</style>')
            .attr('id', 'ei-style-branding')
            .attr('type', 'text/css');

    this.overlayElement.append(styleBlock);
  } else {
    // Split test branding link variations
    if (Math.random() > 0.5) {
      scheme = 'light';
      borderColor = 'FFF';

      if (color == '#000000') {
        scheme = 'dark';
        borderColor = '000';
      }

      brandingLink.attr('href', brandingLink.attr('href') + '&utm_term=20191105-svgboldtext');

      brandingLink.html('<img src="' + exitintel.config.cdnURL + '/file/get/ei-logo-test-20191105-svgboldtext-' + scheme + '.svg' + '" />');
      brandingLink.find('img').css({
        'width': '170px',
        'height': 'auto'
      });

    } else {
      brandingLink.attr('href', brandingLink.attr('href') + '&utm_term=Original');
    }
  }

  this.overlayElement.append(brandingLink);
};


exitintel.renderers = exitintel.renderers || {};

exitintel.renderers.persistent = function (campaignId, adId, template) {

  this.campaignId = campaignId;
  this.adId = adId;

  this.panels = [];

  this.showCallbacks = [];

  this.elementsCustomCSS = [];
  this.elementsStylesheets = [];

  this.template = template;

  this.wrapperElement = $('<div></div>')
                    .addClass('exitintel-wrapper')
                    .attr('id', 'exitintel_wrapper_' + this.adId);

  if (template.backgroundColor && typeof exitintel.util.ieVersion() != 'undefined') {
    if (exitintel.util.ieVersion() < 9) {
      if (template.backgroundColor.match(/rgba\(.*,[^d]*0\)/)) {
        template.backgroundColor = 'transparent';
      } else {
        template.backgroundColor = template.backgroundColor.replace(/^rgba\((\d+)[^\d]+(\d+)[^\d]+(\d+).*/, 'rgb($1, $2, $3)');
      }
    }
  }

  var position = 'fixed';

  if (template.persistentPosition && template.persistentPosition.type) {
    switch (template.persistentPosition.type) {
      case 'element-before':
      case 'element-inside-top':
      case 'element-inside-bottom':
      case 'element-after':
        position = 'relative';
        break;

      default:
        position = 'fixed';
        break;
    }
  }

  this.persistentElement = $('<form></form>')
                    .addClass('exitintel-persistent')
                    .attr('id', 'exitintel_persistent_' + this.adId)
                    .css({
                      'position':   position,
                      'display':    'none',
                      //'background': template.backgroundColor,
                      'text-align': 'center',
                      'z-index':    81000000,
                      'margin': 0,
                      'padding': 0
                    });

  this.persistentElement.on('submit', function (e) {
    e.preventDefault();
  });

  exitintel.renderers.setElementBackground(this.persistentElement, template);

  /*if (template.backgroundImage) {

    this.persistentElement.css({
        'background-image': 'url(\'' + exitintel.config.cdnURL + template.backgroundImage + '\')',
        'background-size': 'cover'
    });

    if (template.backgroundPosition) {
      this.persistentElement.css({
        'background-position': '' +
          (template.backgroundPosition.horizontal || '50%') +
          ' ' +
          (template.backgroundPosition.vertical || '50%')
      });
    }
  }*/

  this.innerCanvasElement = $('<div></div>')
                    .addClass('exitintel-inner-canvas')
                    .attr('id', 'exitintel_persistent_' + this.adId)
                    .css({
                      'position':   'relative',
                      'background-color': 'transparent',
                      'text-align': 'center',
                      'z-index':    81000001,
                      'margin':     'auto',
                      'top':        0,
                      'width':      template.persistentInnerCanvasPosition.width,
                      'height':     template.persistentInnerCanvasPosition.height
                    });

  // Apply persistent position rules
  var copiedProperties = {
    'top':        'top',
    'bottom' :    'bottom',
    'left' :      'left',
    'right':      'right',
    'marginLeft': 'margin-left',
    'marginTop':  'margin-top',
    'width':      'width',
    'height':     'height'
  };

  for (var j in copiedProperties) {

    // Prototype.js fix
    if (typeof copiedProperties[j] == 'function') {
      continue;
    }

    var value = template.persistentPosition[j];

    if (typeof value == 'undefined') {
      continue;
    }

    this.persistentElement.css(copiedProperties[j], value);
  }

  if (template.persistentPosition.rotation) {

    this.persistentElement.css('pointer-events', 'none');

    // Disable rotated ads on < IE9
    if (typeof exitintel.util.ieVersion() != 'undefined' && exitintel.util.ieVersion() < 9) {
      return false;
    }

    var transformVariations = ['transform', '-webkit-transform', '-moz-transform', '-ms-transform'];

    for (var tv = 0; tv < transformVariations.length; tv++) {
      this.persistentElement.css(transformVariations[tv], 'rotate(' + template.persistentPosition.rotation + 'deg)');
      this.persistentElement.css(transformVariations[tv] + '-origin', '0 0');
    }
  }


  // Render panels
  for (var i = 0; i < template.panels.length; i++) {
    this.renderPanel(i, template.panels[i]);
  }

  // Append inner canvas
  this.persistentElement.append(this.innerCanvasElement);

  // Add to page
  this.wrapperElement.append(this.persistentElement);


  if (template.persistentPosition && template.persistentPosition.type) {

    // Check if target exists
    switch (template.persistentPosition.type) {
      case 'element-before':
      case 'element-inside-top':
      case 'element-inside-bottom':
      case 'element-after':
        try {
          if ($(template.persistentPosition.element).length === 0) {
            throw 'Cannot find element: ' + template.persistentPosition.element;
          }
        } catch (e) {
          throw e;
        }
        break;
    }

    // Append element
    switch (template.persistentPosition.type) {
      case 'element-before':
        this.wrapperElement.insertBefore(template.persistentPosition.element);
        break;
      case 'element-inside-top':
        $(template.persistentPosition.element).prepend(this.wrapperElement);
        break;
      case 'element-inside-bottom':
        $(template.persistentPosition.element).append(this.wrapperElement);
        break;
      case 'element-after':
        this.wrapperElement.insertAfter(template.persistentPosition.element);
        break;

      default:
        $('body').append(this.wrapperElement);
        break;
    }
  } else {
    $('body').append(this.wrapperElement);
  }
};

exitintel.renderers.persistent.prototype.renderPanel = function (panelId, panel) {
  var panelElement = $('<div></div>')
                      .addClass('exitintel-panel')
                      .attr('id', 'exitintel_panel_' + panelId)
                      .attr('data-panel-id', panelId)
                      .css({
                        'position': 'absolute',
                        'width': '100%',
                        'height': '100%',
                        //'overflow': 'hidden',
                        'z-index': '81000004'
                      });

  if (panel.backgroundImage) {
    if (typeof exitintel.util.ieVersion() != 'undefined' && exitintel.util.ieVersion() < 9) {
      var backgroundImage = $('<div></div>');

      backgroundImage.attr('style', "position:relative;width:100%;height:100%;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader( src='" + exitintel.config.cdnURL + panel.backgroundImage + "', sizingMethod='scale')");
/*
      backgroundImage.css({
        'filter': "progid:DXImageTransform.Microsoft.AlphaImageLoader( src='" + exitintel.config.cdnURL + panel.backgroundImage + "', sizingMethod='scale')",
        '-ms-filter': "\"progid:DXImageTransform.Microsoft.AlphaImageLoader( src='" + exitintel.config.cdnURL + panel.backgroundImage + "', sizingMethod='scale')\"",
        'position': 'absolute',
        'width': '100%',
        'height': '100%'
      });
*/
      panelElement.append(backgroundImage);
    } else {
      panelElement.css({
        'background': 'transparent url(\'' + exitintel.config.cdnURL + panel.backgroundImage + '\') 0 0 no-repeat',
        'background-size': '100% 100%'
      });
    }
  }

  if (panel.backgroundPosition) {
    panelElement.css({
      'background-position': '' +
        panel.backgroundPosition.horizontal +
        ' ' +
        panel.backgroundPosition.vertical
    });
  }

  var renderersMap = {
    'label':          'label',
    'input-email':    'inputEmail',
    'input-general':  'inputGeneral',
    'button':         'button',
    'countdown':      'countdown'
  };

  for (var i = 0; i < panel.elements.length; i++) {

    var elementSpec = panel.elements[i];

    // Run element renderer
    var elementRenderer = renderersMap[elementSpec.type];
    var el = exitintel.renderers.element[elementRenderer](elementSpec, this);
    var wrapper = null;

    el.attr('data-element-panel-id', panelId);

    var rotation = parseInt(elementSpec.rotation);

    if (!isNaN(rotation) && rotation !== 0) {
      wrapper = $('<div/>');

      // Position and style element
      wrapper.css({
        'position': 'absolute',
        'width': exitintel.util.sizeFormat(elementSpec.size.width),
        'height': exitintel.util.sizeFormat(elementSpec.size.height),
        'border': 'none',
        'padding': 0,
        'outline': 'none'
      });

      // Position and style element
      el.css({
        'text-align': elementSpec.align,
        'width': '100%',
        'height': '100%',
        'font': elementSpec.font.weight + ' ' + elementSpec.font.size + 'px ' + elementSpec.font.family,
        'line-height': elementSpec.font.height + 'px',
        'color': elementSpec.color,
        'border': 'none',
        'padding': 0,
        'outline': 'none'
      });

      exitintel.renderers.setElementPosition(wrapper, elementSpec);
      exitintel.renderers.setElementBackground(el, elementSpec);
      exitintel.renderers.setElementOpacity(el, elementSpec);
      exitintel.renderers.setElementRotation(wrapper, elementSpec);
      exitintel.renderers.setElementAlignment(el, elementSpec);
      exitintel.renderers.setElementPadding(el, elementSpec);

      wrapper.append(el);
    } else {
      // Position and style element
      el.css({
        'text-align': elementSpec.align,
        'position': 'absolute',
        'width': exitintel.util.sizeFormat(elementSpec.size.width),
        'height': exitintel.util.sizeFormat(elementSpec.size.height),
        'font': elementSpec.font.weight + ' ' + elementSpec.font.size + 'px ' + elementSpec.font.family,
        'line-height': elementSpec.font.height + 'px',
        'color': elementSpec.color,
        'border': 'none',
        'padding': 0,
        'outline': 'none'
      });

      exitintel.renderers.setElementPosition(el, elementSpec);
      exitintel.renderers.setElementBackground(el, elementSpec);
      exitintel.renderers.setElementOpacity(el, elementSpec);
      exitintel.renderers.setElementAlignment(el, elementSpec);
      exitintel.renderers.setElementPadding(el, elementSpec);
    }

    // Custom element classes
    if (typeof elementSpec.classNames !== 'undefined') {
      try {
        var additionalClasses = elementSpec.classNames.split(' ');
        for (var kk in additionalClasses) {
          el.addClass(additionalClasses[kk]);
        }
      } catch (e) {

      }
    }

    // Additional styles
    if (typeof elementSpec.additionalStyles == 'string') {
      el.attr('style', el.attr('style') + ';' + elementSpec.additionalStyles);
    }

    // Additional CSS
    if (elementSpec.customCSS) {
      this.elementsCustomCSS.push(elementSpec.customCSS);
    }

    // Hover effects
    if (elementSpec.hover && elementSpec.hover.enabled) {
      el.css('transition-duration', elementSpec.hover.duration + 's');

      if (elementSpec.hover.effect !== 'crossfade') {
        el.addClass('hvr-' + elementSpec.hover.effect);
      } else {
        el.css('transition-properties', 'all');
      }

      if (elementSpec.hover.image) {
        this.elementsCustomCSS.push('[data-exitintel-name="' + elementSpec.name + '"]:hover { background-image: url(\'' + exitintel.config.cdnURL + elementSpec.hover.image + '\') !important; } ');
      }
    }

    if (elementSpec.container == 'outer') {
      this.persistentElement.append(wrapper || el);
    } else {
      panelElement.append(wrapper || el);
    }
  }

  this.innerCanvasElement.append(panelElement);
};


exitintel.renderers.persistent.prototype.showPanel = function (panelId, enableAnimations) {

  var animationOut = null;
  var animationIn = null;

  var animationDuration = 0.2;

  if (enableAnimations && this.template.animations && this.template.animations.transition && this.template.animations.transition.effect) {
    animationOut = this.template.animations.transition.effect.animations[0];
    animationIn = this.template.animations.transition.effect.animations[1];

    if (this.template.animations.transition.duration) {
      animationDuration = this.template.animations.transition.duration;
    }

  }

  if (animationOut) {
    exitintel.util.runAnimation(this.innerCanvasElement, animationOut, animationDuration/2).then(function () {
      this.showPanelNext(panelId, animationIn, animationDuration/2);
    }.bind(this));
  } else {
    this.showPanelNext(panelId, animationIn, animationDuration);
  }

};

exitintel.renderers.persistent.prototype.showPanelNext = function (panelId, animation) {

  // Hide all panels
  this.persistentElement.find('.exitintel-panel').hide();

  // Hide elements from other panels (in case attached to outer container)
  this.persistentElement.find('[data-element-panel-id][data-element-panel-id!=' + panelId + ']').hide();

  // Animate the next step
  if (animation) {
    exitintel.util.runAnimation(this.innerCanvasElement, animation, 0.5);
  }

  // Show elements of this panel
  this.persistentElement.find('[data-element-panel-id=' + panelId + ']').show();

  // Show the one
  this.persistentElement.find('[data-panel-id=' + panelId + ']').show();

  // Set current panel
  this.currentPanel = panelId;

  // Set Z-Indexes
  if (this.template.panels[panelId].layers) {
    exitintel.renderers.setZIndexes(this.persistentElement, this.template.panels[panelId].layers['outer-below-inner']);

    this.innerCanvasElement.css({
      zIndex: this.template.panels[panelId].layers['outer-below-inner'].length + 1
    });

    exitintel.renderers.setZIndexes(this.innerCanvasElement, this.template.panels[panelId].layers.inner);
    exitintel.renderers.setZIndexes(this.persistentElement, this.template.panels[panelId].layers['outer-above-inner'], this.template.panels[panelId].layers['outer-below-inner'].length + 1);
  }

  // Run element animations
  exitintel.ad.runElementsAnimations(this.template, panelId);
};

exitintel.renderers.persistent.prototype.show = function () {

  // Show persistent
  this.wrapperElement.show();
  this.persistentElement.show();

  var animateAppearance = function () {
    exitintel.util.runAnimation(this.persistentElement, this.template.animations.appearence.effect, this.template.animations.appearence.duration || 0.2);
  }.bind(this);

  if (this.template.animations && this.template.animations.appearence && this.template.animations.appearence.effect) {
    if (typeof this.template.animations.animateOnFirstImpression === 'undefined' || this.template.animations.animateOnFirstImpression === true ){
      if (exitintel.visitor.hasSeenCampaign(this.campaignId) === false){
        // animate on first impression only
        animateAppearance();
      }
    } else {
      // animate on all impressions
      animateAppearance();
    }
  }

  // Show the first panel
  this.showPanel(0);

  // Register
  exitintel.ad.visibleAds.persistent = this;

  if (this.showCallbacks.length) {
    for (var i = 0; i < this.showCallbacks.length; i++) {
      this.showCallbacks[i].call();
    }
  }

  // Enable style
  exitintel.ad.enableCustomCSS(this.adId, this.template, this);
};

exitintel.renderers.persistent.prototype.hide = function () {

  if (this.template.animations && this.template.animations.closing && this.template.animations.closing.effect) {
    exitintel.util.runAnimation(this.persistentElement, this.template.animations.closing.effect, this.template.animations.closing.duration || 0.2).then(this.hideDone.bind(this));
  } else {
    this.hideDone();
  }
};

exitintel.renderers.persistent.prototype.hideDone = function () {

  this.wrapperElement.hide();
  this.persistentElement.hide();

  // Unregister
  exitintel.ad.visibleAds.persistent = null;

  // disable style
  exitintel.ad.disableCustomCSS(this.adId);
};


exitintel.renderers = exitintel.renderers || {};

exitintel.renderers.v3 = function (ad) {

  this.campaignId = ad.campaignId;
  this.adId = ad.id;
  this.version = 'v3';
  this.wrapperElement = $('<div></div>')
                    .addClass('exitintel-wrapper')
                    .css({'display': 'none'})
                    .attr('id', 'exitintel_wrapper_' + this.adId);

  this.currentPanel = null;

  this.showCallbacks = [];

  this.ad = ad;

  if (ad.selectedVersion.template.ad.displayMethod !== 'fixed') {
    var targetElement = $(ad.selectedVersion.template.ad.displayMethodQuerySelector);
    if (!targetElement) {
      return;
    }

    switch (ad.selectedVersion.template.ad.displayMethod) {

        case 'element-before':
          this.wrapperElement.insertBefore(targetElement);
          break;
        case 'element-inside-top':
          $(targetElement).prepend(this.wrapperElement);
          break;
        case 'element-inside-bottom':
          $(targetElement).append(this.wrapperElement);
          break;
        case 'element-after':
          this.wrapperElement.insertAfter(targetElement);
          break;
      }
  } else {
    $('body').append(this.wrapperElement);
  }


  var campaign = exitintel.campaign.available.find(function (c) {
    return c._id === ad.campaignId;
  });

  var renderedAd = {
    ad: ad.selectedVersion.template.ad,
    title: ad.title,
    campaignTitle: campaign && campaign.title ? campaign.title : '',
    legacyAdId: ad.id,
    campaignId: ad.campaignId,
    preloaded: false,
    visible: false,
    currentStep: 0,
    data: [],
    hide: this.hide.bind(this),
  };

  this.renderer = window.exitintel.rendererV3Bootstrap(renderedAd, this.wrapperElement[0]);
};


exitintel.renderers.v3.prototype.showPanel = function (panelId) {
  this.renderer.goToStep(panelId);
};

exitintel.renderers.v3.prototype.show = function (stepNumber) {
  this.wrapperElement.show();
  this.wrapperElement.addClass('exitintel-visible');
  this.renderer.show(stepNumber);

  exitintel.ad.visibleAds[this.ad.selectedVersion.template.type] = this;
};

exitintel.renderers.v3.prototype.hide = function () {

  this.wrapperElement.hide();
  this.wrapperElement.removeClass('exitintel-visible');
  this.renderer.hide();

  exitintel.ad.visibleAds[this.ad.selectedVersion.template.type] = null;

};

exitintel.renderers.v3.prototype.getAdData = function (field) {
  return this.renderer.getAdData(field);
};



/*global alert:false */

exitintel.renderers = exitintel.renderers || {};

exitintel.renderers.element = {
  label: function (element, ad) {
    var $el = $('<div></div>');

    $el.attr('data-exitintel-name', element.name);
    $el.attr('data-exitintel-label', element.label);

    $el.html(element.placeholder);

    var pointerEvents = 'auto';
    
    if (typeof element.clickThrough !== 'undefined'){
      pointerEvents = element.clickThrough ? 'none': 'auto';
    } 
    
    $el.css({
      'pointer-events': pointerEvents,
    });

    var customCSS = element.customCSS || '';
    exitintel.ad.registerCSS(customCSS, ad);

    return $el;
  },

  inputEmail: function (element, ad) {
    var $el = $('<input />');

    $el.attr('type', 'email');

    $el.attr('name', 'email');

    $el.attr('data-exitintel-name', element.name);
    $el.attr('data-exitintel-label', element.label);

    $el.attr('placeholder', element.placeholder);

    $el.css({
      'pointer-events': 'auto'
    });

    // Custom placeholders
    if (!exitintel.util.isPlaceholderSupported()) {
      exitintel.plugins.customPlaceholders($el);
    }

    var validators = [];

    // Email validator
    validators.push(function (val) {
      if (val === '') {
        return true; // Don't check empty strings
      }

      var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
      if (!re.test(val)) {
        alert('Your email address format is wrong.');
        return false;
      }

      return true;

    });

    // Required validator
    if (element.required) {

      $el.attr('required', 'required');

      validators.push(function (val) {
        if (val === '') {
          alert('Please fill in all the required fields.');
          return false;
        }

        return true;
      });
    }

    exitintel.util.jQuery.data($el[0], 'validators', validators);

    $el.on('keypress', function (e) {
      if (e.which == 13) {
        e.preventDefault();
      }
    });
    
    var selector = "input[data-exitintel-name="+element.name+"]";
    var placeholderCSS = exitintel.util.getPlaceholderCSS(selector, element.color);
    exitintel.ad.registerCSS(placeholderCSS, ad);
    
    var customCSS = element.customCSS || '';
    exitintel.ad.registerCSS(customCSS, ad);

    return $el;
  },

  inputGeneral: function (element, ad) {
    var $el = $('<input />');

    $el.attr('type', 'text');


    if (element.label.match(/input-/)) {
      $el.attr('name', element.label.replace(/input-/, ''));
    }

    $el.css({
      'pointer-events': 'auto'
    });

    $el.attr('data-exitintel-name', element.name);
    $el.attr('data-exitintel-label', element.label);

    $el.attr('placeholder', element.placeholder);
    // Custom placeholders
    if (!exitintel.util.isPlaceholderSupported()) {
      exitintel.plugins.customPlaceholders($el);
    }


    var validators = [];

    // Required validator
    if (element.required) {

      $el.attr('required', 'required');

      validators.push(function (val) {
        if (val === '') {
          alert('Please fill in all the required fields.');
          return false;
        }

        return true;
      });
    }

    exitintel.util.jQuery.data($el[0], 'validators', validators);

    $el.on('keypress', function (e) {
      if (e.which == 13) {
        e.preventDefault();
      }
    });
    
    var selector = "input[data-exitintel-name="+element.name+"]";
    var placeholderCSS = exitintel.util.getPlaceholderCSS(selector, element.color);
    exitintel.ad.registerCSS(placeholderCSS, ad);

    var customCSS = element.customCSS || '';
    exitintel.ad.registerCSS(customCSS, ad);

    return $el;
  },

  button: function (element, ad) {
    var $el = $('<button />');

    $el.html(element.placeholder);

    $el.attr('data-exitintel-name', element.name);
    $el.attr('data-exitintel-label', element.label);

    $el.css({
      'cursor': 'pointer',
      'pointer-events': 'auto'
    });

    exitintel.util.jQuery.data($el, 'adObject', ad);

    // add actions
    if (element.actions) {
      for (var i = 0; i < element.actions.length; i++) {
        exitintel.elementActions.install($el, element.actions[i]);
      }
    }

    var customCSS = element.customCSS || '';

    // subtypes
    if (element.subtype === 'close-button') {
      $el.addClass('exi_close_x_thin');

      var classes = [];

      classes.push('[data-exitintel-name='+ element.name + ']::before');
      classes.push('[data-exitintel-name='+ element.name + ']::after');

      customCSS += "\n\n" +
        classes.join(", \n") +
        " { " +
        " background-color: " + element.closeButton.color + "; \n" +
        " height: " + element.closeButton.thickness + (typeof element.closeButton.thickness === 'number' ? 'px' : '') + "; \n" +
        " border-radius: " + element.closeButton.radius + (typeof element.closeButton.radius === 'number' ? 'px' : '') + "; \n" +
        " top: " + ((parseInt(element.size.height, 10) - element.closeButton.thickness)/2) + 'px' +
        "}";
    }

    exitintel.ad.registerCSS(customCSS, ad);

    return $el;
  },

  countdown: function (el, ad) {
    var $el = $('<div></div>')
              .addClass('countdown');

    $el.attr('data-exitintel-name', el.name);
    $el.attr('data-exitintel-label', el.label);
    $el.css({
      'pointer-events': 'auto'
    });

    var countdownId = ad.campaignId + ':' + el.name;

    var c = new exitintel.plugins.countdown(countdownId, $el, el.countdown);

    ad.showCallbacks.push(c.start.bind(c));

    var customCSS = el.customCSS || '';
    exitintel.ad.registerCSS(customCSS, ad);

    return $el;

  }
};


exitintel.plugins = exitintel.plugins || {};

exitintel.plugins.countdown = function (id, $el, settings) {

    this.id = id;
    this.settings = settings;
    this.$el = $el;

    this.secondsOffset = 0;

    this.startedAt = null;

    if (typeof this.settings.timeTargetType == 'undefined' || this.settings.timeTargetType == 'relative') {
      var cookieCountdowns = exitintel.storage.getJSON('countdowns', {});

      if (cookieCountdowns && cookieCountdowns[this.id] ) {
        this.startedAt = cookieCountdowns[this.id].startedAt;
      }
    }

    if (settings.hours) {
      this.secondsOffset += parseInt(settings.hours, 10) * 3600;
    }

    if (settings.minutes) {
      this.secondsOffset += parseInt(settings.minutes, 10) * 60;
    }

    if (settings.seconds) {
      this.secondsOffset += parseInt(settings.seconds, 10);
    }

    if (settings.customizeCountdown) {
      var parts = [];

      if (this.settings.splitHoursDays && this.settings.showDays) {
        parts.push('days');
      }

      if (this.settings.showHours) {
        parts.push('hours');
      }

      if (this.settings.showMinutes) {
        parts.push('minutes');
      }

      if (this.settings.showSeconds) {
        parts.push('seconds');
      }
      var seperator = '<span data-ei-class="seperator">:</span>';
      var template = parts.map(function (t) { return '<span data-ei-class="' + t + '">00</span>'; }).join(seperator);

      this.$el.html(template);
    } else {
      // Default mode
      this.$el.html('' +
        '<span data-ei-class="hours">00</span>' +
        '<span data-ei-class="hm-seperator">:</span>' +
        '<span data-ei-class="minutes">00</span>' +
        '<span data-ei-class="ms-seperator">:</span>' +
        '<span data-ei-class="seconds">00</span>'
      );
    }
};

exitintel.plugins.countdown.prototype.start = function () {

  if (!this.startedAt) {

    if (this.settings.timeTargetType && this.settings.timeTargetType == 'absolute') {

      var virtualStart = new Date(this.settings.timeTarget).valueOf();

      virtualStart -= this.settings.hours*3600 *1000;
      virtualStart -= this.settings.minutes*60 *1000;
      virtualStart -= this.settings.seconds *1000;

      this.startedAt = Math.floor(virtualStart / 1000);

    } else {

      // Init cookie
      var now = Math.floor(Date.now() / 1000);

      var cookieCountdowns = exitintel.storage.getJSON('countdowns', {});

      var cookie = {
        startedAt: now
      };

      cookieCountdowns[this.id] = cookie;

      exitintel.storage.setJSON('countdowns', cookieCountdowns);

      this.startedAt = now;
    }

  }

  this.tick();
};



exitintel.plugins.countdown.prototype.tick = function () {

  var now = Math.floor(Date.now() / 1000);

  var targetTime = this.startedAt + this.secondsOffset;

  var timeLeft = targetTime - now;

  if (timeLeft <= 0) {
    // All done here
    this.setElement('days', 0);
    this.setElement('hours', 0);
    this.setElement('minutes', 0);
    this.setElement('seconds', 0);
    return;
  }

  var hours = Math.floor(timeLeft / 3600);
  var minutes = Math.floor(timeLeft % 3600 / 60);
  var seconds = timeLeft % 60;

  if (this.settings.splitHoursDays) {
    this.setElement('days', Math.floor(hours/24));
    this.setElement('hours', hours % 24);
  } else {
    this.showElement('hours', (hours !== 0));
    if (hours === 0){
      this.$el.find('[data-ei-class="hm-seperator"]').hide();
    } else{
      this.$el.find('[data-ei-class="hm-seperator"]').show();
    }
    this.setElement('hours', hours);
  }

  this.setElement('minutes', minutes);
  this.setElement('seconds', seconds);

  setTimeout(this.tick.bind(this), 1000);
};

exitintel.plugins.countdown.prototype.showElement = function(type, show){
  // hide segment if desired
  var segment = this.$el.find('[data-ei-class='+type+']');
  if (show) {
    segment.show();
  } else {
    segment.hide();
  }
};

exitintel.plugins.countdown.prototype.setElement = function (type, value) {

  var displayValue = value;
  if (displayValue < 10) {
    // Pad with zero
    displayValue = '0' + displayValue;
  }

  // update number
  this.$el.find('[data-ei-class="' + type + '"]').html(displayValue);

};


exitintel.plugins = exitintel.plugins || {};

exitintel.plugins.activityIndicator = {
  installed: false,

  overlayElement: null,
  indicatorElement: null,

  timeout: null,
  visibilityTimeout: null,

  install: function () {
    this.overlayElement = $('<div></div>')
          .addClass('exitintel-overlay')
          .attr('id', 'exitintel_activity_indicator_ovelay')
          .css({
            'position': 'fixed',
            'top': 0,
            'left': 0,
            'background': 'rgba(255, 255, 255, 0.6)',
            'width': '100%',
            'height': '100%',
            'z-index': '81000006',
            'display': 'none'
          });

    if (typeof exitintel.util.ieVersion() != 'undefined') {
      if (exitintel.util.ieVersion() < 9) {
        this.overlayElement.css('background', 'transparent');
      }
    }

    this.indicatorElement = $('<div></div>')
          .addClass('exitintel-activity-indicator')
          .attr('id', 'exitintel_activity_indicator')
          .css({
            'position':   'absolute',
            'width':      100,
            'height':     100,
            'left':       '50%',
            'margin-left': -50,
            'top':        '30%',
            'margin-top': -50
          });

    this.indicatorElement.html('<div id="exitintel-spinner"></div>');

    var styleBlock = document.createElement('style');
    styleBlock.setAttribute('id', 'ei-style-spinner');
    styleBlock.setAttribute('type', 'text/css');

    styleBlock.type = 'text/css';

    var styleText = '#exitintel-spinner:before,' +
      '#exitintel-spinner:after,' +
      '#exitintel-spinner {' +
      'border-radius: 50%;' +
      'width: 2.5em;' +
      'height: 2.5em;' +
      '-webkit-animation-fill-mode: both;' +
      'animation-fill-mode: both;' +
      '-webkit-animation: exitintel-activity-animation 1.8s infinite ease-in-out;' +
      'animation: exitintel-activity-animation 1.8s infinite ease-in-out;' +
      '}' +
      '#exitintel-spinner {' +
      'margin: 8em auto;' +
      'font-size: 10px;' +
      'position: relative;' +
      'text-indent: -9999em;' +
      '-webkit-animation-delay: 0.16s;' +
      'animation-delay: 0.16s;' +
      '}' +
      '#exitintel-spinner:before {' +
      'left: -3.5em;' +
      '}' +
      '#exitintel-spinner:after {' +
      'left: 3.5em;' +
      '-webkit-animation-delay: 0.32s;' +
      'animation-delay: 0.32s;' +
      '}' +
      '#exitintel-spinner:before,' +
      '#exitintel-spinner:after {' +
      'content: \'\';' +
      'position: absolute;' +
      'top: 0;' +
      '}' +
      '@-webkit-keyframes exitintel-activity-animation {' +
      '0%,' +
      '80%,' +
      '100% {' +
      'box-shadow: 0 2.5em 0 -1.3em ' + exitintel.config.primaryBrandColor + ';' +
      '}' +
      '40% {' +
      'box-shadow: 0 2.5em 0 0 ' + exitintel.config.primaryBrandColor + ';' +
      '}' +
      '}' +
      '@keyframes exitintel-activity-animation {' +
      '0%,' +
      '80%,' +
      '100% {' +
      'box-shadow: 0 2.5em 0 -1.3em ' + exitintel.config.primaryBrandColor + ';' +
      '}' +
      '40% {' +
      'box-shadow: 0 2.5em 0 0 ' + exitintel.config.primaryBrandColor + ';' +
      '}' +
      '}';

    if (styleBlock.styleSheet){
      styleBlock.styleSheet.cssText = styleText;
    } else {
      styleBlock.appendChild(document.createTextNode(styleText));
    }

    $('body').append(styleBlock);

    this.overlayElement.append(this.indicatorElement);
    $('body').append(this.overlayElement);
  },

  show: function () {
    if (!this.installed) {
      this.install();
    }

    this.installed = true;
    this.overlayElement.show();

    // Hide indicator for 300ms
    this.overlayElement.css('visibility', 'hidden');
    exitintel.plugins.activityIndicator.visibilityTimeout = setTimeout(function () {
      this.overlayElement.css('visibility', 'visible');
    }.bind(this), 300);

    clearTimeout(exitintel.plugins.activityIndicator.timeout);

    // Auto-hide after specified period
    exitintel.plugins.activityIndicator.timeout = setTimeout(function () {
      var visibleAd = exitintel.ad.visibleAds.popup ? exitintel.ad.visibleAds.popup : exitintel.ad.visibleAds.persistent;

      // If GDPR alert is visible, don't auto hide
      if (exitintel.util.jQuery('.exi_alert .exi_alert_container').length) {
        return;
      }

      exitintel.report.error('timeout', 'Element actions reached timeout', {}, {
        campaignId: visibleAd.campaignId,
        adId: visibleAd.adId
      });

      exitintel.plugins.activityIndicator.hide();
      exitintel.util.jQuery('.exi_alert').remove();

      if (typeof window._exiq === 'undefined') {
        window._exiq = [];
      }
      window._exiq.push(['disableCampaigns']);
    }, 30000);
  },

  hide: function () {
    this.overlayElement.hide();

    clearTimeout(exitintel.plugins.activityIndicator.timeout);

    // Clear visibility timeout
    clearTimeout(exitintel.plugins.activityIndicator.visibilityTimeout);
  }
};



exitintel.plugins = exitintel.plugins || {};

exitintel.plugins.customPlaceholders = function ($el) {
  function onFocus() {
    /*jshint validthis:true */

    if ($(this).val() == ($(this).attr('placeholder'))) {
      $(this).val('');
    }
  }

  function onBlur() {
    /*jshint validthis:true */

    if (!$(this).val()) {
      $(this).val($(this).attr('placeholder'));
    }
  }

  $el.val($el.attr('placeholder'));

  $el.on('focus', onFocus);
  $el.on('blur', onBlur);
};


/*jshint unused:false*/
exitintel.storage = {

  driver: 'cookie',

  init: function () {
    if (exitintel.config.storageEngine == 'localStorage') {
      this.driver = 'localStorage';
    }
  },

  set: function (name, value, days) {
    return exitintel[this.driver].set.apply(exitintel[this.driver], arguments);
  },

  get: function (name) {
    return exitintel[this.driver].get.apply(exitintel[this.driver], arguments);
  },

  unset: function (name) {
    return exitintel[this.driver].unset.apply(exitintel[this.driver], arguments);
  },

  nuke: function (name) {
    return exitintel[this.driver].nuke.apply(exitintel[this.driver], arguments);
  },

  getJSON: function (name, defaultValue) {
    return exitintel[this.driver].getJSON.apply(exitintel[this.driver], arguments);
  },

  setJSON: function (name, value, days) {
    return exitintel[this.driver].setJSON.apply(exitintel[this.driver], arguments);
  },

  resetAll: function () {
    return exitintel[this.driver].resetAll.apply(exitintel[this.driver], arguments);
  }
};
/*jshint unused:true*/
exitintel.storage.init();


exitintel.storage.migration = {

  ignore: ['vid', 'sid', 'ver'],

  init: function () {
    if (exitintel.config.storageEngine === 'localStorage' && exitintel.cookie.get('cfg')) {
      exitintel.util.warn('migrating cookiesToLocalStorage');
      exitintel.storage.migration.cookiesToLocalStorage();
    }

    if (exitintel.config.storageEngine !== 'localStorage' && exitintel.localStorage.get('cfg')) {
      exitintel.util.warn('migrating localStorageToCookies');
      exitintel.storage.migration.localStorageToCookies();
    }
  },

  cookiesToLocalStorage: function () {
    // get all cookies
    var cookies = document.cookie.split(';').map(function (c) {
      var parts = c.split('=');
      return {
        name: parts[0].trim(),
        value: parts[1]
      };
    });

    // filter exitintel_* cookies
    var exiCookies = cookies.filter(function (c) {
      if (c.name.match(/^exitintel_/)) {
        return true;
      }

      return false;
    });

    // Get the main domain name
    var domain = window.location.host;

    if (!window.location.host.match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)) { // ip address
      var domainParts = window.location.host.match(/([^.]+\.[^\.]+)$/);

      if (domainParts) {
        domain = '.' + domainParts[0];
      }
    }

    if (domain.match(/:[0-9]+$/)) {
      domain = domain.replace(/:[0-9]+$/, '');
    }

    for (var i in exiCookies) {

      var cookieName = exiCookies[i].name.replace(/^exitintel_/, '');
      var cookieVal = exitintel.cookie.get(cookieName);

      // Skip ignored cookies
      if (exitintel.storage.migration.ignore.indexOf(cookieName) !== -1) {
        continue;
      }

      // set expiration days
      var expire = ['ref', 'lp'].indexOf(cookieName) >= 0 ? null : exitintel.config.cookieExpirationDays;

      // Unset cookie
      exitintel.cookie.nuke(cookieName);

      // Remove from top level domain
      document.cookie = exitintel.cookie.prefix + cookieName + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=' + domain + ';path=/;';

      // Set storage
      exitintel.storage.set(cookieName, cookieVal, expire);
    }
  },

  localStorageToCookies: function () {
    for (var itemName in window.localStorage) {

      // Ingore non exitintel items
      if (!itemName.match(/^exitintel_/)) {
        continue;
      }

      var exiName = itemName.replace(/^exitintel_/, '');

      // Skip ignored cookies (probably redundant here)
      if (exitintel.storage.migration.ignore.indexOf(exiName) !== -1) {
        continue;
      }

      // set expiration days
      var expire = ['ref', 'lp'].indexOf(exiName) >= 0 ? null : exitintel.config.cookieExpirationDays;

      try {
        // Set cookie
        exitintel.cookie.set(exiName, JSON.parse(decodeURIComponent(window.localStorage[itemName])).value, expire);
      } catch (e) {

      }

      // Unset local storage
      exitintel.localStorage.unset(exiName);
    }
  }
};


exitintel.cookie = {

  prefix: 'exitintel_',

  set: function (name, value, days) {

    value = encodeURIComponent(value);

    var prefixedName = exitintel.cookie.prefix + name;

    var expires = '';
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        expires = '; expires='+date.toGMTString();
    }

    var domain = window.location.host;

    if (!window.location.host.match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)) { // ip address
      var domainParts = window.location.host.match(/([^.]+\.[^\.]+)$/);

      if (domainParts) {
        domain = '.' + domainParts[0];
      }
    }

    if (domain.match(/:[0-9]+$/)) {
      domain = domain.replace(/:[0-9]+$/, '');
    }

    if (exitintel.config.cookieStorageEngine == 'cookie-domain') {
      document.cookie = prefixedName+'='+value+expires+';domain=' + domain + ';path=/;';

      // Just in case there's a subdomain specific cookie left.
      if (exitintel.cookie.get(name) != value) {
        exitintel.cookie.nuke(name);
        document.cookie = prefixedName+'='+value+expires+';domain=' + domain + ';path=/;';
      }
    } else {
      document.cookie = prefixedName+'='+value+expires+';path=/;';
    }

  },

  get: function (name, getRaw) {
    if (typeof getRaw === "undefined"){
      getRaw = false;
    }
    name = exitintel.cookie.prefix + name;

    var nameEQ = name + "=";
    var ca = document.cookie.split(';');

    for(var i=0;i < ca.length;i++) {
        var c = ca[i];

        while (c.charAt(0)==' ') {
          c = c.substring(1,c.length);
        }

        if (c.indexOf(nameEQ) === 0) {
          if (getRaw){
            return (c.substring(nameEQ.length,c.length));
          }
          return decodeURIComponent(c.substring(nameEQ.length,c.length));

        }
    }
    return null;
  },

  getRaw: function (name) {
    var value = "; "+document.cookie;
    var parts = value.split("; "+name+"=");
    if (parts.length === 2) {
      return parts.pop().split(';').shift();
    }
  },

  unset: function (name) {

    exitintel.cookie.set(name, '', -10);
  },

  nuke: function (name) {

    name = exitintel.cookie.prefix + name;

    document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;';
  },

  getJSON: function (name, defaultValue) {

    var strValue = exitintel.cookie.get(name);

    var val;
    try {
      val = JSON.parse(strValue);
    } catch (e) {
      val = null;
    }

    if (!val && defaultValue) {
      return defaultValue;
    }

    return val;
  },

  setJSON: function (name, value, days) {
    var strValue = JSON.stringify(value);

    exitintel.cookie.set(name, strValue, days);
  },

  resetAll: function () {
    var cookies = document.cookie.split(';').map(function (c) {
      var parts = c.split('=');
      return {
        name: parts[0].trim(),
        value: parts[1]
      };
    });

    var exiCookies = cookies.filter(function (c) {
      if (c.name.match(/^exitintel_/)) {
        return true;
      }

      return false;
    });


    var domain = window.location.host;

    if (!window.location.host.match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)) { // ip address
      var domainParts = window.location.host.match(/([^.]+\.[^\.]+)$/);

      if (domainParts) {
        domain = '.' + domainParts[0];
      }

    }

    for (var i = 0; i < exiCookies.length; i++) {

      var cookieName = exiCookies[i].name.replace(/^exitintel_/, '');
      var cookieVal = exitintel.cookie.get(cookieName);

      if (cookieVal === null) {
        continue;
      }

      // Ignore "ver" in migration
      if (cookieName == 'ver') {
        continue;
      }

      // Expire cookie (without domain)
      document.cookie = exitintel.cookie.prefix + cookieName + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;';

      // Expire cookie (with domain)
      document.cookie = exitintel.cookie.prefix + cookieName + '=;domain=' + domain + ';expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;';

      var expire = ['ref', 'sid', 'lp'].indexOf(cookieName) >= 0 ? null : exitintel.config.cookieExpirationDays;

      // Reset cookie
      exitintel.cookie.set(cookieName, cookieVal, expire);
    }
  }
};


exitintel.localStorage = {

  prefix: 'exitintel_',

  set: function (name, value, days) {

    if (!days) {
      days = 1/24/2; // 30 minutes
    }

    var expires = null;
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        expires = date.getTime();
    }

    var val = {
      value: value,
      expires: expires
    };

    window.localStorage.setItem(exitintel.localStorage.prefix + name, encodeURIComponent(JSON.stringify(val)));
  },

  get: function (name) {
    var item = window.localStorage.getItem(exitintel.localStorage.prefix + name);
    if (!item) {
      return null;
    }

    try {
      var val = JSON.parse(decodeURIComponent(item));
      var now = new Date();

      // Check if it's expired
      if (val.expires && val.expires < now.getTime()) {
        return null;
      }

      return val.value;
    } catch (e) {
      return null;
    }
  },

  unset: function (name) {
    window.localStorage.removeItem(exitintel.localStorage.prefix + name);
  },

  nuke: function (name) {
    window.localStorage.removeItem(exitintel.localStorage.prefix + name);
  },

  getJSON: function (name, defaultValue) {

    var strValue = exitintel.localStorage.get(name);

    var val;
    try {
      val = JSON.parse(strValue);
    } catch (e) {
      val = null;
    }

    if (!val && defaultValue) {
      return defaultValue;
    }

    return val;
  },

  setJSON: function (name, value, days) {
    var strValue = JSON.stringify(value);

    exitintel.localStorage.set(name, strValue, days);
  },

  resetAll: function () {
    for (var name in window.localStorage) {
      if (name.match(/^exitintel_/)) {
        window.localStorage.removeItem(name);
      }
    }
  }
};


/*global eiSession */

exitintel.visitor = {
    identity: {
        _initialized: false,
        id: null,
        campaigns: {
            seen: [],
            converted: [],
            disabled: [],
            visited: []
        },
        profile: {
          gatheredData: {},
          achivedGoals: {}
        }
    },

    session: {
        id: null,
        originalReferrer: null,
        landingPage: null,
        isFirstVisit: false,
        pageviewCount: 0,
        visitCount: 0
    },

    init: function() {

        // bypass init if the eiSession is defined
        if (typeof eiSession !== 'undefined' && eiSession.hasOwnProperty('identity') && eiSession.hasOwnProperty('session')) {
            this.initWithSession();
            return;
        }

        //
        // Visitor id
        //

        // Try to get from cookie
        var visitorId = exitintel.cookie.get('vid');

        if (!visitorId) {
            // Create a new one
            visitorId = exitintel.util.getUniqueId();

            // Write back to cookie
            exitintel.cookie.set('vid', visitorId, exitintel.config.cookieExpirationDays);
        }

        this.identity.id = visitorId;

        //
        // Session id
        //

        this.session.id = exitintel.cookie.get('sid');

        // Get the visitor count
        this.session.visitCount = exitintel.storage.get('vc');

        if (!this.session.id) {
            // Generate unique session id
            this.session.id = exitintel.util.getUniqueId();

            // Set this as the first visit of the session
            this.session.isFirstVisit = true;

            // Write to cookie (session cookie)
            exitintel.cookie.set('sid', this.session.id);

            // Increase visit count 
            if (!this.session.visitCount) {
                this.session.visitCount = 1;
            } else {
                this.session.visitCount++;
            }
            exitintel.storage.set('vc', this.session.visitCount, exitintel.config.cookieExpirationDays);
        }
        //
        // Original referrer
        //

        this.session.originalReferrer = exitintel.storage.get('ref');

        if (!this.session.originalReferrer) {
            // Store original referrer
            this.session.originalReferrer = document.referrer;

            // Write back to cookie (session cookie)
            exitintel.storage.set('ref', this.session.originalReferrer);
        }

        //
        // Pageview count
        //
        this.session.pageviewCount = exitintel.storage.get('pvc');
        if (!this.session.pageviewCount) {
          this.session.pageviewCount = 1;
        } else {
          this.session.pageviewCount++;
        }
        exitintel.storage.set('pvc', this.session.pageviewCount);

        //
        // Landing page
        //

        this.session.landingPage = exitintel.storage.get('lp');

        if (!this.session.landingPage) {
            // Store current url as landing page
            this.session.landingPage = document.URL;

            // Write back to cookie (session cookie)
            exitintel.storage.set('lp', this.session.landingPage);
        }

        //
        // Visitor profile
        //

        var visitorProfile = exitintel.storage.getJSON('prf');

        if (visitorProfile === null) {
          exitintel.storage.setJSON('prf', this.identity.profile, exitintel.config.cookieExpirationDays);
        } else {
          exitintel.visitor.identity.profile = visitorProfile;
        }

        //
        // Campaign info
        //

        // Load campaign info from cookie
        this.loadCampaignInfo();

        // Filter expired campaign info
        this.filterExpiredCampaignInfo();

        // Write campaign info back to cookie
        this.saveCampaignInfo();

        // Initialized
        this.identity._initialized = true;
    },

    initWithSession: function() {
        this.identity = eiSession.identity;
        this.session = eiSession.session;

        this.saveCampaignInfo();
    },

  getAssignedConfiguration: function () {
    var configuration = exitintel.storage.get('cfid');

    if (configuration) {
      return configuration;
    }

    return null;
  },

  assignConfiguration: function (configuration) {
    exitintel.storage.set('cfid', configuration, exitintel.config.cookieExpirationDays);
  },

  chooseConfiguration: function (configurations) {
    var biases = configurations.map(function (c) {
      return parseInt(c.bias, 10);
    });

    var r = Math.round(Math.random()*100); // random 0 - 100

    var totalBias = 0;
    for (var i = 0; i < biases.length; i++) {
      totalBias = totalBias + biases[i];

      if (biases[i] === 0) {
        continue;
      }

      if (totalBias >= r) {
        var conf = configurations[i];
        exitintel.visitor.assignConfiguration(conf.id);
        return conf.id;
      }
    }

    // Something went wrong
    return 'default';
  },

    getIdentity: function() {
        if (!this.identity._initialized) {
            this.init();
        }

        return this.identity;
    },

    // Get the campaign info from cookie
    loadCampaignInfo: function() {

        // Map cookie names to campaign info collections
        var map = {
            seen: 'cs',
            converted: 'cc',
            disabled: 'cd',
            visited: 'cv'
        };

        for (var i in map) {

            // Prototype.js fix
            if (typeof map[i] == 'function') {
                continue;
            }

            var cookieValue = exitintel.storage.getJSON(map[i]);

            if (typeof cookieValue == 'string' && cookieValue.length > 1) {
                // corrupted. Reset
                cookieValue = null;
                exitintel.util.warn('Corrupted: ' + i);
            }

            if (!cookieValue) {
                cookieValue = [];
            }

            this.identity.campaigns[i] = cookieValue;
        }
    },

    // Save campaign info back too cookie
    saveCampaignInfo: function() {
        // Map cookie names to campaign info collections
        var map = {
            seen: 'cs',
            converted: 'cc',
            disabled: 'cd',
            visited: 'cv'
        };

        for (var i in map) {
            // Prototype.js fix
            if (typeof map[i] == 'function') {
                continue;
            }

            exitintel.storage.setJSON(map[i], this.identity.campaigns[i], exitintel.config.cookieExpirationDays);
        }
    },

    filterExpiredCampaignInfo: function() {

        for (var i in this.identity.campaigns) {

            if (typeof this.identity.campaigns[i] == 'function') {
                continue;
            }

            var collection = this.identity.campaigns[i];

            var filteredCollection = [];

            for (var j = 0; j < collection.length; j++) {
                var c = collection[j];

                // Add to filtered if it doesnt expire or the expiration date is in the future
                if (!c.expires || c.expires > (Math.floor((new Date()).getTime() / 1000))) {
                    filteredCollection.push(c);
                }
            }

            // Update original
            this.identity.campaigns[i] = filteredCollection;
        }
    },

    getViewportSize: function() {

        var width = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);

        var viewportClass = 'xs';
        if (width >= 768 && width < 992) {
            viewportClass = 'sm';
        } else if (width >= 992 && width < 1200) {
            viewportClass = 'md';
        } else if (width >= 1200) {
            viewportClass = 'lg';
        }

        var result = {
            width: width,
            height: Math.max(document.documentElement.clientHeight, window.innerHeight || 0)
        };

        result['class'] = viewportClass;

        return result;
    },

    _setCampaignStatus: function (collection, campaignId, expires, params) {
        if (!expires) {
            expires = null;
        }

        if (!params) {
            params = {};
        }


        // Check if campaign already exists in registry
        var campaignUpdated = false;

        if (!this.identity.campaigns[collection]) {
            this.identity.campaigns[collection] = [];
        }

        for (var i = 0; i < this.identity.campaigns[collection].length; i++) {
            var c = this.identity.campaigns[collection][i];

            if (c.id == campaignId) {
                c.expires = expires;
                c.timestamp = Math.floor((new Date()).getTime() / 1000);
                c.params = params;
                c.count++;

                campaignUpdated = true;
            }
        }

        // Wasn't found. Create it:
        if (!campaignUpdated) {
            var newCampaign = {
                id: campaignId,
                expires: expires,
                timestamp: Math.floor((new Date()).getTime() / 1000),
                params: params,
                count: 1
            };

            this.identity.campaigns[collection].push(newCampaign);
        }

        // Save to cookie
        this.saveCampaignInfo();
    },

    _unsetCampaignStatus: function (collectionId, campaignId) {
        var collection = this.identity.campaigns[collectionId];

        var filtered = [];

        for (var i = 0; i < collection.length; i++) {
            if (collection[i].id == campaignId) {
                continue;
            }

            filtered.push(collection[i]);
        }

        this.identity.campaigns[collection] = filtered;

        // Save to cookie
        this.saveCampaignInfo();
    },

    setSeenCampaign: function (campaignId, params) {
        var c = exitintel.campaign.get(campaignId);

        var expires = null;
        if (c && c.seenExpiration) {
            expires = exitintel.util.getDayOffset(c.seenExpiration);
        }

        this._setCampaignStatus('seen', campaignId, expires, params);
    },

    setConvertedCampaign: function (campaignId, params) {
        var c = exitintel.campaign.get(campaignId);

        var expires = null;
        if (c && c.convertedExpiration) {
            expires = exitintel.util.getDayOffset(c.convertedExpiration);
        }

        this._setCampaignStatus('converted', campaignId, expires, params);
    },

    setDisabledCampaign: function (campaignId, params, forever) {
        var c = exitintel.campaign.get(campaignId);

        var expires = null;
        if (c && c.disabledExpiration) {
            expires = exitintel.util.getDayOffset(c.disabledExpiration);
        }
        if (c && forever) {
            expires = exitintel.util.getDayOffset(15 * 365); // 15 years
        }

        this._setCampaignStatus('disabled', campaignId, expires, params);
    },

    unsetSeenCampaign: function (campaignId) {
        this._unsetCampaignStatus('seen', campaignId);
    },

    unsetConvertedCampaign: function (campaignId) {
        this._unsetCampaignStatus('converted', campaignId);
    },

    unsetDisabledCampaign: function (campaignId) {
        this._unsetCampaignStatus('disabled', campaignId);
    },

    hasSeenCampaign: function (campaignId) {
        var seenCampaigns = exitintel.visitor.identity.campaigns.seen;

        for (var i = 0; i < seenCampaigns.length; i++) {
            if (seenCampaigns[i].id == campaignId) {
                return true;
            }
        }

        return false;
    },

    hasSeenCampaigns: function (campaigns) {
        for (var i = 0; i < campaigns.length; i++) {
            var c = campaigns[i];
            var seenCampaign = exitintel.visitor.getSeenCampaign(c.campaignId);
    
            if (!seenCampaign) {
                return false;
            }

            if (typeof c.adId !== 'undefined' && c.adId !== null){
                if (typeof seenCampaign.params !== 'undefined' && c.adId !== seenCampaign.params.adId){
                    return false;
                }
            }

            if (!exitintel.util.campaignCookieWithinTimeOffset(seenCampaign, c.offsetFrom, c.offsetTo)) {
                return false;
            }

        }

        return true;
    },

    getSeenCampaign: function (campaignId) {
        var seenCampaigns = exitintel.visitor.identity.campaigns.seen;

        if (!seenCampaigns) {
            return false;
        }

        for (var i = 0; i < seenCampaigns.length; i++) {
            if (seenCampaigns[i].id == campaignId) {
                return seenCampaigns[i];
            }
        }

        return false;
    },

    hasConvertedCampaign: function (campaignId) {
        var convertedCampaigns = exitintel.visitor.identity.campaigns.converted;

        if (!convertedCampaigns) {
            return false;
        }


        for (var i = 0; i < convertedCampaigns.length; i++) {
            if (convertedCampaigns[i].id == campaignId) {
                return true;
            }
        }

        return false;
    },

    hasConvertedCampaigns: function (campaigns) {
        for (var i = 0; i < campaigns.length; i++) {
            var c = campaigns[i];

            var convertedCampaign = exitintel.visitor.getConvertedCampaign(c.campaignId);

            if (!convertedCampaign) {
                return false;
            }

            if (!exitintel.util.campaignCookieWithinTimeOffset(convertedCampaign, c.offsetFrom, c.offsetTo)) {
                return false;
            }

        }

        return true;
    },

    getConvertedCampaign: function (campaignId) {
        var convertedCampaigns = exitintel.visitor.identity.campaigns.converted;

        if (!convertedCampaigns) {
            return false;
        }

        for (var i = 0; i < convertedCampaigns.length; i++) {
            if (convertedCampaigns[i].id == campaignId) {
                return convertedCampaigns[i];
            }
        }

        return false;
    },

    getDisabledCampaign: function (campaignId) {
        var disabledCampaigns = exitintel.visitor.identity.campaigns.disabled;

        if (!disabledCampaigns) {
            return false;
        }

        for (var i = 0; i < disabledCampaigns.length; i++) {
            if (disabledCampaigns[i].id == campaignId) {
                return disabledCampaigns[i];
            }
        }

        return false;
    },

    hasVisitedCampaign: function (campaignId) {
        if (exitintel.visitor.identity.campaigns.visited.indexOf(campaignId) > -1) {
            return true;
        }

        return false;
    },

    setVisitedCampaign: function (campaignId) {
        if (exitintel.visitor.identity.campaigns.visited.indexOf(campaignId) == -1) {
            exitintel.visitor.identity.campaigns.visited.push(campaignId);
        }

        this.saveCampaignInfo();
    },

    setGatheredData: function (name) {
      exitintel.visitor.identity.profile.gatheredData[name] = {
        timestamp: Math.floor((new Date()).getTime() / 1000)
      };

      exitintel.visitor.saveProfileData();
    },

    setAchivedGoal: function (name) {
      exitintel.visitor.identity.profile.achivedGoals[name] = {
        timestamp: Math.floor((new Date()).getTime() / 1000)
      };

      exitintel.visitor.saveProfileData();
    },

    hasGatheredData: function (name) {
      var data = null;
      try {
        data = exitintel.visitor.identity.profile.gatheredData[name];
      } catch (e) {
        return false;
      }

      // Data exists?
      if (!data) {
        return false;
      }

      return true;
    },

    klaviyoHasGatheredEmail: function () {
        return exitintel.integrations.klaviyo.isKnownVisitor();
    },

    hasAchivedGoal: function (name) {
      var data = null;
      try {
        data = exitintel.visitor.identity.profile.achivedGoals[name];
      } catch (e) {
        return false;
      }

      // Data exists?
      if (!data) {
        return false;
      }

      return true;
    },

    saveProfileData: function () {
      exitintel.storage.setJSON('prf', exitintel.visitor.identity.profile, exitintel.config.cookieExpirationDays);
    }
};


exitintel.visitorHistory = {
    /**
     * CONSTANT for the number of pageviews to keep
     */
    HISTORY_KEEP_LAST_N_PAGEVIEWS: exitintel.config.historyKeepLastNPageviews,

    /**
     * Tracks pageview and writes to history (localstorage), calls gc().
     */
    trackPageview: function () {
        // Get the session id.
        var sessionId = exitintel.cookie.get('sid');

        // Get the current page URL.
        var curentPageURL = window.location.href;

        // Read from localstorage.
        var visitorHistoryArray = this._getFromLocalStorage();

        if (!visitorHistoryArray) { // if doesn't exist then insert the sessionId along with the pageView in the localstorage (first time).
            this._insert([], sessionId, curentPageURL);
        } else { // else,

            // search the array for the sessionId.
            var foundSessionItem = visitorHistoryArray.find(function (item) {
                return item.sessionId === sessionId;
            });


            if(!foundSessionItem) { // If doesn't exist then insert the sessionId along with the pageView in the localstorage.
                this._insert(visitorHistoryArray, sessionId, curentPageURL);
            } else { // else update the pageView array for the corresponding session id.
                this._update(visitorHistoryArray, sessionId, curentPageURL);
            }

        }

        // call garbage collector in order to keep only the last N pageviews.
        this.gc();

    },

    /**
     * Checks if the visitor has seen a Page URL that matches exactly with the provided 'url'.
     *
     * @param {string} url
     * @returns true or false
     */
    hasBeenToUrlThatIs: function(url) {
        // Read from localstorage.
        var visitorHistory = this._getFromLocalStorage();

        if(!visitorHistory) {
            return false;
        }

        // Search for each session id, if the pageViews array contains the provided 'url'.
        // In other words, check if the visitor has been to the provided 'url'.
        var urlFound = false;
        for (var i = 0; i < visitorHistory.length; i++) {
            var item = visitorHistory[i];

            var foundItem = this._findURLThatIs(item.pageViews, url);

            if (foundItem) {
                urlFound = true;
                break;
            }
        }
        return urlFound;
    },

    /**
     * Checks if the visitor has seen a Page URL that does not match exactly the provided 'url'.
     *
     * @param {string} url
     * @returns true or false
     */
    hasBeenToUrlThatIsNot: function(url) {
        // Read from localstorage.
        var visitorHistory = this._getFromLocalStorage();

        if(!visitorHistory) {
            return false;
        }

        // In other words, check if the visitor has NOT been to the provided 'url'.
        var urlFound = false;
        for (var i = 0; i < visitorHistory.length; i++) {
            var item = visitorHistory[i];

            var foundItem = this._findURLThatIsNot(item.pageViews, url);

            if (foundItem) {
                urlFound = true;
                break;
            }
        }
        return urlFound;
    },

    /**
     * Checks if the visitor has been to a Page URL that contains the provided 'urlPart'.
     *
     * @param {string} urlPart
     * @returns true or false
     */
    hasBeenToUrlThatContains: function(urlPart) {
        // Read from localstorage.
        var visitorHistory = this._getFromLocalStorage();

        if(!visitorHistory) {
            return false;
        }

        // Search for each session id, if the pageViews array contains the 'urlPart'.
        var urlPartFound = false;
        for (var i = 0; i < visitorHistory.length; i++) {
            var item = visitorHistory[i];

            var foundItem = this._findURLThatContains(item.pageViews, urlPart);

            if (foundItem) {
                urlPartFound = true;
                break;
            }
        }
        return urlPartFound;
    },

     /**
     * Checks if the visitor has been to a Page URL that NOT contains the provided 'urlPart'.
     *
     * @param {string} urlPart
     * @returns true or false
     */
    hasBeenToUrlThatNotContains: function(urlPart) {
        // Read from localstorage.
        var visitorHistory = this._getFromLocalStorage();

        if(!visitorHistory) {
            return false;
        }

        // Search for each session id, if the pageViews array NOT contains the 'urlPart'.
        var urlPartFound = false;
        for (var i = 0; i < visitorHistory.length; i++) {
            var item = visitorHistory[i];

            var foundItem = this._findURLThatNotContains(item.pageViews, urlPart); // true

            if (foundItem) {
                urlPartFound = true;
                break;
            }
        }
        return urlPartFound;
    },

    /**
     * Prunes history to last N pageview entries/
     */
    gc: function(){
          // Read from localstorage.
        var visitorHistory = this._getFromLocalStorage();

        if(!visitorHistory) {
            return;
        }

        // Count the total number of pageViews.
        var totalPageViews = 0;
        for (var i = 0; i < visitorHistory.length; i++) {
            totalPageViews += visitorHistory[i].pageViews.length;
        }

        // If the total number of pageViews is less than 100 then keep them all.
        if(totalPageViews < this.HISTORY_KEEP_LAST_N_PAGEVIEWS) {
            return;
        }

        // Sort the visitor history by date in descending order, so as to remove the oldest records.
        this._sortByDate(visitorHistory, 'sessionStartTS', 'desc');

        var remainingN = totalPageViews - this.HISTORY_KEEP_LAST_N_PAGEVIEWS;

        // To loop through an array and remove items inside the loop,
        // you should iterate in reverse so as not to break the loop.
        // More info: https://stackoverflow.com/questions/9882284/looping-through-array-and-removing-items-without-breaking-for-loop
        for(var j = visitorHistory.length - 1; j >= 0; j--) {

            var item = visitorHistory[j];

            this._sortByDate(item.pageViews, 'ts');

            if (item.pageViews.length <= remainingN) {
                remainingN -= item.pageViews.length;
                visitorHistory.splice(j, 1);
            } else {
                item.pageViews.splice(0, remainingN);
                remainingN = 0;
                break;
            }

        }

        this._setToLocalStorage(visitorHistory);
    },

    _insert: function(array, sessionId, curentPageURL) {
        if (!array) {
            return;
        }

        array.push({
            sessionId: sessionId,
            sessionStartTS: new Date().getTime(),
            pageViews: [
                {
                    url: curentPageURL,
                    ts: new Date().getTime()
                }
            ]
        });
        this._setToLocalStorage(array);

    },
    _update: function(array, sessionId, curentPageURL) {
        if(!array) {
            return;
        }

        var foundItem = array.find(function (item) {
            return item.sessionId === sessionId;
        });

        foundItem.pageViews.push({
            url: curentPageURL,
            ts: new Date().getTime()
        });

        this._setToLocalStorage(array);
    },
    _findURLThatIs: function (array, url) {
        return array.find(function (pv) {
            return pv.url.toLowerCase() === url.toLowerCase();
        });
    },
    _findURLThatIsNot: function (array, url) {
        return array.find(function (pv) {
            return pv.url.toLowerCase() !== url.toLowerCase();
        });
    },
    _findURLThatContains: function (array, urlPart) {
        return array.find(function (pv) {
            return pv.url.toLowerCase().indexOf(urlPart.toLowerCase()) > -1;
        });
    },
    _findURLThatNotContains: function (array, urlPart) {
        return array.find(function (pv) {
            return pv.url.toLowerCase().indexOf(urlPart.toLowerCase()) === -1;
        });
    },
    _sortByDate: function (array, field, order) {
        // if(!array || !field) {
        //     return;
        // }

        if (order === 'desc') {
            array.sort(function (a, b) {
                return b[field] - a[field];
            });
        } else {
            array.sort(function (a, b) {
                return a[field] - b[field];
            });
        }
    },
    _setToLocalStorage: function(value) {
        exitintel.localStorage.setJSON('vh', value, exitintel.config.cookieExpirationDays);
    },
    _getFromLocalStorage: function() {
        return exitintel.localStorage.getJSON('vh');
    }
};


exitintel.campaign = {
  available: [],
  active: [],

  dependencies: [],

  init: function () {
    this.loadFromUrl();
  },

  campaignsLoaded: function () {

    if (exitintel.config.disabled) {
      exitintel.event.log('pageview');
      return;
    }

    // Select the active ads for each campaign
    exitintel.campaign.chooseAds();

    // Select campaigns that are eligible for installing triggers
    exitintel.campaign.chooseActive();

    var onLoadAdInstalled = false;

    // Install ads for active campaigns
    for (var i = 0; i < exitintel.campaign.active.length; i++) {
      var c = exitintel.campaign.active[i];

      if (c.selectedAd) {

        var options = {};
        if (c.displayLimitPerPage) {
          options.displayLimitPerPage = c.displayLimitPerPage;
        }

        // Check if on-load ad is already installed
        var deviceDetect = exitintel.util.detectDevice.isMobile;

        var deviceType = 'desktop';
        if (deviceDetect.phone) {
          deviceType = 'phone';
        } else if (deviceDetect.tablet) {
          deviceType = 'tablet';
        }
        if (
          c.selectedAd.selectedVersion &&
          c.selectedAd.selectedVersion.trigger &&
          c.selectedAd.selectedVersion.trigger[deviceType] &&
          c.selectedAd.selectedVersion.trigger[deviceType].type == 'on-load') {

          if (onLoadAdInstalled) {
            // Dont install this ad
            continue;
          }

          onLoadAdInstalled = true;
        }

        options.priority = c.priority;

        exitintel.ad.install(c.selectedAd, options);
      }

      exitintel.event.log('pageview', {
        campaignId: c.id,
        adId: (c.selectedAd ? c.selectedAd.id : null)
      });
    }

    // Track pageview
    var trackedCampaign = null;
    var trackedAd = null;

    if (exitintel.campaign.active.length) {
      trackedCampaign = exitintel.campaign.active[0];

      if (exitintel.campaign.active[0].selectedAd) {
        trackedAd = exitintel.campaign.active[0].selectedAd;
      }
    }

    // log a generic pageview
    exitintel.event.log('pageview');
  },

  loadFromUrl: function () {
    exitintel.visitor.getIdentity();

    // check for prefetched configuration
    if (exitintel.config.prefetchedConfiguration) {

      setTimeout(function () {
        exitintel.campaign.campaignsFileLoaded(exitintel.config.prefetchedConfiguration);
      });
    } else {

      // get publication
      var publicationId = exitintel.util.getPublicationId();

      exitintel.api.getCampaigns(exitintel.config.clientId, publicationId);
    }
  },

  applyConfiguration: function (configuration) {
    switch (configuration) {
      case 'control':
        // Disable all campaigns
        exitintel.campaign.available = [];
      break;
      case 'default':
        // do nothing. All campaigns are on
      break;
      default:
        // Find configuration
        var c = exitintel.config.configurations.filter(function (conf) {
          if (conf.id == configuration) {
            return true;
          }
          return false;
        });

        if (c && c.length == 1) {
          var whitelistedCampaigns = c[0].campaigns;
          // filter allowed campaigns
          exitintel.campaign.available = exitintel.campaign.available.filter(function (c) {
            if (whitelistedCampaigns.indexOf(c._id) > -1) {
              return true;
            }

            return false;
          });
        }

      break;
    }
  },

  campaignsFileLoaded: function (response) {

      exitintel.campaign.available = response.campaigns;
      exitintel.config.whitelabel = response.whitelabel;
      exitintel.config.brandingType = response.brandingType || 'standard';
      exitintel.config.primaryBrandColor = response.primaryBrandColor;
      exitintel.config.configurations = response.configurations || [];
      exitintel.config.audiences = response.audiences || [];


      var configuration = 'default';
      if (exitintel.config.configurations.length) {
        configuration = exitintel.visitor.getAssignedConfiguration();

        var availableCofigurations = exitintel.config.configurations.filter(function (c) {
          if (parseInt(c.bias, 10) !== 0) {
            return true;
          }
          return false;
        });

        var availableConfigurationIds = availableCofigurations.map(function (c) { return (c.id); });

        if (!configuration || availableConfigurationIds.indexOf(configuration) == -1) {
          configuration = exitintel.visitor.chooseConfiguration(exitintel.config.configurations);
        }
      } else {
        // no configurations defined for account
        exitintel.visitor.assignConfiguration('default');
      }

      exitintel.campaign.applyConfiguration(configuration);

      var onloadJSDeferred = new exitintel.util.jQuery.Deferred();
      var moduleLoadDeferred = new exitintel.util.jQuery.Deferred();

      exitintel.campaign.loadModuleDependancies(moduleLoadDeferred);

      moduleLoadDeferred.then(function () {

        // handle on load JS
        if (response.onloadJS) {

          // Check if deffered in place or append
          if (response.onloadJS.indexOf('deferred.resolve()') == -1) {
            response.onloadJS += ';\ndeferred.resolve();';
          }
          if (response.onloadJS.indexOf('return deferred.promise();') == -1) {
            response.onloadJS += ';\nreturn deferred.promise();';
          }

          /*jshint -W054 */
          var fn = new Function('deferred', response.onloadJS);
          /*jshint +W054 */

          // Call
          fn(onloadJSDeferred);

        } else {
          onloadJSDeferred.resolve();
        }

        onloadJSDeferred.then(function () {
          exitintel.campaign.campaignsLoaded();
        });
      });
  },

  loadModuleDependancies: function (deferred) {
    var requiredModules = {
      geolocation: false
    };

    for (var i = 0; i < exitintel.campaign.available.length; i++) {
      var c = exitintel.campaign.available[i];

      // If the campaign has a geo-location appearence restriction
      if (c.rules.filter(function (r) { return r.filter == 'geo-location'; }).length) {
        requiredModules.geolocation = true;
      }
    }

    if (requiredModules.geolocation) {
      if (sessionStorage.getItem('exitintel_geo')) {
        deferred.resolve();
      } else {
        // Geolocate
        exitintel.util.jQuery.getJSON('https://j576j5dsib.execute-api.us-east-1.amazonaws.com/prod/custom/common/geolocate?callback=?', function (resp) {
          sessionStorage.setItem('exitintel_geo', JSON.stringify(resp));
          deferred.resolve();
        });
      }
    } else {
      deferred.resolve();
    }

    return deferred.promise();
  },

  chooseActive: function () {
    for (var i = 0; i < exitintel.campaign.available.length; i++) {
      if (this.isEligible(exitintel.campaign.available[i])) {
        exitintel.util.log('Active campaign: ' + exitintel.campaign.available[i].id);
        this.active.push(exitintel.campaign.available[i]);
      } else {
        exitintel.util.log('Not active campaign: ' + exitintel.campaign.available[i].title);
      }
    }

    if (!this.active.length) {
      exitintel.util.log('No active campaigns.');
    }
  },

  chooseAds: function () {
    exitintel.campaign.chooseAdsFromSeen();

    exitintel.campaign.forceDepenancies();

    exitintel.campaign.chooseAdsAtRandom();

    exitintel.campaign.forceDepenancies();
  },

  chooseAdsFromSeen: function () {
    // Process seen campaigns
    for (var i = 0; i < this.available.length; i++) {
      var c = this.available[i];

      // Ad already selected?
      if (c.selectedAd) {
        continue;
      }

      // jshint -W106
      // Any ads in this campaing?
      if (!c.enabled_ads.length) {
        continue;
      }

      var seenCampaign = exitintel.visitor.getSeenCampaign(c.id);
      if (seenCampaign.params && seenCampaign.params.adId) {
        for (var j = 0; j < c.enabled_ads.length; j++) {
          if (c.enabled_ads[j]._id == seenCampaign.params.adId) {

            var selectedAd = c.enabled_ads[j];
            selectedAd.number = j;

            this.chooseVersion(selectedAd);

            if (selectedAd.selectedVersion) {
              this.available[i].selectedAd = selectedAd;

              exitintel.util.log('Forcing ad from seen campaign ' + c.id + ' to ' + selectedAd.title);
            }
          }
        }
      }
      // jshint -W106
    }
  },

  chooseAdsAtRandom: function () {
    // Go through the campaigns again and assign a random ad if not previously assigned
    for (var i = 0; i < this.available.length; i++) {
      var c = this.available[i];

      // Ad already selected?
      if (c.selectedAd) {
        continue;
      }

      // jshint -W106

      exitintel.util.log(c.id + ' has ' + c.enabled_ads.length + ' enabled ads.');

      // Any ads in this campaing?
      if (!c.enabled_ads.length) {
        continue;
      }

      // Select a random ad
      var rand = Math.floor(Math.random()*(c.enabled_ads.length));

      var selectedAd = c.enabled_ads[rand];
      selectedAd.number = rand;

      exitintel.util.log(c.id + ': choosing ad randomly ' + selectedAd.title);

      this.chooseVersion(selectedAd);

      if (selectedAd.selectedVersion || (selectedAd.schemaVersion && selectedAd.schemaVersion === 3)) {
        this.available[i].selectedAd = selectedAd;
      }
    }
  },

  forceDepenancies: function () {
    // Force dependencies
    for (var ii = 0; ii < this.available.length; ii++) {
      var sa = this.available[ii].selectedAd;

      if (!sa) {
        continue;
      }

      if (typeof sa.dependencies == 'object' && sa.dependencies.length) {
        for (var jj = 0; jj < sa.dependencies.length; jj++) {
          var d = sa.dependencies[jj];
          exitintel.campaign.selectAd(d.campaignId, d.adId);
        }
      }
    }
  },

  chooseVersion: function (selectedAd) {


    // Already chosen?
    if (selectedAd.selectedVersion) {

      // Check dependencies
        var dependenciesNew = exitintel.ad.getVersionDependencies(selectedAd.selectedVersion, selectedAd);

        if (dependenciesNew.length) {
          selectedAd.dependencies = dependenciesNew;
        }

      return;
    }

    var viewport = exitintel.visitor.getViewportSize();

    // Select the ad version that fits and maximizes coverage
    var maxAdCoverage = 0;


    for (var k = 0; k < selectedAd.versions.length; k++) {
      var v = selectedAd.versions[k];

      if (!v.template) {
        continue;
      }

      if (v.ready != 'true') {
        continue;
      }

      // Defaults for popup
      var adWidth = parseInt(v.template.width, 10);
      var adHeight = parseInt(v.template.height, 10);

      if (v.template.type == 'Persistent') {
        adWidth = parseInt(v.template.persistentInnerCanvasPosition.width, 10);
        adHeight = parseInt(v.template.persistentInnerCanvasPosition.height, 10);
      }

      // Does it fit?
      // Manual mode
      if (v.mediaTargetMode == 'manual') {
        if (v.mediaTargets.indexOf(viewport['class']) == -1) {
          continue;
        }
      }
      // Automatic mode
      else if (adWidth > viewport.width + 20) {
        continue;
      }

      // Is it the largest that can fit?
      var coverage = adWidth * adHeight;

      if (coverage < maxAdCoverage) {
        continue;
      }

      maxAdCoverage = coverage;
      selectedAd.selectedVersion = v;

      // Check dependencies
      var dependencies = exitintel.ad.getVersionDependencies(v, selectedAd);

      if (dependencies.length) {
        selectedAd.dependencies = dependencies;
      }
    }
    // jshint +W106
  },

  selectAd: function (campaignId, adId) {
    for (var i = 0; i < this.available.length; i++) {
      var c = this.available[i];

      if (c.id != campaignId) {
        continue;
      }

      // jshint -W106
      for (var j = 0; j < c.enabled_ads.length; j++) {
        var ad = c.enabled_ads[j];

        if (ad.id != adId) {
          continue;
        }

        // This is the ad
        exitintel.util.log('force selecting (dependency): ' +  ad.title);
        this.chooseVersion(ad);

        if (ad.selectedVersion) {
          this.available[i].selectedAd = ad;
        }

      }
      // jshint +W106
    }


  },

  // Test if campaign is eligible
  isEligible: function (campaign) {

    try {
      if (exitintel.debug.preview.isPreviewSession) {
        return true;
      }
    } catch (e) {

    }

    // Display limit
    if (campaign.displayLimit) {
      var seenCampaign = exitintel.visitor.getSeenCampaign(campaign.id);

      if (seenCampaign && seenCampaign.count >= campaign.displayLimit) {
        return false;
      }
    }

    // Conversion limit
    if (campaign.maximumConversions) {
      var convertedCampaign = exitintel.visitor.getConvertedCampaign(campaign.id);

      if (convertedCampaign && convertedCampaign.count >= campaign.maximumConversions) {
        return false;
      }
    }

    // Is it disabled?
    var disabledCampaign = exitintel.visitor.getDisabledCampaign(campaign.id);
    if (disabledCampaign) {
      return false;
    }

    // Check rules for disabling
    for (var i = 0; i < campaign.rules.length; i++) {

      var rule = campaign.rules[i];

      if ((rule.mode == 'disable' || rule.mode === 'disable-forever') && this.testRule(rule, campaign)) {
        // disable campaign
        exitintel.visitor.setDisabledCampaign(campaign.id, null, rule.mode === 'disable-forever');
        return false;
      }
    }

    // Check show/hide rules
    for (var j = 0; j < campaign.rules.length; j++) {

      var rule2 = campaign.rules[j];

      if (rule2.mode == 'show' && !this.testRule(rule2, campaign)) {
        return false;
      }

      if (rule2.mode == 'hide' && this.testRule(rule2, campaign)) {

        return false;
      }
    }

    return true;
  },

  // Test a campaign rule
  testRule: function (rule, campaign) {

    switch (rule.filter) {
      // URL
      case 'url':
        return this.testURLRule('pageURL', rule);

      // Referrer URL
      case 'referer-url':
        return this.testURLRule('referrerURL', rule);

      // Landing page URL
      case 'landing-page-url':
        return this.testURLRule('landingPageURL', rule);

      // Path
      case 'path':
        return this.testURLRule('pagePath', rule);

      // Visited URL
      case 'has-visited-url':
        return this.testVisitedURLRule(rule);

      // Prerequisite campaign
      case 'prerequisite-campaign':
        return exitintel.visitor.hasSeenCampaigns(rule.prerequisiteCampaign);

      // Not prerequisite campaign
      case 'prerequisite-negative-campaign':
        return !(exitintel.visitor.hasSeenCampaigns(rule.prerequisiteCampaign));

      // Prerequisite conversion
      case 'prerequisite-converted-campaign':
        return exitintel.visitor.hasConvertedCampaigns(rule.prerequisiteCampaign);

      // Prerequisite conversion
      case 'prerequisite-negative-converted-campaign':
        return !(exitintel.visitor.hasConvertedCampaigns(rule.prerequisiteCampaign));

      case 'pageview-count-more-than':
        return exitintel.visitor.session.pageviewCount > parseInt(rule.value, 10);

      case 'visit-count-more-than':
        return exitintel.visitor.session.visitCount > parseInt(rule.value, 10);

      case 'gathered-email':
        return exitintel.visitor.hasGatheredData('email');
        
      case 'known-klaviyo-visitor':
        return exitintel.visitor.klaviyoHasGatheredEmail();

      case 'device-type':
        try {
          var platforms = rule.value.split(',');

          var platform = 'desktop';
          if (exitintel.util.detectDevice.isMobile.phone) {
            platform = 'phone';
          }

          if (exitintel.util.detectDevice.isMobile.tablet) {
            platform = 'tablet';
          }

          if (platforms.indexOf(platform) !== -1) {
            return true;
          }

          return false;

        } catch (e) {
          exitintel.util.error(e);
          return false;
        }
        break;

      case 'geo-location':
        var geo = null;

        try {
          geo = JSON.parse(sessionStorage.getItem('exitintel_geo'));
        } catch (e) {
          geo = null;
        }

        // Geo location not available
        if (!geo) {
          return false;
        }

        if (rule.value) {
          if (rule.value.country && rule.value.country !== '' && rule.value.country !== geo.countryCode) {
            return false;
          }
          if (rule.value.region && rule.value.region !== '' && rule.value.region !== geo.region) {
            return false;
          }
          if (rule.value.city && rule.value.city !== '' && rule.value.city !== geo.city) {
            return false;
          }
        }

        return true;

      case 'mobile-seo-filter':
        // is mobile. from Google, on 1st pageview
        var conditions = [
            exitintel.util.detectDevice.isMobile.any,
            exitintel.storage.get('ref').match(/google/),
            exitintel.visitor.session.pageviewCount < 2
        ];
        for (var i = 0; i < conditions.length; i++) {
            if (!conditions[i]) {
                return false;
            }
        }
        return true;

      case 'custom-code':
        try {
          /*jshint -W054 */
          var fn = new Function('thisCampaign', 'try { ' + rule.value + '} catch (e) { exitintel.util.error(e); }');
          /*jshint +W054 */
          return fn(campaign);
        } catch (e) {
          exitintel.util.error(e);
          return false;
        }
    }
  },

  // Test URL specific campaign rule
  testURLRule: function (fnPrefix, rule) {

    var negate = false;

    // jshint -W086
    switch (rule.filterType) {
      case 'not-contains':
        negate = true;
      case 'contains':
        if (exitintel.util[fnPrefix + 'Contains'](rule.value)) {
          return !negate;
        }
      break;

      case 'not-exact-match':
        negate = true;
      case 'exact-match':
        if (exitintel.util[fnPrefix + 'Is'](rule.value)) {
          return !negate;
        }
      break;
    }
    // jshint +W086

    return negate;
  },

   // Test Visited URL specific campaign rule
   testVisitedURLRule: function (rule) {

    // jshint -W086
    switch (rule.filterType) {
      case 'not-contains':
        return exitintel.util.visitedURLNotContains(rule.value).reduce(function(result, current){
          return result || current;
        }, false);
      case 'contains':
        return exitintel.util.visitedURLContains(rule.value).reduce(function(result, current){
          return result || current;
        }, false);
      case 'not-exact-match':
         return exitintel.util.visitedURLIsNot(rule.value).reduce(function(result, current){
          return result || current;
        }, false);
      case 'exact-match':
       return exitintel.util.visitedURLIs(rule.value).reduce(function(result, current){
        return result || current;
      }, false);
    }
    // jshint +W086

  },

  get: function (id) {

    for (var i = 0; i < exitintel.campaign.available.length; i++) {
      if (exitintel.campaign.available[i].id == id) {
        return exitintel.campaign.available[i];
      }
    }

    return null;
  }
};




exitintel.ecommerce = {
    handleEvent: function(event) {
        exitintel.event.log(event[1], {data: event[2]});
    }
};



exitintel.trigger = {
    installedTriggers: {},
    postponedTriggers: [],

    pendingActions: [],



    install: function (type, action, options) {
        if (typeof exitintel.triggerTypes[type] === 'undefined') {
          exitintel.util.log('Trigger type \'' + type + '\' is not supported.');
          return;
        }

        var triggerFn = exitintel.triggerTypes[type].install;

        // Install trigger
        var triggerId = exitintel.util.getUniqueId();

        if (options.postpone == 'true') {
          var postponeBy = parseInt(options.postponeBy, 10);

          exitintel.util.log('Postponing trigger installation for ' + postponeBy + ' seconds.');
          var postponedTrigger = setTimeout(function () {
            triggerFn(triggerId, action, options);
          }, postponeBy * 1000);

          exitintel.trigger.postponedTriggers.push(postponedTrigger);
        } else {
          triggerFn(triggerId, action, options);
        }

        // Add to registry
        exitintel.trigger.installedTriggers[triggerId] = {
          type: type
        };

        return triggerId;
    },

    uninstall: function (triggerId) {
      // Check if trigger exists
      if (typeof exitintel.trigger.installedTriggers[triggerId] === 'undefined') {
        exitintel.util.log('Unable to uninstall trigger: ' + triggerId + '. Not found.');
        return;
      }

      // Check if previously uninstalled
      if (exitintel.trigger.installedTriggers[triggerId] === null) {
        exitintel.util.log('Trigger: ' + triggerId + ' is already uninstalled');
        return;
      }

      var trigger = exitintel.trigger.installedTriggers[triggerId];

      // Uninstall trigger
      var uninstallFn = exitintel.triggerTypes[trigger.type].uninstall;

      if (uninstallFn(triggerId)) {
        // Remove from registry
        exitintel.trigger.installedTriggers[triggerId] = null;
      }
    },

    uninstallAll: function () {
      for (var i in this.installedTriggers) {
        // Prototype.js fix
        if (typeof this.installedTriggers[i] == 'function') {
          continue;
        }
        this.uninstall(i);
      }

      // Clear postponed triggers
      for (var j = 0; j < this.postponedTriggers.length; j++) {
        clearTimeout(this.postponedTriggers[j]);
      }
    }
};


exitintel.triggerTypes = {

  onLoad: {
    install: function (triggerId, callback, options) {

      var delay = options.delay * 1000 || 0;

      setTimeout(callback, delay);
    },

    uninstall: function () {
      // too late
      return true;
    }
  },

  onExit: {
    install: function (triggerId, callback, options) {

      var triggerEvent = 'mouseleave.' + triggerId + '.exitintel';

      var timeoutDelay = options.delay * 1000 || 0;

      var exitTimeout = null;

      var exitDeferred = null;

      var mouseInPage = true;

      // Check if mouse leaves the page
      $('html').on(triggerEvent,function(e) {
        var mouseY = e.pageY-$(window).scrollTop();

        mouseInPage = false;

        var exitConfirmedPromises = [];
        if (mouseY<=2) {
          exitDeferred = exitintel.util.jQuery.Deferred();
          clearTimeout(exitTimeout);

          exitConfirmedPromises.push(exitintel.activityWatch.onInactive());
          exitConfirmedPromises.push(exitDeferred.promise());

          exitTimeout = setTimeout(function () {
            exitDeferred.resolve();
          }, timeoutDelay);

          $.when.apply($, exitConfirmedPromises).then(function () {
            if (mouseInPage) {
              return;
            }

            callback();
          });

        }

      });

      $('html').on('mouseenter.' + triggerId + '.exitintel', function () {
        mouseInPage = true;

        clearTimeout(exitTimeout);
        if (exitDeferred !== null) {
          exitDeferred.reject();
        }
      });

      $('html').on('keydown.' + triggerId + '.exitintel', function(e) {
        if (e.metaKey && e.keyCode === 76) {
          if (!timeoutDelay) {
            callback();
          } else {
            setTimeout(callback, timeoutDelay);
          }
        }
      });

      return true;
    },

    uninstall: function (triggerId) {
      var triggerEvent = 'mouseleave.' + triggerId + '.exitintel';
      $('html').off(triggerEvent);

      triggerEvent = 'keydown.' + triggerId + '.exitintel';
      $('html').off(triggerEvent);

      triggerEvent = 'mouseenter.' + triggerId + '.exitintel';
      $('html').off(triggerEvent);

      return true;
    }
  },

  onScrollTimeout: {
    install: function (triggerId, callback, options) {
      var triggerEvent = ['scroll.' + triggerId + '.exitintel', 'touchmove.' + triggerId + '.exitintel'].join(',');

      var scrollTimeoutDelay = options.delay * 1000 || 0;

      var scrollTimeout = null;

      var scrollTimeoutDeferred = null;

      $(window).on(triggerEvent, function () {
        clearTimeout(scrollTimeout);

        scrollTimeoutDeferred = exitintel.util.jQuery.Deferred();

        var inactivityConfirmedPromises = [];

        inactivityConfirmedPromises.push(exitintel.activityWatch.onInactive());
        inactivityConfirmedPromises.push(scrollTimeoutDeferred.promise());

        scrollTimeout = setTimeout(function () {
          scrollTimeoutDeferred.resolve();
        }, scrollTimeoutDelay);

        $.when.apply($, inactivityConfirmedPromises).then(function () {

          // Cancel if user is active
          if (exitintel.activityWatch.userActive()) {
            return;
          }

          // Cancel if trigger has been cancelled
          if (exitintel.trigger.installedTriggers[triggerId] === null) {
            return;
          }

          callback();
        });
      });

      return true;
    },

    uninstall: function (triggerId) {
      var triggerEvent = ['scroll.' + triggerId + '.exitintel', 'touchmove.' + triggerId + '.exitintel'].join(',');

      $(window).off(triggerEvent);

      return true;
    }
  },

  onScrolledToBottom: {
    install: function (triggerId, callback, options) {

      var triggerEvent = ['scroll.' + triggerId + '.exitintel', 'touchmove.' + triggerId + '.exitintel'].join(',');
      var scrollTimeoutDelay = options.delay * 1000 || 0;

      $(window).on(triggerEvent, function () {
        var scrollHeight = $(document).height();
        var scrollPosition = $(window).height() + $(window).scrollTop();

        if ((scrollHeight - scrollPosition) / scrollHeight === 0) {
            setTimeout(function () {
              callback();
            }, scrollTimeoutDelay);
        }
      });
    },

    uninstall: function (triggerId) {
      var triggerEvent = ['scroll.' + triggerId + '.exitintel', 'touchmove.' + triggerId + '.exitintel'].join(',');

      $(window).off(triggerEvent);
    }
  },

  onScrolledToElement: {
    install: function (triggerId, callback, options) {

      var triggerEvent = ['scroll.' + triggerId + '.exitintel', 'touchmove.' + triggerId + '.exitintel'].join(',');
      var scrollTimeoutDelay = options.delay * 1000 || 0;

      // Element position
      var targetElement = $(options.selector);

      var targetHeight = null;

      switch (options.targetMode) {
        case 'reached-top':
          targetHeight = targetElement.position().top;
        break;
        case 'reached-bottom':
          targetHeight = targetElement.position().top + targetElement.height();
        break;
      }

      if (!targetElement.length) {
        return;
      }


      $(window).on(triggerEvent, function () {
        var scrollPosition = $(window).height() + $(window).scrollTop();

        if ((targetHeight - scrollPosition) / targetHeight <= 0) {
            setTimeout(function () {
              callback();
            }, scrollTimeoutDelay);
        }
      });
    },

    uninstall: function (triggerId) {
      var triggerEvent = ['scroll.' + triggerId + '.exitintel', 'touchmove.' + triggerId + '.exitintel'].join(',');

      $(window).off(triggerEvent);
    }
  },

  onMobileScrollUp: {
    install: function (triggerId, callback /*, options */) {

      var triggerEvent = ['scroll.' + triggerId + '.exitintel', 'touchmove.' + triggerId + '.exitintel'].join(',');

      var lastY = $(window).scrollTop();
      var tracking = false;


      // TODO: Modify the following values in order to fine-tune the 'scroll up' event on different mobile phones.
      var offsetInPixels = 100;
      var scrollTimeoutDelay = 100;
      // ./TODO

      $(window).on(triggerEvent, function () {

        var y = $(window).scrollTop();

        if (y < lastY && !tracking) {
          tracking = true;
          lastY = y;
          setTimeout(function () {
            // trigger the ad only if the 'scroll up' event has at least a diff of 100px.
            if (y - lastY >= offsetInPixels) {
              callback();
            } else {
              tracking = false;
            }
          }, scrollTimeoutDelay);
        } else {
          lastY = y;
        }
      });
    },

    uninstall: function (triggerId) {
      var triggerEvent = ['scroll.' + triggerId + '.exitintel', 'touchmove.' + triggerId + '.exitintel'].join(',');

      $(window).off(triggerEvent);
    }
  },

};


exitintel.activityWatch = {
    timers: {
      keyboard: null,
      mousehover: null,
      mouseclick: null
    },

    watches: {
      keyboard: false,
      mousehover: false,
      mouseclick: false
    },

    init: function () {
      // Keyboard

      var setKeyboardActivityWatch = function () {
        exitintel.activityWatch.watches.keyboard = true;
        clearTimeout(exitintel.activityWatch.timers.keyboard);
        exitintel.activityWatch.timers.keyboard = setTimeout(function () {
          exitintel.activityWatch.watches.keyboard = false;
        }, 10000);
      };

      // On key up: 10 seconds
      $('body').on('keyup', setKeyboardActivityWatch);

      // Any input focus
      $('body').on('focusin focusout', 'input', setKeyboardActivityWatch);

      // Mouse

      // On hover: 150ms
      $('body').on('mouseover', 'a,button', function () {
        exitintel.activityWatch.watches.mousehover = true;
        clearTimeout(exitintel.activityWatch.timers.mousehover);
        exitintel.activityWatch.timers.mousehover = setTimeout(function () {
          exitintel.activityWatch.watches.mousehover = false;
        }, 150);
      });

      // On click: 3sec
      $('body').on('click', 'a,button', function () {
        exitintel.activityWatch.watches.mouseclick = true;
        clearTimeout(exitintel.activityWatch.timers.mouseclick);
        exitintel.activityWatch.timers.mouseclick = setTimeout(function () {
          exitintel.activityWatch.watches.mouseclick = false;
        }, 3000);
      });
    },

    onInactive: function () {
      var d = new exitintel.util.jQuery.Deferred();

      if ((this.watches.keyboard || this.watches.mousehover || this.watches.mouseclick) === false) {
        d.resolve();
      } else {
        this.waitForInactive(d);
      }

      return d.promise();
    },

    waitForInactive: function (deferred) {
      if (this.userActive()) {
        setTimeout(function () {
          exitintel.activityWatch.waitForInactive(deferred);
        }, 100);
      } else {
        deferred.resolve();
      }
    },

    userActive: function () {
      return this.watches.keyboard || this.watches.mousehover || this.watches.mouseclick;
    }
};


exitintel.event = {

    logServiceURL: '//app.exitintel.com/log/ei.gif?',

    queueProcessingTimeout: null,

    queue: [],

    log: function (event, args) {
        if (args && args.onDone) {
            // skip queue. send now (response waited)
            var serializedEvent = this.serializeEvent({
                type: event,
                args: args
            });

            this.sendEvents([serializedEvent], args.onDone);

            return;
        }

        // Queue the event
        this.queue.push({
            type: event,
            args: args
        });

        // Set a timeout for processing the queue
        clearTimeout(this.queueProcessingTimeout);
        this.queueProcessingTimeout = setTimeout(this.processQueue, 1000);
    },

    processQueue: function () {
        if (!exitintel.event.queue.length) {
            return;
        }

        var serializedEvents = [];
        for (var i = 0; i < exitintel.event.queue.length; i++) {
            var e = exitintel.event.queue[i];

            serializedEvents.push(exitintel.event.serializeEvent(e));
        }

        exitintel.event.sendEvents(serializedEvents);

        // clear the queue
        exitintel.event.queue = [];
    },

    serializeEvent: function (e) {
        var trackedEvent = {};

        if (e.args) {
            if (e.args.campaignId) {
                trackedEvent.cId = e.args.campaignId;
                trackedEvent.stId = e.args.campaignId + '-st';
            }

            if (e.args.adId) {
                trackedEvent.adId = e.args.adId;
            }

            if (e.args.data) {
                trackedEvent.data = JSON.stringify(e.args.data);
            }
        }

        switch (e.type) {
            case 'pageview':
                trackedEvent.et = 'p';

                if (exitintel.visitor.session.isFirstVisit && !(e.args && e.args.campaignId)) {
                    trackedEvent.et += ',v';
                    exitintel.visitor.session.isFirstVisit = false;

                } else if (e.args && e.args.campaignId && !exitintel.visitor.hasVisitedCampaign(e.args.campaignId)) {
                    trackedEvent.et += ',v';
                }

                // Set the campaign as visited
                if (e.args && e.args.campaignId && !exitintel.visitor.hasVisitedCampaign(e.args.campaignId)) {
                    exitintel.visitor.setVisitedCampaign(e.args.campaignId);
                }
                break;
            case 'ad-impression':
                trackedEvent.et = 'i';
                break;
            case 'collect-data':
                trackedEvent.et = 'c';
                break;

            //e-commerce events
            case 'trackItemView':
                trackedEvent.et = 'ev';
                break;
            case 'trackCartUpdate':
                trackedEvent.et = 'ec';
                break;
            case 'trackAddItem':
                trackedEvent.et = 'ea';
                break;
            case 'trackOrder':
                trackedEvent.et = 'eo';
                break;

            case 'goal-completed':
                trackedEvent.et = 'g';
                break;
            case 'custom':
                trackedEvent.et = 'c';
                break;
        }

        return trackedEvent;
    },

    sendEvents: function (events, callback) {

        // General info for all requests
        var serializedInfo = [
            'aId=' + encodeURIComponent(exitintel.config.clientId),
            'vId=' + encodeURIComponent(exitintel.visitor.identity.id),
            'sId=' + encodeURIComponent(exitintel.visitor.session.id),
            'ref=' + encodeURIComponent(exitintel.visitor.session.originalReferrer),
            'cId=' + encodeURIComponent(exitintel.visitor.getAssignedConfiguration()),
            'url=' + encodeURIComponent(window.location.href)
        ];

        for (var i = 0; i < events.length; i++) {
            var e = events[i];

            for (var attr in e) {
                if (typeof e[attr] == 'function') {
                    continue;
                }

                if (attr == 'et') {
                    serializedInfo.push('e[' + i + '][t]=' + encodeURIComponent(e[attr]));
                } else {
                    serializedInfo.push('e[' + i + '][d][' + attr + ']=' + encodeURIComponent(e[attr]));
                }
            }
        }
        var beaconImage = (new Image());

        if (callback) {
            $(beaconImage).on('load', function () {
                callback(true);
            });
            beaconImage.onerror = function () {
                callback(true);
            };
            beaconImage.onabort = function () {
                callback(true);
            };
        }

        beaconImage.src = 'https://betastats.exitintel.com/?' + serializedInfo.join('&') + '&_t=' + ((new Date()).valueOf());
    }
};

exitintel.events = {

  events: {},

  on: function (event, listener) {
      if (typeof this.events[event] !== 'object') {
          this.events[event] = [];
      }

      this.events[event].push(listener);
  },

  removeListener: function (event, listener) {
      var idx;

      if (typeof this.events[event] === 'object') {
          idx = this.events[event].indexOf(listener);

          if (idx > -1) {
              this.events[event].splice(idx, 1);
          }
      }
  },

  emit: function (event) {
      var i, listeners, length, args = [].slice.call(arguments, 1);

      var eventDescription = {
        type: event
      };

      // Add event description in args for the listener
      var evtArgs = args.slice(0);
      evtArgs.unshift(eventDescription);

      if (typeof this.events[event] === 'object') {
          listeners = this.events[event].slice();
          length = listeners.length;

          for (i = 0; i < length; i++) {
              listeners[i].apply(this, evtArgs);
          }
      }

      if (typeof this.events['*'] === 'object') {
          listeners = this.events['*'].slice();
          length = listeners.length;

          for (i = 0; i < length; i++) {
              listeners[i].apply(this, evtArgs);
          }
      }


  },

  once: function (event, listener) {
      this.on(event, function g () {
          this.removeListener(event, g);
          listener.apply(this, arguments);
      });
  }
};



exitintel.shopify = {
    cartSessionAppend: function(cartId) {
        var cart = document.getElementById(cartId);

        if (cart) {
            //we require the visitor.identity and visitor.session to reload the user's session
            var session = {
                identity: exitintel.visitor.identity,
                session: exitintel.visitor.session
            };

            var eiFields = document.createElement('span');
            eiFields.innerHTML = '<input type="hidden" name="attributes[ei-session]" value="'+encodeURIComponent(JSON.stringify(session))+'"/>';

            cart.appendChild(eiFields);
        }
    }
};



// isArray polyfill
if (!Array.isArray) {
  Array.isArray = function(arg) {
    return Object.prototype.toString.call(arg) === '[object Array]';
  };
}

exitintel.commands = {

  timer: null,

  startCheckLoop: function () {
      if (exitintel.commands.timer) {
        clearTimeout(exitintel.commands.timer);
      }
      exitintel.commands.checkQueue();
      exitintel.commands.timer = setInterval(function () {
        exitintel.commands.checkQueue();
      }, 1000);
  },

  stopCheckLoop: function () {
    clearTimeout(exitintel.commands.timer);
  },

  checkQueue: function() {
    if (typeof window._exiq !== 'undefined' ) {
      if (window._exiq.length === 0) {
        return;
      }

      //delegate the events to the appropriate handlers
      for (var i = 0; i < window._exiq.length; i++) {
        if (Array.isArray(window._exiq[i]) && window._exiq[i].length > 0) {
          var cmd = window._exiq[i];
          var namespace = cmd[0];

          switch (namespace) {
            case '_setVar':
              exitintel.visitor.session.vars = exitintel.visitor.session.vars || {};
              exitintel.visitor.session.vars[cmd[1]] = cmd[2];
            break;
            case 'ecommerce':
              exitintel.ecommerce.handleEvent(window._exiq[i]);
            break;
            case 'disableCampaigns':
              if (!exitintel.config.disabled) {
                exitintel.config.disabled = true;

                // Reload
                if (exitintel.ad.visibleAds.popup) {
                  exitintel.ad.visibleAds.popup.hide();
                }
                if (exitintel.ad.visibleAds.persistent) {
                  exitintel.ad.visibleAds.persistent.hide();
                }
                exitintel.campaign.active = [];
                exitintel.ad.installedAds = {};
                exitintel.trigger.uninstallAll();
                exitintel.ad.adTriggers = {};

                exitintel.campaign.campaignsLoaded();
              }
            break;
            case 'enableCampaigns':
              if (exitintel.config.disabled) {
                exitintel.config.disabled = false;

                // Reload
                exitintel.campaign.active = [];
                exitintel.ad.installedAds = {};
                exitintel.trigger.uninstallAll();
                exitintel.ad.adTriggers = {};

                exitintel.campaign.campaignsLoaded();
              }
            break;
          }
        }
      }

      //clear the queue
      window._exiq = [];
    }
  }
};


/* globals io */

exitintel.profiler = {

  connected: false,
  socket: null,

  performance: {},

  connect: function() {
    if (!window.performance || !window.performance.timing) {
      return;
    }

    exitintel.profiler.performance = window.performance.timing;

    exitintel.util.loadJS(exitintel.config.profilerLibURL, function () {
      exitintel.profiler.socket = io(exitintel.config.profilerURL);
      exitintel.profiler.connected = true;

      exitintel.profiler.init();
    });
  },

  init: function() {
    var p = exitintel.profiler.performance;

    exitintel.profiler.socket.emit('meta', {
      'user-agent': navigator.userAgent,
      'url': window.location.href,
      'visitor-id': exitintel.visitor.identity.id,
      'session-id': exitintel.visitor.session.id,
    });

    exitintel.profiler.sendValue('window-loaded', p.loadEventEnd - p.connectStart);
    exitintel.profiler.sendValue('dom-ready', p.domComplete - p.connectStart);

    exitintel.profiler.send('connected');
  },

  sendValue: function(name, value) {
    if (!exitintel.profiler.connected) {
      return;
    }
    exitintel.profiler.socket.emit('time', { name: name, value: value });
  },

  send: function (event) {
    var p = exitintel.profiler.performance;

    exitintel.profiler.sendValue(event, (new Date()).valueOf() - p.connectStart);
  }

};


exitintel.integrations = exitintel.integrations || {};

exitintel.integrations._api = {
    send: function (type, id, data, promise, sync) {
			$.ajax({
				method: 'POST',
				url: exitintel.config.integrationsApiUrl + '/send/' + type + '/' + id +
              '?sync=' + (sync ? 'true' : ''),
				data: data,
				timeout: 10000,
				beforeSend: function(jqXHR, settings) {
					console.log(settings.url);
				}
			})
			.done(function (response) {
        if (response.status !== 'success') {
          promise.reject(response);
        } else {
  				promise.resolve(response);
        }
			})
			.fail(function() {
				promise.reject({
         "status": "error",
         "errorId": 999999,
         "errorMessage": "General error"
        });
			});

    },
    lookup: function (type, id, email, list, promise) {
      $.ajax({
        method: 'GET',
        url: exitintel.config.integrationsApiUrl + '/lookup/' + type + '/' + id,
        data: {
          email: email,
          list: list
        },
        timeout: 10000
      })
      .done(function (response) {
        if (response.status !== 'success') {
          promise.reject(response);
        } else {
          promise.resolve(response);
        }
      })
      .fail(function () {
        promise.reject({
          "status": "error",
          "errorId": 999999,
          "errorMessage": "General error"
        });
      });

        // Ajax request goes here

        // callback(response);
    }
};


exitintel.integrations = exitintel.integrations || {};

exitintel.integrations.mailchimp = {
    send: function (id, email, data, sync) {
      var d = exitintel.util.jQuery.Deferred();

      exitintel.integrations._api.send('mailchimp', id, {
        'email': email,
        'visitor_id': exitintel.visitor.identity.id,
        'merge_vars': data
      }, d, sync);

      return d.promise();
    },

    lookup: function (id, data) {
      var d = exitintel.util.jQuery.Deferred();

      exitintel.integrations._api.lookup('mailchimp', id, data.email, data.list, d);

      return d.promise();
    }
};


// Test code:

/*
sendPromise = exitintel.integration.mailchimp.send(integration_id, {email: 'test@test.com'})

sendPromise.then(function () {
  // send promise is resolved
}, function () {
  // send promise is rejected
});
*/


exitintel.integrations = exitintel.integrations || {};

exitintel.integrations.klaviyo = {
  send: function (id, email, data, sync) {
    var d = exitintel.util.jQuery.Deferred();

    exitintel.integrations._api.send('klaviyo', id, {
      'email': email,
      'visitor_id': exitintel.visitor.identity.id,
      'merge_vars': data
    }, d, sync);

    return d.promise();
  },

  lookup: function (id, data) {
    var d = exitintel.util.jQuery.Deferred();

    exitintel.integrations._api.lookup('klaviyo', id, data.email, data.list, d);

    return d.promise();
  },

  getEmail: function () {
    try {
      /* jshint ignore:start */
      return JSON.parse(atob(exitintel.cookie.getRaw('__kla_id')))['$email'];
      /* jshint ignore:end */
    } catch (e) {
      return null;
    }
  },

  isKnownVisitor: function () {
    return !!this.getEmail();
  },

  isUnkownVisitor: function () {
    return !this.isKnownVisitor();
  }
 
};


exitintel.integrations = exitintel.integrations || {};

exitintel.integrations.bronto = {
  send: function (id, email, data, sync) {
    var d = exitintel.util.jQuery.Deferred();

    exitintel.integrations._api.send('bronto', id, {
      'email': email,
      'visitor_id': exitintel.visitor.identity.id,
      'merge_vars': data
    }, d, sync);

    return d.promise();
  },

  lookup: function (id, data) {
    var d = exitintel.util.jQuery.Deferred();

    exitintel.integrations._api.lookup('bronto', id, data.email, data.list, d);

    return d.promise();
  }
};


/*global ga */

exitintel.integrations = exitintel.integrations || {};

exitintel.integrations.ga = {
  trackEvent: function (category, action, label, value) {
    var isClassic = !!(window._gaq && window._gaq.push && window._gaq.push !== Array.prototype.push);

    // Classic
    if (isClassic) {
      window._gaq.push(['_trackEvent', category, action, label, value, true]);
      return;
    }

    // Universal
    if (typeof (ga) !== 'undefined') {
      ga(function()
      {
        var trackers = ga.getAll();

        var usedTrackingIds = [];

        for (var i=0; i<trackers.length; ++i)
        {
          try {
            var name = trackers[i].get('name');

            var trackingId = trackers[i].get('trackingId');

            // Skip if it has already been sent to this tracking id
            if (usedTrackingIds.indexOf(trackingId) !== -1) {
              continue;
            }

            usedTrackingIds.push(trackingId);

            ga(name + '.send', 'event', category, action, label, value || 0, {'nonInteraction': 1});
          } catch (e) {
            exitintel.util.log('Unable to send to GA');
          }
        }
      });
    }

  }

};



exitintel.migration = {
  run: function () {
    var cookieVersion = parseInt(exitintel.cookie.get('ver'), 10) | 0;
    var currentVersion = exitintel.config.schemaVersion;

    if (currentVersion > cookieVersion) {
      for (var i = cookieVersion; i < currentVersion; i++) {
        if (exitintel.migration._mig[i + '_to_' + (i+1)]) {
          // run migration
          exitintel.migration._mig[i + '_to_' + (i+1)]();
        }
      }
    }

    var days = 1825;
    var date = new Date();
    date.setTime(date.getTime()+(days*24*60*60*1000));
    // var expires = '; expires='+date.toGMTString();
    // document.cookie = 'exitintel_ver='+currentVersion+expires+';path=/;';
    exitintel.cookie.set('ver', currentVersion, exitintel.config.cookieExpirationDays);
  },

  _mig: {
    '0_to_1': function () {

      exitintel.util.log('Migrating cookies 0 to 1');

      var cookies = document.cookie.split(';').map(function (c) {
        var parts = c.split('=');
        return {
          name: parts[0].trim(),
          value: parts[1]
        };
      });

      var exiCookies = cookies.filter(function (c) {
        if (c.name.match(/^exitintel_/)) {
          return true;
        }

        return false;
      });

      for (var i = 0; i < exiCookies.length; i++) {

        var cookieName = exiCookies[i].name.replace(/^exitintel_/, '');
        var cookieVal = exitintel.cookie.get(cookieName);

        if (cookieVal === null) {
          continue;
        }

        // Expire cookie (without domain)
        document.cookie = exitintel.cookie.prefix + cookieName + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;';

        var expire = ['ref', 'sid', 'lp'].indexOf(cookieName) >= 0 ? null : exitintel.config.cookieExpirationDays;

        // Reset cookie
        exitintel.cookie.set(cookieName, cookieVal, expire);
      }
    },
    '1_to_2': function () {

      exitintel.util.log('Migrating cookies 1 to 2');

      var cookies = document.cookie.split(';').map(function (c) {
        var parts = c.split('=');
        return {
          name: parts[0].trim(),
          value: parts[1]
        };
      });

      var exiCookies = cookies.filter(function (c) {
        if (c.name.match(/^exitintel_/)) {
          return true;
        }

        return false;
      });

      for (var i = 0; i < exiCookies.length; i++) {

        var cookieName = exiCookies[i].name.replace(/^exitintel_/, '');
        var cookieVal = exitintel.cookie.get(cookieName, true);

        if (cookieVal === null) {
          continue;
        }

        var expire = ['ref', 'sid', 'lp'].indexOf(cookieName) >= 0 ? null : exitintel.config.cookieExpirationDays;

        // Reset cookie
        exitintel.cookie.set(cookieName, cookieVal, expire);
      }
    }

  }
};


exitintel.debug = exitintel.debug || {};

exitintel.debug.options = {};

exitintel.debug.preview = {
  isPreviewSession: false
};

exitintel.debug.init = function () {

    try {
      var accountOverride = sessionStorage.getItem('exitintel_account_override');
      if (accountOverride) {
        exitintel.config.clientId = accountOverride;
      }
    } catch (e) {

    }

    exitintel.debug.loadOptions();

    exitintel.debug.parseURLCommands();

    exitintel.debug.showNotification();

    if (window.location.href.match(/exitintel-debug:(.*)/)) {

      exitintel.config.prefetchedConfiguration = null;
    }
};

exitintel.debug.setOption = function (name, value) {
  exitintel.debug.options[name] = value;
  exitintel.debug.saveOptions();
};

exitintel.debug.saveOptions = function () {
  sessionStorage.setItem('exitintel_debug_options', JSON.stringify(exitintel.debug.options));
};

exitintel.debug.loadOptions = function () {
  try {
    exitintel.debug.options = JSON.parse(sessionStorage.getItem('exitintel_debug_options'));

    if (typeof exitintel.debug.options !== 'object' || exitintel.debug.options === null) {
      exitintel.debug.options = {};
    }
  } catch (e) {
    exitintel.debug.options = {};
  }
};

exitintel.debug.parseURLCommands = function () {
  var params = [];

  if (window.location.href.match(/exitintel-debug/)) {
    if (window.location.href.match(/exitintel-debug:(\[.*\])/) || decodeURIComponent(window.location.href).match(/exitintel-debug:(\[.*\])/)) {
      try {
        params = JSON.parse(RegExp.$1);
      } catch (e) {
        params = JSON.parse(decodeURIComponent(RegExp.$1));
      }
    }

    // Try with base64
    if (!params || !params.length) {
      if (decodeURIComponent(window.location.href).match(/exitintel-debug:([^#]*)/)) {
        try {
          params = JSON.parse(atob(RegExp.$1));
        } catch (e) {
          params = null;
        }
      }
    }
  }

  if (!params) {
    return;
  }

  for (var i = 0; i < params.length; i++) {

    // Set publication
    if (params[i].name == 'pub') {

      if (params[i].value) {
        //console.dir('set pub cookies');
        //console.dir(params[i]);

        exitintel.storage.set('publication', params[i].value, 1);
      } else {
        exitintel.storage.unset('publication');
      }
    } else if (params[i].name == 'reset') {
      exitintel.debug.resetCookies();
    } else if (params[i].name == 'set-account') {
      exitintel.config.clientId = params[i].value;
      sessionStorage.setItem('exitintel_account_override', params[i].value);
    } else if (params[i].name == 'preview') {
      exitintel.debug.preview.isPreviewSession = true;
      exitintel.debug.preview.campaignId = params[i].campaignId;
      exitintel.debug.preview.adId = params[i].adId;
    } else if (params[i].name == 'option') {
      exitintel.debug.setOption(params[i].value, true);
    }
  }
};

exitintel.debug.resetCookies = function () {

  var ca = document.cookie.split(';');

  for(var i=0;i < ca.length;i++) {
      var c = ca[i];

      while (c.charAt(0)==' ') {
        c = c.substring(1,c.length);
      }

      if (c.match(/(exitintel_[a-z]+)/i)) {
        var name = RegExp.$1;

        // Host specific
        document.cookie = name+'=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;';

        var domain = window.location.host;

        if (!window.location.host.match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)) { // ip address
          var domainParts = window.location.host.match(/([^.]+\.[^\.]+)$/);

          if (domainParts) {
            domain = '.' + domainParts[0];
          }

        }

        // Domain specific
        document.cookie = name+'=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=' + domain + ';path=/;';


      }
  }

  // reset options session storage
  sessionStorage.setItem('exitintel_debug_options', '{}');

  // reset account override session storage
  sessionStorage.removeItem('exitintel_account_override');

  return null;
};

exitintel.debug.showNotification = function () {

  if (typeof exitintel.debug.options["disable-notification"] != 'undefined' && exitintel.debug.options["disable-notification"]) {
    return;
  }

  var activePub = exitintel.storage.get('publication');
  var isPreview = exitintel.debug.preview.isPreviewSession;
  var accountOverride = null;

  try {
    accountOverride = sessionStorage.getItem('exitintel_account_override');
  } catch (e) {

  }

  if (!activePub && !isPreview && !accountOverride) {
    return;
  }

  var notification = exitintel.util.jQuery('<div/>')
    .css({
      'position': 'fixed',
      'right': '0px',
      'bottom': '0px',
      'font-size': '10px',
      'background-color': '#ffffee',
      'border': '1px solid #ffb',
      'padding': '5px',
      'z-index': '100000000'
    });

  if (activePub) {
    notification.html('Publication: ' + activePub);
  } else if (isPreview) {
    notification.html('Preview session');
  }

  if (accountOverride) {
    notification.append(' - <b>Account override: ' + accountOverride + '</b>');
  }

  var resetBtn = exitintel.util.jQuery('<button/>')
    .css({
      'margin-left': '10px'
    }).html('reset');

  resetBtn.click(function () {
    window.location.href = '#exitintel-debug:[{"name":"reset"}]';
    exitintel.debug.resetCookies();
    window.location.reload();
  });

  notification.append(resetBtn);

  exitintel.util.jQuery('body').append(notification);

  setTimeout(function () {
    notification.css('display', 'none');

  }, 10000);

};


exitintel.report = {
  processingTimeout: null,

  queue: [],

  exception: function (exception, context) {
    exitintel.report.error(
      exception.name,
      exception.message,
      exception.stack,
      context
    );
  },

  error: function (code, description, details, context, sync) {
    var ctx = {};
    $.extend(
      ctx,
      {
        accountId: exitintel.config.clientId,
        visitorId: exitintel.visitor.getIdentity().id,
        sessionId: exitintel.visitor.session.id,
        userAgent: navigator.userAgent,
        url: window.location.href
      },
      context
    );

    var pack = {
      type: 'error',
      component: 'snippet',
      code: code,
      description: description,
      details: details,
      context: ctx
    };

    if (sync) {
      this.send([pack]);

      return;
    }

    this.queue.push(pack);

    clearTimeout(this.processingTimeout);
    this.processingTimeout = setTimeout(this.processQueue, 1000);
  },

  send: function (reports) {
    $.ajax({
      url: exitintel.config.reportURL,
      method: 'POST',
      data: JSON.stringify(reports)
    });
  },

  processQueue: function () {
    if (!exitintel.report.queue.length) {
      return;
    }

    exitintel.report.send(exitintel.report.queue);

    exitintel.report.queue = [];
  }
};


if (root.exitintelConfig) {
  if (root.exitintelConfig.clientId) {
    exitintel.config.clientId = root.exitintelConfig.clientId;
  }
}

if (exitintel.config.clientId) {

  var loadExitIntel = function () {
    if (window.exitintel && window.exitintel.inited === true) {
      return;
    }


    try{
      if(navigator.userAgent.indexOf("googleweblight")!=-1){
        exitintel.util.log("Stopped process because google weblight");
        return;
      }
    } catch(e){
    }

    // Detect prototype and override
    // jshint -W106
    (function () {
      if (typeof Prototype !== 'undefined' && parseFloat(Prototype.Version.substr(0,3)) < 1.7 && typeof Array.prototype.toJSON !== 'undefined') {
        var _json_stringify = JSON.stringify;
        JSON.stringify = function(value) {
            var _array_tojson = Array.prototype.toJSON;
            delete Array.prototype.toJSON;
            var r=_json_stringify(value);
            Array.prototype.toJSON = _array_tojson;
            return r;
        };
      }
    })();
    // jshint +W106

    exitintel.inited = true;

    exitintel.debug.init();

    // cookie migrations
    exitintel.migration.run();

    var configuration = exitintel.storage.getJSON('cfg') || {};
    var storageEngine = 'cookie-domain';

    try {
      // "storageEngine" (left for backwards compatibility)
      if (configuration && configuration.storageEngine) {
        storageEngine = configuration.storageEngine;

        delete configuration.storageEngine;
      }

      if (configuration && configuration.se) {
        storageEngine = configuration.se;
      }
    } catch (e) {

    }

    exitintel.storage.migration.init();

    // Check if storage engine matches current storage engine
    if (exitintel.config.storageEngine != storageEngine) {
      if (exitintel.storage.driver !== 'localStorage') {
        exitintel.storage.resetAll();
      }
    }

    configuration.se = exitintel.config.storageEngine;

    exitintel.storage.setJSON('cfg', configuration, exitintel.config.cookieExpirationDays);

    exitintel.commands.startCheckLoop();
    exitintel.campaign.init();

    exitintel.activityWatch.init();

    if (exitintel.config.profilerEnabled) {
      exitintel.profiler.connect();
    }

    exitintel.visitorHistory.trackPageview();

  };

  if (window.exitintelConfig && window.exitintelConfig.loadEvent) {
    switch (window.exitintelConfig.loadEvent) {
      case 'load':
        if (document.readyState == 'complete') { // already loaded
          loadExitIntel();
        } else if (window.addEventListener) {
          window.addEventListener("load", function exiload(){
            window.removeEventListener("load", exiload, false); //remove listener, no longer needed
            loadExitIntel();
          },false);
        } else {
          window.attachEvent('onload', function exiload(){
            loadExitIntel();
          });
        }
      break;
      case 'none':
        loadExitIntel();
      break;
      case 'ready':
        $(document).ready(loadExitIntel);
      break;
      default:
        $(document).ready(loadExitIntel);
      break;
    }
  } else {
    $(document).ready(loadExitIntel);
  }

}


});



// Export to the root, which is probably `window`.

  }
  catch (exception) {
    exitintel.report.exception(exception);
  }

  root.exitintel = exitintel;

}(this));
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=58)}([function(e,t,n){"use strict";e.exports=n(22)},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.NONE="NONE",e.GOOGLE="GOOGLE",e.ADOBE="ADOBE"}(t.FontProvider||(t.FontProvider={})),function(e){e.iPhone5="iPhone5",e.iPhone6="iPhone6",e.smallDesktop="smallDesktop",e.desktop="desktop"}(t.ViewportSizes||(t.ViewportSizes={})),function(e){e.NORMAL="normal",e.HOVER="hover",e.FOCUS="focus",e.ACTIVE="active",e.ERROR="error"}(t.PseudoStateMode||(t.PseudoStateMode={})),t.availableViewports={iPhone5:{id:"iPhone5",title:"iPhone 5",breakpointStart:0,width:320,height:517,type:"phone"},iPhone6:{id:"iPhone6",title:"iPhone 6",breakpointStart:375,width:375,height:667,type:"phone"},smallDesktop:{id:"smallDesktop",title:"Small desktop",breakpointStart:1024,width:1024,height:768,type:"desktop"},desktop:{id:"desktop",title:"Desktop",breakpointStart:1366,width:1366,height:768,type:"desktop"}},function(e){e.MOBILE="mobile",e.TABLET="tablet",e.DESKTOP="desktop"}(t.DeviceType||(t.DeviceType={})),function(e){e.CSS="css",e.JAVASCRIPT="javascript",e.HTML="html"}(t.CodeSnippetType||(t.CodeSnippetType={})),function(e){e.CONTAINER="container",e.ELEMENT="element"}(t.ElementTypeEnum||(t.ElementTypeEnum={})),function(e){e.NORMAL="normal",e.BUTTON_GROUP="button-group"}(t.ContainerSubTypeEnum||(t.ContainerSubTypeEnum={})),function(e){e.INPUT_GENERAL="input-general",e.INPUT_EMAIL="input-email",e.INPUT_FULL_NAME="input-name",e.INPUT_FIRST_NAME="input-given-name",e.INPUT_LAST_NAME="input-family-name",e.INPUT_PHONE_NUMBER="input-tel-national",e.INPUT_COMPANY_NAME="input-organization",e.INPUT_BIRTHDAY="input-bday"}(r=t.ElementInputSubTypeEnum||(t.ElementInputSubTypeEnum={})),function(e){e.INPUT="input",e.TEXT="text",e.BUTTON="button",e.IMAGE="image",e.CLOSE="close",e.CUSTOM_HTML="custom-html"}(t.ElementSubTypeEnum||(t.ElementSubTypeEnum={})),function(e){e.CLOSE_AD="close-ad",e.COLLECT_DATA="collect-data",e.GO_TO_STEP="goto-step",e.TRIGGER_AD="trigger-ad",e.CUSTOM_CODE="custom-code",e.ACCEPT_DECLINE_PROMPT="accept-decline-prompt",e.DOWNLOAD_FILE="download-file",e.SEND_TO_GOOGLE_ANALYTICS="send-to-google-analytics",e.FB_LEAD_EVENT="fb-lead-event",e.SEND_TO_INTEGRATIONS_MANAGER="send-to-integrations-manager",e.SUBMIT_FORM="submit-form",e.GOTO_URL="goto-url"}(t.ButtonActionType||(t.ButtonActionType={})),function(e){e.SEND_INTEGRATIONS="sendIntegrations",e.TRIGGER_AD="triggerAd",e.FORCE_AD_SELECTION="forceAdSelection",e.GET_CLIENTS="getClients",e.GET_CAMPAIGN_INFO="getCampaignInfo",e.PREVIEW_LIVE="previewLive",e.GET_CLIENT_INFO="getClientInfo",e.HAS_UNSAVED_CHANGES="hasUnsavedChanges",e.GET_ANIMATIONS_URL="getAnimationsURL"}(t.WindowMessageType||(t.WindowMessageType={})),t.INPUT_PROPERTIES=Object.freeze({[r.INPUT_GENERAL]:{label:"General input",errorMessages:{required:"Please fill in this field",invalid:"Please check this field"},autocomplete:""},[r.INPUT_EMAIL]:{label:"Email address",errorMessages:{required:"Please enter your email address",invalid:"Please enter a valid email address"},autocomplete:"email"},[r.INPUT_FULL_NAME]:{label:"Name",errorMessages:{required:"Please enter your name",invalid:"Please enter your name"},autocomplete:"name"},[r.INPUT_FIRST_NAME]:{label:"First Name",errorMessages:{required:"Please enter your first name",invalid:"Please enter your first name"},autocomplete:"given-name"},[r.INPUT_LAST_NAME]:{label:"Last Name",errorMessages:{required:"Please enter your last name",invalid:"Please enter your last name"},autocomplete:"family-name"},[r.INPUT_PHONE_NUMBER]:{label:"Phone Number",errorMessages:{required:"Please enter your phone number",invalid:"Please enter a valid phone number"},autocomplete:"tel"},[r.INPUT_COMPANY_NAME]:{label:"Company Name",errorMessages:{required:"Please enter your company name",invalid:"Please enter your company name"},autocomplete:"organization"},[r.INPUT_BIRTHDAY]:{label:"Birthday",errorMessages:{required:"Please enter your birthday",invalid:"Please enter your birthday"},autocomplete:"bday"}}),t.DEFAULT_INPUT_ERROR_STYLES=Object.freeze({borderColor:"#A82A2A",borderWidth:"1px",eiErrorMessage:{color:"#A82A2A",background:"#FCE9ED",borderRadius:"4px"}}),function(e){e.CONTAINER="layers-draggable-container",e.ELEMENT="layers-draggable-element"}(t.LayersDraggableItems||(t.LayersDraggableItems={})),function(e){e.TREE="tree",e.NEW="new"}(t.DraggableType||(t.DraggableType={}))},function(e,t,n){"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}}(),e.exports=n(23)},function(e,t){t.getArg=function(e,t,n){if(t in e)return e[t];if(3===arguments.length)return n;throw new Error('"'+t+'" is a required argument.')};var n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,r=/^data:.+\,.+$/;function i(e){var t=e.match(n);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function o(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function a(e){var n=e,r=i(e);if(r){if(!r.path)return e;n=r.path}for(var a,u=t.isAbsolute(n),l=n.split(/\/+/),s=0,c=l.length-1;c>=0;c--)"."===(a=l[c])?l.splice(c,1):".."===a?s++:s>0&&(""===a?(l.splice(c+1,s),s=0):(l.splice(c,2),s--));return""===(n=l.join("/"))&&(n=u?"/":"."),r?(r.path=n,o(r)):n}function u(e,t){""===e&&(e="."),""===t&&(t=".");var n=i(t),u=i(e);if(u&&(e=u.path||"/"),n&&!n.scheme)return u&&(n.scheme=u.scheme),o(n);if(n||t.match(r))return t;if(u&&!u.host&&!u.path)return u.host=t,o(u);var l="/"===t.charAt(0)?t:a(e.replace(/\/+$/,"")+"/"+t);return u?(u.path=l,o(u)):l}t.urlParse=i,t.urlGenerate=o,t.normalize=a,t.join=u,t.isAbsolute=function(e){return"/"===e.charAt(0)||n.test(e)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var n=0;0!==t.indexOf(e+"/");){var r=e.lastIndexOf("/");if(r<0)return t;if((e=e.slice(0,r)).match(/^([^\/]+:\/)?\/*$/))return t;++n}return Array(n+1).join("../")+t.substr(e.length+1)};var l=!("__proto__"in Object.create(null));function s(e){return e}function c(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var n=t-10;n>=0;n--)if(36!==e.charCodeAt(n))return!1;return!0}function f(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}t.toSetString=l?s:function(e){return c(e)?"$"+e:e},t.fromSetString=l?s:function(e){return c(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,n){var r=f(e.source,t.source);return 0!==r||0!==(r=e.originalLine-t.originalLine)||0!==(r=e.originalColumn-t.originalColumn)||n||0!==(r=e.generatedColumn-t.generatedColumn)||0!==(r=e.generatedLine-t.generatedLine)?r:f(e.name,t.name)},t.compareByGeneratedPositionsDeflated=function(e,t,n){var r=e.generatedLine-t.generatedLine;return 0!==r||0!==(r=e.generatedColumn-t.generatedColumn)||n||0!==(r=f(e.source,t.source))||0!==(r=e.originalLine-t.originalLine)||0!==(r=e.originalColumn-t.originalColumn)?r:f(e.name,t.name)},t.compareByGeneratedPositionsInflated=function(e,t){var n=e.generatedLine-t.generatedLine;return 0!==n||0!==(n=e.generatedColumn-t.generatedColumn)||0!==(n=f(e.source,t.source))||0!==(n=e.originalLine-t.originalLine)||0!==(n=e.originalColumn-t.originalColumn)?n:f(e.name,t.name)},t.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},t.computeSourceURL=function(e,t,n){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),n){var r=i(n);if(!r)throw new Error("sourceMapURL could not be parsed");if(r.path){var l=r.path.lastIndexOf("/");l>=0&&(r.path=r.path.substring(0,l+1))}t=u(o(r),t)}return a(t)}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,u,l=a(e),s=1;s<arguments.length;s++){for(var c in n=Object(arguments[s]))i.call(n,c)&&(l[c]=n[c]);if(r){u=r(n);for(var f=0;f<u.length;f++)o.call(n,u[f])&&(l[u[f]]=n[u[f]])}}return l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FrameContextConsumer=t.FrameContext=void 0;var r=n(9);Object.defineProperty(t,"FrameContext",{enumerable:!0,get:function(){return r.FrameContext}}),Object.defineProperty(t,"FrameContextConsumer",{enumerable:!0,get:function(){return r.FrameContextConsumer}});var i,o=n(26),a=(i=o)&&i.__esModule?i:{default:i};t.default=a.default},function(e,t,n){"use strict";var r=n(5),i=n(30),o={}.hasOwnProperty;var a=["$push","$unshift","$splice","$set","$merge","$apply"],u={};function l(e,t,n){i(Array.isArray(e),"update(): expected target of %s to be an array; got %s.",n,e);var r=t[n];i(Array.isArray(r),"update(): expected spec of %s to be an array; got %s. Did you forget to wrap your parameter in an array?",n,r)}a.forEach((function(e){u[e]=!0})),e.exports=function e(t,n){if(i("object"==typeof n,"update(): You provided a key path to update() that did not contain one of %s. Did you forget to include {%s: ...}?",a.join(", "),"$set"),o.call(n,"$set"))return i(1===Object.keys(n).length,"Cannot have more than one key in an object with %s","$set"),n.$set;var s,c=(s=t,Array.isArray(s)?s.concat():s&&"object"==typeof s?r(new s.constructor,s):s);if(o.call(n,"$merge")){var f=n.$merge;i(f&&"object"==typeof f,"update(): %s expects a spec of type 'object'; got %s","$merge",f),i(c&&"object"==typeof c,"update(): %s expects a target of type 'object'; got %s","$merge",c),r(c,n.$merge)}for(var d in o.call(n,"$push")&&(l(t,n,"$push"),n.$push.forEach((function(e){c.push(e)}))),o.call(n,"$unshift")&&(l(t,n,"$unshift"),n.$unshift.forEach((function(e){c.unshift(e)}))),o.call(n,"$splice")&&(i(Array.isArray(t),"Expected %s target to be an array; got %s","$splice",t),i(Array.isArray(n.$splice),"update(): expected spec of %s to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?","$splice",n.$splice),n.$splice.forEach((function(e){i(Array.isArray(e),"update(): expected spec of %s to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?","$splice",n.$splice),c.splice.apply(c,e)}))),o.call(n,"$apply")&&(i("function"==typeof n.$apply,"update(): expected spec of %s to be a function; got %s.","$apply",n.$apply),c=n.$apply(c)),n)u.hasOwnProperty(d)&&u[d]||(c[d]=e(t[d],n[d]));return c}},function(e,t,n){t.parse=n(31),t.stringify=n(32)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FrameContextConsumer=t.FrameContextProvider=t.FrameContext=void 0;var r,i=n(0),o=(r=i)&&r.__esModule?r:{default:r};var a=void 0,u=void 0;"undefined"!=typeof document&&(a=document),"undefined"!=typeof window&&(u=window);var l=t.FrameContext=o.default.createContext({document:a,window:u}),s=l.Provider,c=l.Consumer;t.FrameContextProvider=s,t.FrameContextConsumer=c},function(e,t,n){e.exports=n(27)()},function(e,t){function n(e){this.options=e||{}}e.exports=n,n.prototype.emit=function(e){return e},n.prototype.visit=function(e){return this[e.type](e)},n.prototype.mapVisit=function(e,t){var n="";t=t||"";for(var r=0,i=e.length;r<i;r++)n+=this.visit(e[r]),t&&r<i-1&&(n+=this.emit(t));return n}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},function(e,t,n){t.SourceMapGenerator=n(14).SourceMapGenerator,t.SourceMapConsumer=n(38).SourceMapConsumer,t.SourceNode=n(41).SourceNode},function(e,t,n){var r=n(15),i=n(3),o=n(16).ArraySet,a=n(37).MappingList;function u(e){e||(e={}),this._file=i.getArg(e,"file",null),this._sourceRoot=i.getArg(e,"sourceRoot",null),this._skipValidation=i.getArg(e,"skipValidation",!1),this._sources=new o,this._names=new o,this._mappings=new a,this._sourcesContents=null}u.prototype._version=3,u.fromSourceMap=function(e){var t=e.sourceRoot,n=new u({file:e.file,sourceRoot:t});return e.eachMapping((function(e){var r={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(r.source=e.source,null!=t&&(r.source=i.relative(t,r.source)),r.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(r.name=e.name)),n.addMapping(r)})),e.sources.forEach((function(r){var o=r;null!==t&&(o=i.relative(t,r)),n._sources.has(o)||n._sources.add(o);var a=e.sourceContentFor(r);null!=a&&n.setSourceContent(r,a)})),n},u.prototype.addMapping=function(e){var t=i.getArg(e,"generated"),n=i.getArg(e,"original",null),r=i.getArg(e,"source",null),o=i.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,n,r,o),null!=r&&(r=String(r),this._sources.has(r)||this._sources.add(r)),null!=o&&(o=String(o),this._names.has(o)||this._names.add(o)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=n&&n.line,originalColumn:null!=n&&n.column,source:r,name:o})},u.prototype.setSourceContent=function(e,t){var n=e;null!=this._sourceRoot&&(n=i.relative(this._sourceRoot,n)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[i.toSetString(n)]=t):this._sourcesContents&&(delete this._sourcesContents[i.toSetString(n)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},u.prototype.applySourceMap=function(e,t,n){var r=t;if(null==t){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');r=e.file}var a=this._sourceRoot;null!=a&&(r=i.relative(a,r));var u=new o,l=new o;this._mappings.unsortedForEach((function(t){if(t.source===r&&null!=t.originalLine){var o=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=o.source&&(t.source=o.source,null!=n&&(t.source=i.join(n,t.source)),null!=a&&(t.source=i.relative(a,t.source)),t.originalLine=o.line,t.originalColumn=o.column,null!=o.name&&(t.name=o.name))}var s=t.source;null==s||u.has(s)||u.add(s);var c=t.name;null==c||l.has(c)||l.add(c)}),this),this._sources=u,this._names=l,e.sources.forEach((function(t){var r=e.sourceContentFor(t);null!=r&&(null!=n&&(t=i.join(n,t)),null!=a&&(t=i.relative(a,t)),this.setSourceContent(t,r))}),this)},u.prototype._validateMapping=function(e,t,n,r){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if((!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0)||t||n||r)&&!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&n))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:n,original:t,name:r}))},u.prototype._serializeMappings=function(){for(var e,t,n,o,a=0,u=1,l=0,s=0,c=0,f=0,d="",p=this._mappings.toArray(),h=0,m=p.length;h<m;h++){if(e="",(t=p[h]).generatedLine!==u)for(a=0;t.generatedLine!==u;)e+=";",u++;else if(h>0){if(!i.compareByGeneratedPositionsInflated(t,p[h-1]))continue;e+=","}e+=r.encode(t.generatedColumn-a),a=t.generatedColumn,null!=t.source&&(o=this._sources.indexOf(t.source),e+=r.encode(o-f),f=o,e+=r.encode(t.originalLine-1-s),s=t.originalLine-1,e+=r.encode(t.originalColumn-l),l=t.originalColumn,null!=t.name&&(n=this._names.indexOf(t.name),e+=r.encode(n-c),c=n)),d+=e}return d},u.prototype._generateSourcesContent=function(e,t){return e.map((function(e){if(!this._sourcesContents)return null;null!=t&&(e=i.relative(t,e));var n=i.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,n)?this._sourcesContents[n]:null}),this)},u.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},u.prototype.toString=function(){return JSON.stringify(this.toJSON())},t.SourceMapGenerator=u},function(e,t,n){var r=n(36);t.encode=function(e){var t,n="",i=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);do{t=31&i,(i>>>=5)>0&&(t|=32),n+=r.encode(t)}while(i>0);return n},t.decode=function(e,t,n){var i,o,a,u,l=e.length,s=0,c=0;do{if(t>=l)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(o=r.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));i=!!(32&o),s+=(o&=31)<<c,c+=5}while(i);n.value=(u=(a=s)>>1,1==(1&a)?-u:u),n.rest=t}},function(e,t,n){var r=n(3),i=Object.prototype.hasOwnProperty,o="undefined"!=typeof Map;function a(){this._array=[],this._set=o?new Map:Object.create(null)}a.fromArray=function(e,t){for(var n=new a,r=0,i=e.length;r<i;r++)n.add(e[r],t);return n},a.prototype.size=function(){return o?this._set.size:Object.getOwnPropertyNames(this._set).length},a.prototype.add=function(e,t){var n=o?e:r.toSetString(e),a=o?this.has(e):i.call(this._set,n),u=this._array.length;a&&!t||this._array.push(e),a||(o?this._set.set(e,u):this._set[n]=u)},a.prototype.has=function(e){if(o)return this._set.has(e);var t=r.toSetString(e);return i.call(this._set,t)},a.prototype.indexOf=function(e){if(o){var t=this._set.get(e);if(t>=0)return t}else{var n=r.toSetString(e);if(i.call(this._set,n))return this._set[n]}throw new Error('"'+e+'" is not in the set.')},a.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},a.prototype.toArray=function(){return this._array.slice()},t.ArraySet=a},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l,s=[],c=!1,f=-1;function d(){c&&l&&(c=!1,l.length?s=l.concat(s):f=-1,s.length&&p())}function p(){if(!c){var e=u(d);c=!0;for(var t=s.length;t;){for(l=s,s=[];++f<t;)l&&l[f].run();f=-1,t=s.length}l=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new h(e,t)),1!==s.length||c||u(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var a=o>=0?arguments[o]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,i="/"===a.charAt(0))}return(i?"/":"")+(t=n(r(t.split("/"),(function(e){return!!e})),!i).join("/"))||"."},t.normalize=function(e){var o=t.isAbsolute(e),a="/"===i(e,-1);return(e=n(r(e.split("/"),(function(e){return!!e})),!o).join("/"))||o||(e="."),e&&a&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),u=a,l=0;l<a;l++)if(i[l]!==o[l]){u=l;break}var s=[];for(l=u;l<i.length;l++)s.push("..");return(s=s.concat(o.slice(u))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},t.basename=function(e,t){var n=function(e){"string"!=typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,o=0,a=e.length-1;a>=0;--a){var u=e.charCodeAt(a);if(47!==u)-1===r&&(i=!1,r=a+1),46===u?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){n=a+1;break}}return-1===t||-1===r||0===o||1===o&&t===r-1&&t===n+1?"":e.slice(t,r)};var i="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(17))},function(e,t,n){var r;!function(){function i(e,t,n){return e.call.apply(e.bind,arguments)}function o(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function a(e,t,n){return(a=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?i:o).apply(null,arguments)}var u=Date.now||function(){return+new Date};function l(e,t){this.a=e,this.o=t||e,this.c=this.o.document}var s=!!window.FontFace;function c(e,t,n,r){if(t=e.c.createElement(t),n)for(var i in n)n.hasOwnProperty(i)&&("style"==i?t.style.cssText=n[i]:t.setAttribute(i,n[i]));return r&&t.appendChild(e.c.createTextNode(r)),t}function f(e,t,n){(e=e.c.getElementsByTagName(t)[0])||(e=document.documentElement),e.insertBefore(n,e.lastChild)}function d(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e,t,n){t=t||[],n=n||[];for(var r=e.className.split(/\s+/),i=0;i<t.length;i+=1){for(var o=!1,a=0;a<r.length;a+=1)if(t[i]===r[a]){o=!0;break}o||r.push(t[i])}for(t=[],i=0;i<r.length;i+=1){for(o=!1,a=0;a<n.length;a+=1)if(r[i]===n[a]){o=!0;break}o||t.push(r[i])}e.className=t.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function h(e,t){for(var n=e.className.split(/\s+/),r=0,i=n.length;r<i;r++)if(n[r]==t)return!0;return!1}function m(e,t,n){function r(){u&&i&&o&&(u(a),u=null)}t=c(e,"link",{rel:"stylesheet",href:t,media:"all"});var i=!1,o=!0,a=null,u=n||null;s?(t.onload=function(){i=!0,r()},t.onerror=function(){i=!0,a=Error("Stylesheet failed to load"),r()}):setTimeout((function(){i=!0,r()}),0),f(e,"head",t)}function g(e,t,n,r){var i=e.c.getElementsByTagName("head")[0];if(i){var o=c(e,"script",{src:t}),a=!1;return o.onload=o.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,n&&n(null),o.onload=o.onreadystatechange=null,"HEAD"==o.parentNode.tagName&&i.removeChild(o))},i.appendChild(o),setTimeout((function(){a||(a=!0,n&&n(Error("Script load timeout")))}),r||5e3),o}return null}function v(){this.a=0,this.c=null}function y(e){return e.a++,function(){e.a--,w(e)}}function b(e,t){e.c=t,w(e)}function w(e){0==e.a&&e.c&&(e.c(),e.c=null)}function E(e){this.a=e||"-"}function T(e,t){this.c=e,this.f=4,this.a="n";var n=(t||"n4").match(/^([nio])([1-9])$/i);n&&(this.a=n[1],this.f=parseInt(n[2],10))}function _(e){var t=[];e=e.split(/,\s*/);for(var n=0;n<e.length;n++){var r=e[n].replace(/['"]/g,"");-1!=r.indexOf(" ")||/^\d/.test(r)?t.push("'"+r+"'"):t.push(r)}return t.join(",")}function S(e){return e.a+e.f}function x(e){var t="normal";return"o"===e.a?t="oblique":"i"===e.a&&(t="italic"),t}function k(e){var t=4,n="n",r=null;return e&&((r=e.match(/(normal|oblique|italic)/i))&&r[1]&&(n=r[1].substr(0,1).toLowerCase()),(r=e.match(/([1-9]00|normal|bold)/i))&&r[1]&&(/bold/i.test(r[1])?t=7:/[1-9]00/.test(r[1])&&(t=parseInt(r[1].substr(0,1),10)))),n+t}function C(e,t){this.c=e,this.f=e.o.document.documentElement,this.h=t,this.a=new E("-"),this.j=!1!==t.events,this.g=!1!==t.classes}function A(e){if(e.g){var t=h(e.f,e.a.c("wf","active")),n=[],r=[e.a.c("wf","loading")];t||n.push(e.a.c("wf","inactive")),p(e.f,n,r)}O(e,"inactive")}function O(e,t,n){e.j&&e.h[t]&&(n?e.h[t](n.c,S(n)):e.h[t]())}function P(){this.c={}}function N(e,t){this.c=e,this.f=t,this.a=c(this.c,"span",{"aria-hidden":"true"},this.f)}function I(e){f(e.c,"body",e.a)}function R(e){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+_(e.c)+";font-style:"+x(e)+";font-weight:"+e.f+"00;"}function M(e,t,n,r,i,o){this.g=e,this.j=t,this.a=r,this.c=n,this.f=i||3e3,this.h=o||void 0}function L(e,t,n,r,i,o,a){this.v=e,this.B=t,this.c=n,this.a=r,this.s=a||"BESbswy",this.f={},this.w=i||3e3,this.u=o||null,this.m=this.j=this.h=this.g=null,this.g=new N(this.c,this.s),this.h=new N(this.c,this.s),this.j=new N(this.c,this.s),this.m=new N(this.c,this.s),e=R(e=new T(this.a.c+",serif",S(this.a))),this.g.a.style.cssText=e,e=R(e=new T(this.a.c+",sans-serif",S(this.a))),this.h.a.style.cssText=e,e=R(e=new T("serif",S(this.a))),this.j.a.style.cssText=e,e=R(e=new T("sans-serif",S(this.a))),this.m.a.style.cssText=e,I(this.g),I(this.h),I(this.j),I(this.m)}E.prototype.c=function(e){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n].replace(/[\W_]+/g,"").toLowerCase());return t.join(this.a)},M.prototype.start=function(){var e=this.c.o.document,t=this,n=u(),r=new Promise((function(r,i){!function o(){u()-n>=t.f?i():e.fonts.load(function(e){return x(e)+" "+e.f+"00 300px "+_(e.c)}(t.a),t.h).then((function(e){1<=e.length?r():setTimeout(o,25)}),(function(){i()}))}()})),i=null,o=new Promise((function(e,n){i=setTimeout(n,t.f)}));Promise.race([o,r]).then((function(){i&&(clearTimeout(i),i=null),t.g(t.a)}),(function(){t.j(t.a)}))};var D={D:"serif",C:"sans-serif"},U=null;function j(){if(null===U){var e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);U=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))}return U}function F(e,t,n){for(var r in D)if(D.hasOwnProperty(r)&&t===e.f[D[r]]&&n===e.f[D[r]])return!0;return!1}function z(e){var t,n=e.g.a.offsetWidth,r=e.h.a.offsetWidth;(t=n===e.f.serif&&r===e.f["sans-serif"])||(t=j()&&F(e,n,r)),t?u()-e.A>=e.w?j()&&F(e,n,r)&&(null===e.u||e.u.hasOwnProperty(e.a.c))?B(e,e.v):B(e,e.B):function(e){setTimeout(a((function(){z(this)}),e),50)}(e):B(e,e.v)}function B(e,t){setTimeout(a((function(){d(this.g.a),d(this.h.a),d(this.j.a),d(this.m.a),t(this.a)}),e),0)}function V(e,t,n){this.c=e,this.a=t,this.f=0,this.m=this.j=!1,this.s=n}L.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=u(),z(this)};var H=null;function W(e){0==--e.f&&e.j&&(e.m?((e=e.a).g&&p(e.f,[e.a.c("wf","active")],[e.a.c("wf","loading"),e.a.c("wf","inactive")]),O(e,"active")):A(e.a))}function G(e){this.j=e,this.a=new P,this.h=0,this.f=this.g=!0}function $(e,t,n,r,i){var o=0==--e.h;(e.f||e.g)&&setTimeout((function(){var e=i||null,u=r||{};if(0===n.length&&o)A(t.a);else{t.f+=n.length,o&&(t.j=o);var l,s=[];for(l=0;l<n.length;l++){var c=n[l],f=u[c.c],d=t.a,h=c;if(d.g&&p(d.f,[d.a.c("wf",h.c,S(h).toString(),"loading")]),O(d,"fontloading",h),d=null,null===H)if(window.FontFace){h=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var m=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);H=h?42<parseInt(h[1],10):!m}else H=!1;d=H?new M(a(t.g,t),a(t.h,t),t.c,c,t.s,f):new L(a(t.g,t),a(t.h,t),t.c,c,t.s,e,f),s.push(d)}for(l=0;l<s.length;l++)s[l].start()}}),0)}function q(e,t){this.c=e,this.a=t}function Y(e,t){this.c=e,this.a=t}function Q(e,t){this.c=e||K,this.a=[],this.f=[],this.g=t||""}V.prototype.g=function(e){var t=this.a;t.g&&p(t.f,[t.a.c("wf",e.c,S(e).toString(),"active")],[t.a.c("wf",e.c,S(e).toString(),"loading"),t.a.c("wf",e.c,S(e).toString(),"inactive")]),O(t,"fontactive",e),this.m=!0,W(this)},V.prototype.h=function(e){var t=this.a;if(t.g){var n=h(t.f,t.a.c("wf",e.c,S(e).toString(),"active")),r=[],i=[t.a.c("wf",e.c,S(e).toString(),"loading")];n||r.push(t.a.c("wf",e.c,S(e).toString(),"inactive")),p(t.f,r,i)}O(t,"fontinactive",e),W(this)},G.prototype.load=function(e){this.c=new l(this.j,e.context||this.j),this.g=!1!==e.events,this.f=!1!==e.classes,function(e,t,n){var r=[],i=n.timeout;!function(e){e.g&&p(e.f,[e.a.c("wf","loading")]),O(e,"loading")}(t);r=function(e,t,n){var r,i=[];for(r in t)if(t.hasOwnProperty(r)){var o=e.c[r];o&&i.push(o(t[r],n))}return i}(e.a,n,e.c);var o=new V(e.c,t,i);for(e.h=r.length,t=0,n=r.length;t<n;t++)r[t].load((function(t,n,r){$(e,o,t,n,r)}))}(this,new C(this.c,e),e)},q.prototype.load=function(e){var t=this,n=t.a.projectId,r=t.a.version;if(n){var i=t.c.o;g(this.c,(t.a.api||"https://fast.fonts.net/jsapi")+"/"+n+".js"+(r?"?v="+r:""),(function(r){r?e([]):(i["__MonotypeConfiguration__"+n]=function(){return t.a},function t(){if(i["__mti_fntLst"+n]){var r,o=i["__mti_fntLst"+n](),a=[];if(o)for(var u=0;u<o.length;u++){var l=o[u].fontfamily;null!=o[u].fontStyle&&null!=o[u].fontWeight?(r=o[u].fontStyle+o[u].fontWeight,a.push(new T(l,r))):a.push(new T(l))}e(a)}else setTimeout((function(){t()}),50)}())})).id="__MonotypeAPIScript__"+n}else e([])},Y.prototype.load=function(e){var t,n,r=this.a.urls||[],i=this.a.families||[],o=this.a.testStrings||{},a=new v;for(t=0,n=r.length;t<n;t++)m(this.c,r[t],y(a));var u=[];for(t=0,n=i.length;t<n;t++)if((r=i[t].split(":"))[1])for(var l=r[1].split(","),s=0;s<l.length;s+=1)u.push(new T(r[0],l[s]));else u.push(new T(r[0]));b(a,(function(){e(u,o)}))};var K="https://fonts.googleapis.com/css";function X(e){this.f=e,this.a=[],this.c={}}var J={latin:"BESbswy","latin-ext":"",cyrillic:"",greek:"",khmer:"",Hanuman:""},Z={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},ee={i:"i",italic:"i",n:"n",normal:"n"},te=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function ne(e,t){this.c=e,this.a=t}var re={Arimo:!0,Cousine:!0,Tinos:!0};function ie(e,t){this.c=e,this.a=t}function oe(e,t){this.c=e,this.f=t,this.a=[]}ne.prototype.load=function(e){var t=new v,n=this.c,r=new Q(this.a.api,this.a.text),i=this.a.families;!function(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r].split(":");3==i.length&&e.f.push(i.pop());var o="";2==i.length&&""!=i[1]&&(o=":"),e.a.push(i.join(o))}}(r,i);var o=new X(i);!function(e){for(var t=e.f.length,n=0;n<t;n++){var r=e.f[n].split(":"),i=r[0].replace(/\+/g," "),o=["n4"];if(2<=r.length){var a;if(a=[],u=r[1])for(var u,l=(u=u.split(",")).length,s=0;s<l;s++){var c;if((c=u[s]).match(/^[\w-]+$/))if(null==(d=te.exec(c.toLowerCase())))c="";else{if(c=null==(c=d[2])||""==c?"n":ee[c],null==(d=d[1])||""==d)d="4";else var f=Z[d],d=f||(isNaN(d)?"4":d.substr(0,1));c=[c,d].join("")}else c="";c&&a.push(c)}0<a.length&&(o=a),3==r.length&&(a=[],0<(r=(r=r[2])?r.split(","):a).length&&(r=J[r[0]])&&(e.c[i]=r))}for(e.c[i]||(r=J[i])&&(e.c[i]=r),r=0;r<o.length;r+=1)e.a.push(new T(i,o[r]))}}(o),m(n,function(e){if(0==e.a.length)throw Error("No fonts to load!");if(-1!=e.c.indexOf("kit="))return e.c;for(var t=e.a.length,n=[],r=0;r<t;r++)n.push(e.a[r].replace(/ /g,"+"));return t=e.c+"?family="+n.join("%7C"),0<e.f.length&&(t+="&subset="+e.f.join(",")),0<e.g.length&&(t+="&text="+encodeURIComponent(e.g)),t}(r),y(t)),b(t,(function(){e(o.a,o.c,re)}))},ie.prototype.load=function(e){var t=this.a.id,n=this.c.o;t?g(this.c,(this.a.api||"https://use.typekit.net")+"/"+t+".js",(function(t){if(t)e([]);else if(n.Typekit&&n.Typekit.config&&n.Typekit.config.fn){t=n.Typekit.config.fn;for(var r=[],i=0;i<t.length;i+=2)for(var o=t[i],a=t[i+1],u=0;u<a.length;u++)r.push(new T(o,a[u]));try{n.Typekit.load({events:!1,classes:!1,async:!0})}catch(e){}e(r)}}),2e3):e([])},oe.prototype.load=function(e){var t=this.f.id,n=this.c.o,r=this;t?(n.__webfontfontdeckmodule__||(n.__webfontfontdeckmodule__={}),n.__webfontfontdeckmodule__[t]=function(t,n){for(var i=0,o=n.fonts.length;i<o;++i){var a=n.fonts[i];r.a.push(new T(a.name,k("font-weight:"+a.weight+";font-style:"+a.style)))}e(r.a)},g(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(e){return e.o.location.hostname||e.a.location.hostname}(this.c)+"/"+t+".js",(function(t){t&&e([])}))):e([])};var ae=new G(window);ae.a.c.custom=function(e,t){return new Y(t,e)},ae.a.c.fontdeck=function(e,t){return new oe(t,e)},ae.a.c.monotype=function(e,t){return new q(t,e)},ae.a.c.typekit=function(e,t){return new ie(t,e)},ae.a.c.google=function(e,t){return new ne(t,e)};var ue={load:a(ae.load,ae)};void 0===(r=function(){return ue}.call(t,n,t,e))||(e.exports=r)}()},function(e,t,n){var r,i,o;i=[t,e],void 0===(o="function"==typeof(r=function(e,t){"use strict";var n=5e3,r="callback";function i(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function o(e){try{delete window[e]}catch(t){window[e]=void 0}}function a(e){var t=document.getElementById(e);t&&document.getElementsByTagName("head")[0].removeChild(t)}t.exports=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],u=e,l=t.timeout||n,s=t.jsonpCallback||r,c=void 0;return new Promise((function(n,r){var f=t.jsonpCallbackFunction||i(),d=s+"_"+f;window[f]=function(e){n({ok:!0,json:function(){return Promise.resolve(e)}}),c&&clearTimeout(c),a(d),o(f)},u+=-1===u.indexOf("?")?"?":"&";var p=document.createElement("script");p.setAttribute("src",""+u+s+"="+f),t.charset&&p.setAttribute("charset",t.charset),p.id=d,document.getElementsByTagName("head")[0].appendChild(p),c=setTimeout((function(){r(new Error("JSONP request to "+e+" timed out")),o(f),a(d),window[f]=function(){o(f)}}),l),p.onerror=function(){r(new Error("JSONP request to "+e+" failed")),o(f),a(d),c&&clearTimeout(c)}}))}})?r.apply(t,i):r)||(e.exports=o)},function(e,t,n){"use strict";
/** @license React v16.13.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(5),i="function"==typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,u=i?Symbol.for("react.fragment"):60107,l=i?Symbol.for("react.strict_mode"):60108,s=i?Symbol.for("react.profiler"):60114,c=i?Symbol.for("react.provider"):60109,f=i?Symbol.for("react.context"):60110,d=i?Symbol.for("react.forward_ref"):60112,p=i?Symbol.for("react.suspense"):60113,h=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116,g="function"==typeof Symbol&&Symbol.iterator;function v(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function w(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||y}function E(){}function T(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||y}w.prototype.isReactComponent={},w.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(v(85));this.updater.enqueueSetState(this,e,t,"setState")},w.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},E.prototype=w.prototype;var _=T.prototype=new E;_.constructor=T,r(_,w.prototype),_.isPureReactComponent=!0;var S={current:null},x=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,n){var r,i={},a=null,u=null;if(null!=t)for(r in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(a=""+t.key),t)x.call(t,r)&&!k.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){for(var s=Array(l),c=0;c<l;c++)s[c]=arguments[c+2];i.children=s}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===i[r]&&(i[r]=l[r]);return{$$typeof:o,type:e,key:a,ref:u,props:i,_owner:S.current}}function A(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var O=/\/+/g,P=[];function N(e,t,n,r){if(P.length){var i=P.pop();return i.result=e,i.keyPrefix=t,i.func=n,i.context=r,i.count=0,i}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function I(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>P.length&&P.push(e)}function R(e,t,n){return null==e?0:function e(t,n,r,i){var u=typeof t;"undefined"!==u&&"boolean"!==u||(t=null);var l=!1;if(null===t)l=!0;else switch(u){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case o:case a:l=!0}}if(l)return r(i,t,""===n?"."+M(t,0):n),1;if(l=0,n=""===n?".":n+":",Array.isArray(t))for(var s=0;s<t.length;s++){var c=n+M(u=t[s],s);l+=e(u,c,r,i)}else if(null===t||"object"!=typeof t?c=null:c="function"==typeof(c=g&&t[g]||t["@@iterator"])?c:null,"function"==typeof c)for(t=c.call(t),s=0;!(u=t.next()).done;)l+=e(u=u.value,c=n+M(u,s++),r,i);else if("object"===u)throw r=""+t,Error(v(31,"[object Object]"===r?"object with keys {"+Object.keys(t).join(", ")+"}":r,""));return l}(e,"",t,n)}function M(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function L(e,t){e.func.call(e.context,t,e.count++)}function D(e,t,n){var r=e.result,i=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?U(e,r,n,(function(e){return e})):null!=e&&(A(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,i+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(O,"$&/")+"/")+n)),r.push(e))}function U(e,t,n,r,i){var o="";null!=n&&(o=(""+n).replace(O,"$&/")+"/"),R(e,D,t=N(t,o,r,i)),I(t)}var j={current:null};function F(){var e=j.current;if(null===e)throw Error(v(321));return e}var z={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:S,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:function(e,t,n){if(null==e)return e;var r=[];return U(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;R(e,L,t=N(null,null,t,n)),I(t)},count:function(e){return R(e,(function(){return null}),null)},toArray:function(e){var t=[];return U(e,t,null,(function(e){return e})),t},only:function(e){if(!A(e))throw Error(v(143));return e}},t.Component=w,t.Fragment=u,t.Profiler=s,t.PureComponent=T,t.StrictMode=l,t.Suspense=p,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,t.cloneElement=function(e,t,n){if(null==e)throw Error(v(267,e));var i=r({},e.props),a=e.key,u=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(u=t.ref,l=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(c in t)x.call(t,c)&&!k.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==s?s[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){s=Array(c);for(var f=0;f<c;f++)s[f]=arguments[f+2];i.children=s}return{$$typeof:o,type:e.type,key:a,ref:u,props:i,_owner:l}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:f,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:c,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:d,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:m,_ctor:e,_status:-1,_result:null}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return F().useCallback(e,t)},t.useContext=function(e,t){return F().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return F().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return F().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return F().useLayoutEffect(e,t)},t.useMemo=function(e,t){return F().useMemo(e,t)},t.useReducer=function(e,t,n){return F().useReducer(e,t,n)},t.useRef=function(e){return F().useRef(e)},t.useState=function(e){return F().useState(e)},t.version="16.13.1"},function(e,t,n){"use strict";
/** @license React v16.13.1
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(0),i=n(5),o=n(24);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(a(227));function u(e,t,n,r,i,o,a,u,l){var s=Array.prototype.slice.call(arguments,3);try{t.apply(n,s)}catch(e){this.onError(e)}}var l=!1,s=null,c=!1,f=null,d={onError:function(e){l=!0,s=e}};function p(e,t,n,r,i,o,a,c,f){l=!1,s=null,u.apply(d,arguments)}var h=null,m=null,g=null;function v(e,t,n){var r=e.type||"unknown-event";e.currentTarget=g(n),function(e,t,n,r,i,o,u,d,h){if(p.apply(this,arguments),l){if(!l)throw Error(a(198));var m=s;l=!1,s=null,c||(c=!0,f=m)}}(r,t,void 0,e),e.currentTarget=null}var y=null,b={};function w(){if(y)for(var e in b){var t=b[e],n=y.indexOf(e);if(!(-1<n))throw Error(a(96,e));if(!T[n]){if(!t.extractEvents)throw Error(a(97,e));for(var r in T[n]=t,n=t.eventTypes){var i=void 0,o=n[r],u=t,l=r;if(_.hasOwnProperty(l))throw Error(a(99,l));_[l]=o;var s=o.phasedRegistrationNames;if(s){for(i in s)s.hasOwnProperty(i)&&E(s[i],u,l);i=!0}else o.registrationName?(E(o.registrationName,u,l),i=!0):i=!1;if(!i)throw Error(a(98,r,e))}}}}function E(e,t,n){if(S[e])throw Error(a(100,e));S[e]=t,x[e]=t.eventTypes[n].dependencies}var T=[],_={},S={},x={};function k(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];if(!b.hasOwnProperty(t)||b[t]!==r){if(b[t])throw Error(a(102,t));b[t]=r,n=!0}}n&&w()}var C=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),A=null,O=null,P=null;function N(e){if(e=m(e)){if("function"!=typeof A)throw Error(a(280));var t=e.stateNode;t&&(t=h(t),A(e.stateNode,e.type,t))}}function I(e){O?P?P.push(e):P=[e]:O=e}function R(){if(O){var e=O,t=P;if(P=O=null,N(e),t)for(e=0;e<t.length;e++)N(t[e])}}function M(e,t){return e(t)}function L(e,t,n,r,i){return e(t,n,r,i)}function D(){}var U=M,j=!1,F=!1;function z(){null===O&&null===P||(D(),R())}function B(e,t,n){if(F)return e(t,n);F=!0;try{return U(e,t,n)}finally{F=!1,z()}}var V=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,H=Object.prototype.hasOwnProperty,W={},G={};function $(e,t,n,r,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o}var q={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){q[e]=new $(e,0,!1,e,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];q[t]=new $(t,1,!1,e[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){q[e]=new $(e,2,!1,e.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){q[e]=new $(e,2,!1,e,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){q[e]=new $(e,3,!1,e.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(e){q[e]=new $(e,3,!0,e,null,!1)})),["capture","download"].forEach((function(e){q[e]=new $(e,4,!1,e,null,!1)})),["cols","rows","size","span"].forEach((function(e){q[e]=new $(e,6,!1,e,null,!1)})),["rowSpan","start"].forEach((function(e){q[e]=new $(e,5,!1,e.toLowerCase(),null,!1)}));var Y=/[\-:]([a-z])/g;function Q(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(Y,Q);q[t]=new $(t,1,!1,e,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(Y,Q);q[t]=new $(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(Y,Q);q[t]=new $(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(e){q[e]=new $(e,1,!1,e.toLowerCase(),null,!1)})),q.xlinkHref=new $("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(e){q[e]=new $(e,1,!1,e.toLowerCase(),null,!0)}));var K=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function X(e,t,n,r){var i=q.hasOwnProperty(t)?q[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!H.call(G,e)||!H.call(W,e)&&(V.test(e)?G[e]=!0:(W[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}K.hasOwnProperty("ReactCurrentDispatcher")||(K.ReactCurrentDispatcher={current:null}),K.hasOwnProperty("ReactCurrentBatchConfig")||(K.ReactCurrentBatchConfig={suspense:null});var J=/^(.*)[\\\/]/,Z="function"==typeof Symbol&&Symbol.for,ee=Z?Symbol.for("react.element"):60103,te=Z?Symbol.for("react.portal"):60106,ne=Z?Symbol.for("react.fragment"):60107,re=Z?Symbol.for("react.strict_mode"):60108,ie=Z?Symbol.for("react.profiler"):60114,oe=Z?Symbol.for("react.provider"):60109,ae=Z?Symbol.for("react.context"):60110,ue=Z?Symbol.for("react.concurrent_mode"):60111,le=Z?Symbol.for("react.forward_ref"):60112,se=Z?Symbol.for("react.suspense"):60113,ce=Z?Symbol.for("react.suspense_list"):60120,fe=Z?Symbol.for("react.memo"):60115,de=Z?Symbol.for("react.lazy"):60116,pe=Z?Symbol.for("react.block"):60121,he="function"==typeof Symbol&&Symbol.iterator;function me(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=he&&e[he]||e["@@iterator"])?e:null}function ge(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case ne:return"Fragment";case te:return"Portal";case ie:return"Profiler";case re:return"StrictMode";case se:return"Suspense";case ce:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case ae:return"Context.Consumer";case oe:return"Context.Provider";case le:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case fe:return ge(e.type);case pe:return ge(e.render);case de:if(e=1===e._status?e._result:null)return ge(e)}return null}function ve(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break e;default:var r=e._debugOwner,i=e._debugSource,o=ge(e.type);n=null,r&&(n=ge(r.type)),r=o,o="",i?o=" (at "+i.fileName.replace(J,"")+":"+i.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+o}t+=n,e=e.return}while(e);return t}function ye(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function be(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function we(e){e._valueTracker||(e._valueTracker=function(e){var t=be(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Ee(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=be(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Te(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function _e(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=ye(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Se(e,t){null!=(t=t.checked)&&X(e,"checked",t,!1)}function xe(e,t){Se(e,t);var n=ye(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Ce(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ce(e,t.type,ye(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function ke(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Ce(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function Ae(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function Oe(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ye(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function Pe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ne(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:ye(n)}}function Ie(e,t){var n=ye(t.value),r=ye(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function Re(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var Me="http://www.w3.org/1999/xhtml",Le="http://www.w3.org/2000/svg";function De(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?De(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var je,Fe=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction((function(){return e(t,n)}))}:e}((function(e,t){if(e.namespaceURI!==Le||"innerHTML"in e)e.innerHTML=t;else{for((je=je||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=je.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}));function ze(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}function Be(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ve={animationend:Be("Animation","AnimationEnd"),animationiteration:Be("Animation","AnimationIteration"),animationstart:Be("Animation","AnimationStart"),transitionend:Be("Transition","TransitionEnd")},He={},We={};function Ge(e){if(He[e])return He[e];if(!Ve[e])return e;var t,n=Ve[e];for(t in n)if(n.hasOwnProperty(t)&&t in We)return He[e]=n[t];return e}C&&(We=document.createElement("div").style,"AnimationEvent"in window||(delete Ve.animationend.animation,delete Ve.animationiteration.animation,delete Ve.animationstart.animation),"TransitionEvent"in window||delete Ve.transitionend.transition);var $e=Ge("animationend"),qe=Ge("animationiteration"),Ye=Ge("animationstart"),Qe=Ge("transitionend"),Ke="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xe=new("function"==typeof WeakMap?WeakMap:Map);function Je(e){var t=Xe.get(e);return void 0===t&&(t=new Map,Xe.set(e,t)),t}function Ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).effectTag)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function et(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function tt(e){if(Ze(e)!==e)throw Error(a(188))}function nt(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ze(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return tt(i),e;if(o===r)return tt(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var u=!1,l=i.child;l;){if(l===n){u=!0,n=i,r=o;break}if(l===r){u=!0,r=i,n=o;break}l=l.sibling}if(!u){for(l=o.child;l;){if(l===n){u=!0,n=o,r=i;break}if(l===r){u=!0,r=o,n=i;break}l=l.sibling}if(!u)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function rt(e,t){if(null==t)throw Error(a(30));return null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function it(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}var ot=null;function at(e){if(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t))for(var r=0;r<t.length&&!e.isPropagationStopped();r++)v(e,t[r],n[r]);else t&&v(e,t,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function ut(e){if(null!==e&&(ot=rt(ot,e)),e=ot,ot=null,e){if(it(e,at),ot)throw Error(a(95));if(c)throw e=f,c=!1,f=null,e}}function lt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function st(e){if(!C)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"==typeof t[e]),t}var ct=[];function ft(e){e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>ct.length&&ct.push(e)}function dt(e,t,n,r){if(ct.length){var i=ct.pop();return i.topLevelType=e,i.eventSystemFlags=r,i.nativeEvent=t,i.targetInst=n,i}return{topLevelType:e,eventSystemFlags:r,nativeEvent:t,targetInst:n,ancestors:[]}}function pt(e){var t=e.targetInst,n=t;do{if(!n){e.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(t=n.tag)&&6!==t||e.ancestors.push(n),n=Cn(r)}while(n);for(n=0;n<e.ancestors.length;n++){t=e.ancestors[n];var i=lt(e.nativeEvent);r=e.topLevelType;var o=e.nativeEvent,a=e.eventSystemFlags;0===n&&(a|=64);for(var u=null,l=0;l<T.length;l++){var s=T[l];s&&(s=s.extractEvents(r,t,o,i,a))&&(u=rt(u,s))}ut(u)}}function ht(e,t,n){if(!n.has(e)){switch(e){case"scroll":Yt(t,"scroll",!0);break;case"focus":case"blur":Yt(t,"focus",!0),Yt(t,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":st(e)&&Yt(t,e,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Ke.indexOf(e)&&qt(e,t)}n.set(e,null)}}var mt,gt,vt,yt=!1,bt=[],wt=null,Et=null,Tt=null,_t=new Map,St=new Map,xt=[],kt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Ct="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function At(e,t,n,r,i){return{blockedOn:e,topLevelType:t,eventSystemFlags:32|n,nativeEvent:i,container:r}}function Ot(e,t){switch(e){case"focus":case"blur":wt=null;break;case"dragenter":case"dragleave":Et=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":_t.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":St.delete(t.pointerId)}}function Pt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e=At(t,n,r,i,o),null!==t&&(null!==(t=An(t))&&gt(t)),e):(e.eventSystemFlags|=r,e)}function Nt(e){var t=Cn(e.target);if(null!==t){var n=Ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=et(n)))return e.blockedOn=t,void o.unstable_runWithPriority(e.priority,(function(){vt(n)}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function It(e){if(null!==e.blockedOn)return!1;var t=Jt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);if(null!==t){var n=An(t);return null!==n&&gt(n),e.blockedOn=t,!1}return!0}function Rt(e,t,n){It(e)&&n.delete(t)}function Mt(){for(yt=!1;0<bt.length;){var e=bt[0];if(null!==e.blockedOn){null!==(e=An(e.blockedOn))&&mt(e);break}var t=Jt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);null!==t?e.blockedOn=t:bt.shift()}null!==wt&&It(wt)&&(wt=null),null!==Et&&It(Et)&&(Et=null),null!==Tt&&It(Tt)&&(Tt=null),_t.forEach(Rt),St.forEach(Rt)}function Lt(e,t){e.blockedOn===t&&(e.blockedOn=null,yt||(yt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Mt)))}function Dt(e){function t(t){return Lt(t,e)}if(0<bt.length){Lt(bt[0],e);for(var n=1;n<bt.length;n++){var r=bt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==wt&&Lt(wt,e),null!==Et&&Lt(Et,e),null!==Tt&&Lt(Tt,e),_t.forEach(t),St.forEach(t),n=0;n<xt.length;n++)(r=xt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<xt.length&&null===(n=xt[0]).blockedOn;)Nt(n),null===n.blockedOn&&xt.shift()}var Ut={},jt=new Map,Ft=new Map,zt=["abort","abort",$e,"animationEnd",qe,"animationIteration",Ye,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Qe,"transitionEnd","waiting","waiting"];function Bt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1],o="on"+(i[0].toUpperCase()+i.slice(1));o={phasedRegistrationNames:{bubbled:o,captured:o+"Capture"},dependencies:[r],eventPriority:t},Ft.set(r,t),jt.set(r,o),Ut[i]=o}}Bt("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Bt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Bt(zt,2);for(var Vt="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Ht=0;Ht<Vt.length;Ht++)Ft.set(Vt[Ht],0);var Wt=o.unstable_UserBlockingPriority,Gt=o.unstable_runWithPriority,$t=!0;function qt(e,t){Yt(t,e,!1)}function Yt(e,t,n){var r=Ft.get(t);switch(void 0===r?2:r){case 0:r=Qt.bind(null,t,1,e);break;case 1:r=Kt.bind(null,t,1,e);break;default:r=Xt.bind(null,t,1,e)}n?e.addEventListener(t,r,!0):e.addEventListener(t,r,!1)}function Qt(e,t,n,r){j||D();var i=Xt,o=j;j=!0;try{L(i,e,t,n,r)}finally{(j=o)||z()}}function Kt(e,t,n,r){Gt(Wt,Xt.bind(null,e,t,n,r))}function Xt(e,t,n,r){if($t)if(0<bt.length&&-1<kt.indexOf(e))e=At(null,e,t,n,r),bt.push(e);else{var i=Jt(e,t,n,r);if(null===i)Ot(e,r);else if(-1<kt.indexOf(e))e=At(i,e,t,n,r),bt.push(e);else if(!function(e,t,n,r,i){switch(t){case"focus":return wt=Pt(wt,e,t,n,r,i),!0;case"dragenter":return Et=Pt(Et,e,t,n,r,i),!0;case"mouseover":return Tt=Pt(Tt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return _t.set(o,Pt(_t.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,St.set(o,Pt(St.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r)){Ot(e,r),e=dt(e,r,null,t);try{B(pt,e)}finally{ft(e)}}}}function Jt(e,t,n,r){if(null!==(n=Cn(n=lt(r)))){var i=Ze(n);if(null===i)n=null;else{var o=i.tag;if(13===o){if(null!==(n=et(i)))return n;n=null}else if(3===o){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}e=dt(e,r,n,t);try{B(pt,e)}finally{ft(e)}return null}var Zt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},en=["Webkit","ms","Moz","O"];function tn(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||Zt.hasOwnProperty(e)&&Zt[e]?(""+t).trim():t+"px"}function nn(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=tn(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(Zt).forEach((function(e){en.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zt[t]=Zt[e]}))}));var rn=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function on(e,t){if(t){if(rn[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e,""));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62,""))}}function an(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var un=Me;function ln(e,t){var n=Je(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=x[t];for(var r=0;r<t.length;r++)ht(t[r],e,n)}function sn(){}function cn(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function fn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dn(e,t){var n,r=fn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=fn(r)}}function pn(){for(var e=window,t=cn();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=cn((e=t.contentWindow).document)}return t}function hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var mn=null,gn=null;function vn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function yn(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var bn="function"==typeof setTimeout?setTimeout:void 0,wn="function"==typeof clearTimeout?clearTimeout:void 0;function En(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Tn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var _n=Math.random().toString(36).slice(2),Sn="__reactInternalInstance$"+_n,xn="__reactEventHandlers$"+_n,kn="__reactContainere$"+_n;function Cn(e){var t=e[Sn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[kn]||n[Sn]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Tn(e);null!==e;){if(n=e[Sn])return n;e=Tn(e)}return t}n=(e=n).parentNode}return null}function An(e){return!(e=e[Sn]||e[kn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function On(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function Pn(e){return e[xn]||null}function Nn(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function In(e,t){var n=e.stateNode;if(!n)return null;var r=h(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}function Rn(e,t,n){(t=In(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=rt(n._dispatchListeners,t),n._dispatchInstances=rt(n._dispatchInstances,e))}function Mn(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,n=[];t;)n.push(t),t=Nn(t);for(t=n.length;0<t--;)Rn(n[t],"captured",e);for(t=0;t<n.length;t++)Rn(n[t],"bubbled",e)}}function Ln(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=In(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=rt(n._dispatchListeners,t),n._dispatchInstances=rt(n._dispatchInstances,e))}function Dn(e){e&&e.dispatchConfig.registrationName&&Ln(e._targetInst,null,e)}function Un(e){it(e,Mn)}var jn=null,Fn=null,zn=null;function Bn(){if(zn)return zn;var e,t,n=Fn,r=n.length,i="value"in jn?jn.value:jn.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return zn=i.slice(e,1<t?1-t:void 0)}function Vn(){return!0}function Hn(){return!1}function Wn(e,t,n,r){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Vn:Hn,this.isPropagationStopped=Hn,this}function Gn(e,t,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,n,r),i}return new this(e,t,n,r)}function $n(e){if(!(e instanceof this))throw Error(a(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function qn(e){e.eventPool=[],e.getPooled=Gn,e.release=$n}i(Wn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Vn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Vn)},persist:function(){this.isPersistent=Vn},isPersistent:Hn,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Hn,this._dispatchInstances=this._dispatchListeners=null}}),Wn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Wn.extend=function(e){function t(){}function n(){return r.apply(this,arguments)}var r=this;t.prototype=r.prototype;var o=new t;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,e),n.extend=r.extend,qn(n),n},qn(Wn);var Yn=Wn.extend({data:null}),Qn=Wn.extend({data:null}),Kn=[9,13,27,32],Xn=C&&"CompositionEvent"in window,Jn=null;C&&"documentMode"in document&&(Jn=document.documentMode);var Zn=C&&"TextEvent"in window&&!Jn,er=C&&(!Xn||Jn&&8<Jn&&11>=Jn),tr=String.fromCharCode(32),nr={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},rr=!1;function ir(e,t){switch(e){case"keyup":return-1!==Kn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function or(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var ar=!1;var ur={eventTypes:nr,extractEvents:function(e,t,n,r){var i;if(Xn)e:{switch(e){case"compositionstart":var o=nr.compositionStart;break e;case"compositionend":o=nr.compositionEnd;break e;case"compositionupdate":o=nr.compositionUpdate;break e}o=void 0}else ar?ir(e,n)&&(o=nr.compositionEnd):"keydown"===e&&229===n.keyCode&&(o=nr.compositionStart);return o?(er&&"ko"!==n.locale&&(ar||o!==nr.compositionStart?o===nr.compositionEnd&&ar&&(i=Bn()):(Fn="value"in(jn=r)?jn.value:jn.textContent,ar=!0)),o=Yn.getPooled(o,t,n,r),i?o.data=i:null!==(i=or(n))&&(o.data=i),Un(o),i=o):i=null,(e=Zn?function(e,t){switch(e){case"compositionend":return or(t);case"keypress":return 32!==t.which?null:(rr=!0,tr);case"textInput":return(e=t.data)===tr&&rr?null:e;default:return null}}(e,n):function(e,t){if(ar)return"compositionend"===e||!Xn&&ir(e,t)?(e=Bn(),zn=Fn=jn=null,ar=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return er&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))?((t=Qn.getPooled(nr.beforeInput,t,n,r)).data=e,Un(t)):t=null,null===i?t:null===t?i:[i,t]}},lr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!lr[e.type]:"textarea"===t}var cr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function fr(e,t,n){return(e=Wn.getPooled(cr.change,e,t,n)).type="change",I(n),Un(e),e}var dr=null,pr=null;function hr(e){ut(e)}function mr(e){if(Ee(On(e)))return e}function gr(e,t){if("change"===e)return t}var vr=!1;function yr(){dr&&(dr.detachEvent("onpropertychange",br),pr=dr=null)}function br(e){if("value"===e.propertyName&&mr(pr))if(e=fr(pr,e,lt(e)),j)ut(e);else{j=!0;try{M(hr,e)}finally{j=!1,z()}}}function wr(e,t,n){"focus"===e?(yr(),pr=n,(dr=t).attachEvent("onpropertychange",br)):"blur"===e&&yr()}function Er(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return mr(pr)}function Tr(e,t){if("click"===e)return mr(t)}function _r(e,t){if("input"===e||"change"===e)return mr(t)}C&&(vr=st("input")&&(!document.documentMode||9<document.documentMode));var Sr={eventTypes:cr,_isInputEventSupported:vr,extractEvents:function(e,t,n,r){var i=t?On(t):window,o=i.nodeName&&i.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===i.type)var a=gr;else if(sr(i))if(vr)a=_r;else{a=Er;var u=wr}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(a=Tr);if(a&&(a=a(e,t)))return fr(a,n,r);u&&u(e,i,t),"blur"===e&&(e=i._wrapperState)&&e.controlled&&"number"===i.type&&Ce(i,"number",i.value)}},xr=Wn.extend({view:null,detail:null}),kr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kr[e])&&!!t[e]}function Ar(){return Cr}var Or=0,Pr=0,Nr=!1,Ir=!1,Rr=xr.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Ar,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=Or;return Or=e.screenX,Nr?"mousemove"===e.type?e.screenX-t:0:(Nr=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=Pr;return Pr=e.screenY,Ir?"mousemove"===e.type?e.screenY-t:0:(Ir=!0,0)}}),Mr=Rr.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Lr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Dr={eventTypes:Lr,extractEvents:function(e,t,n,r,i){var o="mouseover"===e||"pointerover"===e,a="mouseout"===e||"pointerout"===e;if(o&&0==(32&i)&&(n.relatedTarget||n.fromElement)||!a&&!o)return null;(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,a)?(a=t,null!==(t=(t=n.relatedTarget||n.toElement)?Cn(t):null)&&(t!==Ze(t)||5!==t.tag&&6!==t.tag)&&(t=null)):a=null;if(a===t)return null;if("mouseout"===e||"mouseover"===e)var u=Rr,l=Lr.mouseLeave,s=Lr.mouseEnter,c="mouse";else"pointerout"!==e&&"pointerover"!==e||(u=Mr,l=Lr.pointerLeave,s=Lr.pointerEnter,c="pointer");if(e=null==a?o:On(a),o=null==t?o:On(t),(l=u.getPooled(l,a,n,r)).type=c+"leave",l.target=e,l.relatedTarget=o,(n=u.getPooled(s,t,n,r)).type=c+"enter",n.target=o,n.relatedTarget=e,c=t,(r=a)&&c)e:{for(s=c,a=0,e=u=r;e;e=Nn(e))a++;for(e=0,t=s;t;t=Nn(t))e++;for(;0<a-e;)u=Nn(u),a--;for(;0<e-a;)s=Nn(s),e--;for(;a--;){if(u===s||u===s.alternate)break e;u=Nn(u),s=Nn(s)}u=null}else u=null;for(s=u,u=[];r&&r!==s&&(null===(a=r.alternate)||a!==s);)u.push(r),r=Nn(r);for(r=[];c&&c!==s&&(null===(a=c.alternate)||a!==s);)r.push(c),c=Nn(c);for(c=0;c<u.length;c++)Ln(u[c],"bubbled",l);for(c=r.length;0<c--;)Ln(r[c],"captured",n);return 0==(64&i)?[l]:[l,n]}};var Ur="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},jr=Object.prototype.hasOwnProperty;function Fr(e,t){if(Ur(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!jr.call(t,n[r])||!Ur(e[n[r]],t[n[r]]))return!1;return!0}var zr=C&&"documentMode"in document&&11>=document.documentMode,Br={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Vr=null,Hr=null,Wr=null,Gr=!1;function $r(e,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return Gr||null==Vr||Vr!==cn(n)?null:("selectionStart"in(n=Vr)&&hn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Wr&&Fr(Wr,n)?null:(Wr=n,(e=Wn.getPooled(Br.select,Hr,e,t)).type="select",e.target=Vr,Un(e),e))}var qr={eventTypes:Br,extractEvents:function(e,t,n,r,i,o){if(!(o=!(i=o||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument)))){e:{i=Je(i),o=x.onSelect;for(var a=0;a<o.length;a++)if(!i.has(o[a])){i=!1;break e}i=!0}o=!i}if(o)return null;switch(i=t?On(t):window,e){case"focus":(sr(i)||"true"===i.contentEditable)&&(Vr=i,Hr=t,Wr=null);break;case"blur":Wr=Hr=Vr=null;break;case"mousedown":Gr=!0;break;case"contextmenu":case"mouseup":case"dragend":return Gr=!1,$r(n,r);case"selectionchange":if(zr)break;case"keydown":case"keyup":return $r(n,r)}return null}},Yr=Wn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Qr=Wn.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Kr=xr.extend({relatedTarget:null});function Xr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var Jr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ei=xr.extend({key:function(e){if(e.key){var t=Jr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Xr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Zr[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Ar,charCode:function(e){return"keypress"===e.type?Xr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Xr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),ti=Rr.extend({dataTransfer:null}),ni=xr.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Ar}),ri=Wn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),ii=Rr.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),oi={eventTypes:Ut,extractEvents:function(e,t,n,r){var i=jt.get(e);if(!i)return null;switch(e){case"keypress":if(0===Xr(n))return null;case"keydown":case"keyup":e=ei;break;case"blur":case"focus":e=Kr;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=Rr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=ti;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=ni;break;case $e:case qe:case Ye:e=Yr;break;case Qe:e=ri;break;case"scroll":e=xr;break;case"wheel":e=ii;break;case"copy":case"cut":case"paste":e=Qr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=Mr;break;default:e=Wn}return Un(t=e.getPooled(i,t,n,r)),t}};if(y)throw Error(a(101));y=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),w(),h=Pn,m=An,g=On,k({SimpleEventPlugin:oi,EnterLeaveEventPlugin:Dr,ChangeEventPlugin:Sr,SelectEventPlugin:qr,BeforeInputEventPlugin:ur});var ai=[],ui=-1;function li(e){0>ui||(e.current=ai[ui],ai[ui]=null,ui--)}function si(e,t){ui++,ai[ui]=e.current,e.current=t}var ci={},fi={current:ci},di={current:!1},pi=ci;function hi(e,t){var n=e.type.contextTypes;if(!n)return ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function mi(e){return null!=(e=e.childContextTypes)}function gi(){li(di),li(fi)}function vi(e,t,n){if(fi.current!==ci)throw Error(a(168));si(fi,t),si(di,n)}function yi(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(a(108,ge(t)||"Unknown",o));return i({},n,{},r)}function bi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ci,pi=fi.current,si(fi,e),si(di,di.current),!0}function wi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=yi(e,t,pi),r.__reactInternalMemoizedMergedChildContext=e,li(di),li(fi),si(fi,e)):li(di),si(di,n)}var Ei=o.unstable_runWithPriority,Ti=o.unstable_scheduleCallback,_i=o.unstable_cancelCallback,Si=o.unstable_requestPaint,xi=o.unstable_now,ki=o.unstable_getCurrentPriorityLevel,Ci=o.unstable_ImmediatePriority,Ai=o.unstable_UserBlockingPriority,Oi=o.unstable_NormalPriority,Pi=o.unstable_LowPriority,Ni=o.unstable_IdlePriority,Ii={},Ri=o.unstable_shouldYield,Mi=void 0!==Si?Si:function(){},Li=null,Di=null,Ui=!1,ji=xi(),Fi=1e4>ji?xi:function(){return xi()-ji};function zi(){switch(ki()){case Ci:return 99;case Ai:return 98;case Oi:return 97;case Pi:return 96;case Ni:return 95;default:throw Error(a(332))}}function Bi(e){switch(e){case 99:return Ci;case 98:return Ai;case 97:return Oi;case 96:return Pi;case 95:return Ni;default:throw Error(a(332))}}function Vi(e,t){return e=Bi(e),Ei(e,t)}function Hi(e,t,n){return e=Bi(e),Ti(e,t,n)}function Wi(e){return null===Li?(Li=[e],Di=Ti(Ci,$i)):Li.push(e),Ii}function Gi(){if(null!==Di){var e=Di;Di=null,_i(e)}$i()}function $i(){if(!Ui&&null!==Li){Ui=!0;var e=0;try{var t=Li;Vi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Li=null}catch(t){throw null!==Li&&(Li=Li.slice(e+1)),Ti(Ci,Gi),t}finally{Ui=!1}}}function qi(e,t,n){return 1073741821-(1+((1073741821-e+t/10)/(n/=10)|0))*n}function Yi(e,t){if(e&&e.defaultProps)for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}var Qi={current:null},Ki=null,Xi=null,Ji=null;function Zi(){Ji=Xi=Ki=null}function eo(e){var t=Qi.current;li(Qi),e.type._context._currentValue=t}function to(e,t){for(;null!==e;){var n=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t);else{if(!(null!==n&&n.childExpirationTime<t))break;n.childExpirationTime=t}e=e.return}}function no(e,t){Ki=e,Ji=Xi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.expirationTime>=t&&(Pa=!0),e.firstContext=null)}function ro(e,t){if(Ji!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(Ji=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Xi){if(null===Ki)throw Error(a(308));Xi=t,Ki.dependencies={expirationTime:0,firstContext:t,responders:null}}else Xi=Xi.next=t;return e._currentValue}var io=!1;function oo(e){e.updateQueue={baseState:e.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function ao(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,baseQueue:e.baseQueue,shared:e.shared,effects:e.effects})}function uo(e,t){return(e={expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null}).next=e}function lo(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function so(e,t){var n=e.alternate;null!==n&&ao(n,e),null===(n=(e=e.updateQueue).baseQueue)?(e.baseQueue=t.next=t,t.next=t):(t.next=n.next,n.next=t)}function co(e,t,n,r){var o=e.updateQueue;io=!1;var a=o.baseQueue,u=o.shared.pending;if(null!==u){if(null!==a){var l=a.next;a.next=u.next,u.next=l}a=u,o.shared.pending=null,null!==(l=e.alternate)&&(null!==(l=l.updateQueue)&&(l.baseQueue=u))}if(null!==a){l=a.next;var s=o.baseState,c=0,f=null,d=null,p=null;if(null!==l)for(var h=l;;){if((u=h.expirationTime)<r){var m={expirationTime:h.expirationTime,suspenseConfig:h.suspenseConfig,tag:h.tag,payload:h.payload,callback:h.callback,next:null};null===p?(d=p=m,f=s):p=p.next=m,u>c&&(c=u)}else{null!==p&&(p=p.next={expirationTime:1073741823,suspenseConfig:h.suspenseConfig,tag:h.tag,payload:h.payload,callback:h.callback,next:null}),ol(u,h.suspenseConfig);e:{var g=e,v=h;switch(u=t,m=n,v.tag){case 1:if("function"==typeof(g=v.payload)){s=g.call(m,s,u);break e}s=g;break e;case 3:g.effectTag=-4097&g.effectTag|64;case 0:if(null==(u="function"==typeof(g=v.payload)?g.call(m,s,u):g))break e;s=i({},s,u);break e;case 2:io=!0}}null!==h.callback&&(e.effectTag|=32,null===(u=o.effects)?o.effects=[h]:u.push(h))}if(null===(h=h.next)||h===l){if(null===(u=o.shared.pending))break;h=a.next=u.next,u.next=l,o.baseQueue=a=u,o.shared.pending=null}}null===p?f=s:p.next=d,o.baseState=f,o.baseQueue=p,al(c),e.expirationTime=c,e.memoizedState=s}}function fo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=i,i=n,"function"!=typeof r)throw Error(a(191,r));r.call(i)}}}var po=K.ReactCurrentBatchConfig,ho=(new r.Component).refs;function mo(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:i({},t,n),e.memoizedState=n,0===e.expirationTime&&(e.updateQueue.baseState=n)}var go={isMounted:function(e){return!!(e=e._reactInternalFiber)&&Ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternalFiber;var r=$u(),i=po.suspense;(i=uo(r=qu(r,e,i),i)).payload=t,null!=n&&(i.callback=n),lo(e,i),Yu(e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternalFiber;var r=$u(),i=po.suspense;(i=uo(r=qu(r,e,i),i)).tag=1,i.payload=t,null!=n&&(i.callback=n),lo(e,i),Yu(e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var n=$u(),r=po.suspense;(r=uo(n=qu(n,e,r),r)).tag=2,null!=t&&(r.callback=t),lo(e,r),Yu(e,n)}};function vo(e,t,n,r,i,o,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!Fr(n,r)||!Fr(i,o))}function yo(e,t,n){var r=!1,i=ci,o=t.contextType;return"object"==typeof o&&null!==o?o=ro(o):(i=mi(t)?pi:fi.current,o=(r=null!=(r=t.contextTypes))?hi(e,i):ci),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=go,e.stateNode=t,t._reactInternalFiber=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function bo(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&go.enqueueReplaceState(t,t.state,null)}function wo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=ho,oo(e);var o=t.contextType;"object"==typeof o&&null!==o?i.context=ro(o):(o=mi(t)?pi:fi.current,i.context=hi(e,o)),co(e,n,i,r),i.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(mo(e,t,o,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&go.enqueueReplaceState(i,i.state,null),co(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.effectTag|=4)}var Eo=Array.isArray;function To(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=r.refs;t===ho&&(t=r.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}if("string"!=typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function _o(e,t){if("textarea"!==e.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,""))}function So(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=kl(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.effectTag=2,n):r:(t.effectTag=2,n):n}function u(t){return e&&null===t.alternate&&(t.effectTag=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Ol(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function s(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=To(e,t,n),r.return=e,r):((r=Cl(n.type,n.key,n.props,null,e.mode,r)).ref=To(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Pl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function f(e,t,n,r,o){return null===t||7!==t.tag?((t=Al(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Ol(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case ee:return(n=Cl(t.type,t.key,t.props,null,e.mode,n)).ref=To(e,null,t),n.return=e,n;case te:return(t=Pl(t,e.mode,n)).return=e,t}if(Eo(t)||me(t))return(t=Al(t,e.mode,n,null)).return=e,t;_o(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case ee:return n.key===i?n.type===ne?f(e,t,n.props.children,r,i):s(e,t,n,r):null;case te:return n.key===i?c(e,t,n,r):null}if(Eo(n)||me(n))return null!==i?null:f(e,t,n,r,null);_o(e,n)}return null}function h(e,t,n,r,i){if("string"==typeof r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case ee:return e=e.get(null===r.key?n:r.key)||null,r.type===ne?f(t,e,r.props.children,i,r.key):s(t,e,r,i);case te:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(Eo(r)||me(r))return f(t,e=e.get(n)||null,r,i,null);_o(t,r)}return null}function m(i,a,u,l){for(var s=null,c=null,f=a,m=a=0,g=null;null!==f&&m<u.length;m++){f.index>m?(g=f,f=null):g=f.sibling;var v=p(i,f,u[m],l);if(null===v){null===f&&(f=g);break}e&&f&&null===v.alternate&&t(i,f),a=o(v,a,m),null===c?s=v:c.sibling=v,c=v,f=g}if(m===u.length)return n(i,f),s;if(null===f){for(;m<u.length;m++)null!==(f=d(i,u[m],l))&&(a=o(f,a,m),null===c?s=f:c.sibling=f,c=f);return s}for(f=r(i,f);m<u.length;m++)null!==(g=h(f,i,m,u[m],l))&&(e&&null!==g.alternate&&f.delete(null===g.key?m:g.key),a=o(g,a,m),null===c?s=g:c.sibling=g,c=g);return e&&f.forEach((function(e){return t(i,e)})),s}function g(i,u,l,s){var c=me(l);if("function"!=typeof c)throw Error(a(150));if(null==(l=c.call(l)))throw Error(a(151));for(var f=c=null,m=u,g=u=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(i,m,y.value,s);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),u=o(b,u,g),null===f?c=b:f.sibling=b,f=b,m=v}if(y.done)return n(i,m),c;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(i,y.value,s))&&(u=o(y,u,g),null===f?c=y:f.sibling=y,f=y);return c}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=h(m,i,g,y.value,s))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),u=o(y,u,g),null===f?c=y:f.sibling=y,f=y);return e&&m.forEach((function(e){return t(i,e)})),c}return function(e,r,o,l){var s="object"==typeof o&&null!==o&&o.type===ne&&null===o.key;s&&(o=o.props.children);var c="object"==typeof o&&null!==o;if(c)switch(o.$$typeof){case ee:e:{for(c=o.key,s=r;null!==s;){if(s.key===c){switch(s.tag){case 7:if(o.type===ne){n(e,s.sibling),(r=i(s,o.props.children)).return=e,e=r;break e}break;default:if(s.elementType===o.type){n(e,s.sibling),(r=i(s,o.props)).ref=To(e,s,o),r.return=e,e=r;break e}}n(e,s);break}t(e,s),s=s.sibling}o.type===ne?((r=Al(o.props.children,e.mode,l,o.key)).return=e,e=r):((l=Cl(o.type,o.key,o.props,null,e.mode,l)).ref=To(e,r,o),l.return=e,e=l)}return u(e);case te:e:{for(s=o.key;null!==r;){if(r.key===s){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=i(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Pl(o,e.mode,l)).return=e,e=r}return u(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,o)).return=e,e=r):(n(e,r),(r=Ol(o,e.mode,l)).return=e,e=r),u(e);if(Eo(o))return m(e,r,o,l);if(me(o))return g(e,r,o,l);if(c&&_o(e,o),void 0===o&&!s)switch(e.tag){case 1:case 0:throw e=e.type,Error(a(152,e.displayName||e.name||"Component"))}return n(e,r)}}var xo=So(!0),ko=So(!1),Co={},Ao={current:Co},Oo={current:Co},Po={current:Co};function No(e){if(e===Co)throw Error(a(174));return e}function Io(e,t){switch(si(Po,t),si(Oo,e),si(Ao,Co),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ue(null,"");break;default:t=Ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}li(Ao),si(Ao,t)}function Ro(){li(Ao),li(Oo),li(Po)}function Mo(e){No(Po.current);var t=No(Ao.current),n=Ue(t,e.type);t!==n&&(si(Oo,e),si(Ao,n))}function Lo(e){Oo.current===e&&(li(Ao),li(Oo))}var Do={current:0};function Uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.effectTag))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function jo(e,t){return{responder:e,props:t}}var Fo=K.ReactCurrentDispatcher,zo=K.ReactCurrentBatchConfig,Bo=0,Vo=null,Ho=null,Wo=null,Go=!1;function $o(){throw Error(a(321))}function qo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ur(e[n],t[n]))return!1;return!0}function Yo(e,t,n,r,i,o){if(Bo=o,Vo=t,t.memoizedState=null,t.updateQueue=null,t.expirationTime=0,Fo.current=null===e||null===e.memoizedState?va:ya,e=n(r,i),t.expirationTime===Bo){o=0;do{if(t.expirationTime=0,!(25>o))throw Error(a(301));o+=1,Wo=Ho=null,t.updateQueue=null,Fo.current=ba,e=n(r,i)}while(t.expirationTime===Bo)}if(Fo.current=ga,t=null!==Ho&&null!==Ho.next,Bo=0,Wo=Ho=Vo=null,Go=!1,t)throw Error(a(300));return e}function Qo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Wo?Vo.memoizedState=Wo=e:Wo=Wo.next=e,Wo}function Ko(){if(null===Ho){var e=Vo.alternate;e=null!==e?e.memoizedState:null}else e=Ho.next;var t=null===Wo?Vo.memoizedState:Wo.next;if(null!==t)Wo=t,Ho=e;else{if(null===e)throw Error(a(310));e={memoizedState:(Ho=e).memoizedState,baseState:Ho.baseState,baseQueue:Ho.baseQueue,queue:Ho.queue,next:null},null===Wo?Vo.memoizedState=Wo=e:Wo=Wo.next=e}return Wo}function Xo(e,t){return"function"==typeof t?t(e):t}function Jo(e){var t=Ko(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=Ho,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var u=i.next;i.next=o.next,o.next=u}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var l=u=o=null,s=i;do{var c=s.expirationTime;if(c<Bo){var f={expirationTime:s.expirationTime,suspenseConfig:s.suspenseConfig,action:s.action,eagerReducer:s.eagerReducer,eagerState:s.eagerState,next:null};null===l?(u=l=f,o=r):l=l.next=f,c>Vo.expirationTime&&(Vo.expirationTime=c,al(c))}else null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:s.suspenseConfig,action:s.action,eagerReducer:s.eagerReducer,eagerState:s.eagerState,next:null}),ol(c,s.suspenseConfig),r=s.eagerReducer===e?s.eagerState:e(r,s.action);s=s.next}while(null!==s&&s!==i);null===l?o=r:l.next=u,Ur(r,t.memoizedState)||(Pa=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function Zo(e){var t=Ko(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var u=i=i.next;do{o=e(o,u.action),u=u.next}while(u!==i);Ur(o,t.memoizedState)||(Pa=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ea(e){var t=Qo();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:Xo,lastRenderedState:e}).dispatch=ma.bind(null,Vo,e),[t.memoizedState,e]}function ta(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Vo.updateQueue)?(t={lastEffect:null},Vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function na(){return Ko().memoizedState}function ra(e,t,n,r){var i=Qo();Vo.effectTag|=e,i.memoizedState=ta(1|t,n,void 0,void 0===r?null:r)}function ia(e,t,n,r){var i=Ko();r=void 0===r?null:r;var o=void 0;if(null!==Ho){var a=Ho.memoizedState;if(o=a.destroy,null!==r&&qo(r,a.deps))return void ta(t,n,o,r)}Vo.effectTag|=e,i.memoizedState=ta(1|t,n,o,r)}function oa(e,t){return ra(516,4,e,t)}function aa(e,t){return ia(516,4,e,t)}function ua(e,t){return ia(4,2,e,t)}function la(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function sa(e,t,n){return n=null!=n?n.concat([e]):null,ia(4,2,la.bind(null,t,e),n)}function ca(){}function fa(e,t){return Qo().memoizedState=[e,void 0===t?null:t],e}function da(e,t){var n=Ko();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&qo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function pa(e,t){var n=Ko();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&qo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ha(e,t,n){var r=zi();Vi(98>r?98:r,(function(){e(!0)})),Vi(97<r?97:r,(function(){var r=zo.suspense;zo.suspense=void 0===t?null:t;try{e(!1),n()}finally{zo.suspense=r}}))}function ma(e,t,n){var r=$u(),i=po.suspense;i={expirationTime:r=qu(r,e,i),suspenseConfig:i,action:n,eagerReducer:null,eagerState:null,next:null};var o=t.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),t.pending=i,o=e.alternate,e===Vo||null!==o&&o===Vo)Go=!0,i.expirationTime=Bo,Vo.expirationTime=Bo;else{if(0===e.expirationTime&&(null===o||0===o.expirationTime)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,u=o(a,n);if(i.eagerReducer=o,i.eagerState=u,Ur(u,a))return}catch(e){}Yu(e,r)}}var ga={readContext:ro,useCallback:$o,useContext:$o,useEffect:$o,useImperativeHandle:$o,useLayoutEffect:$o,useMemo:$o,useReducer:$o,useRef:$o,useState:$o,useDebugValue:$o,useResponder:$o,useDeferredValue:$o,useTransition:$o},va={readContext:ro,useCallback:fa,useContext:ro,useEffect:oa,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,ra(4,2,la.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ra(4,2,e,t)},useMemo:function(e,t){var n=Qo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Qo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=ma.bind(null,Vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Qo().memoizedState=e},useState:ea,useDebugValue:ca,useResponder:jo,useDeferredValue:function(e,t){var n=ea(e),r=n[0],i=n[1];return oa((function(){var n=zo.suspense;zo.suspense=void 0===t?null:t;try{i(e)}finally{zo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=ea(!1),n=t[0];return t=t[1],[fa(ha.bind(null,t,e),[t,e]),n]}},ya={readContext:ro,useCallback:da,useContext:ro,useEffect:aa,useImperativeHandle:sa,useLayoutEffect:ua,useMemo:pa,useReducer:Jo,useRef:na,useState:function(){return Jo(Xo)},useDebugValue:ca,useResponder:jo,useDeferredValue:function(e,t){var n=Jo(Xo),r=n[0],i=n[1];return aa((function(){var n=zo.suspense;zo.suspense=void 0===t?null:t;try{i(e)}finally{zo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=Jo(Xo),n=t[0];return t=t[1],[da(ha.bind(null,t,e),[t,e]),n]}},ba={readContext:ro,useCallback:da,useContext:ro,useEffect:aa,useImperativeHandle:sa,useLayoutEffect:ua,useMemo:pa,useReducer:Zo,useRef:na,useState:function(){return Zo(Xo)},useDebugValue:ca,useResponder:jo,useDeferredValue:function(e,t){var n=Zo(Xo),r=n[0],i=n[1];return aa((function(){var n=zo.suspense;zo.suspense=void 0===t?null:t;try{i(e)}finally{zo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=Zo(Xo),n=t[0];return t=t[1],[da(ha.bind(null,t,e),[t,e]),n]}},wa=null,Ea=null,Ta=!1;function _a(e,t){var n=Sl(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Sa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function xa(e){if(Ta){var t=Ea;if(t){var n=t;if(!Sa(e,t)){if(!(t=En(n.nextSibling))||!Sa(e,t))return e.effectTag=-1025&e.effectTag|2,Ta=!1,void(wa=e);_a(wa,n)}wa=e,Ea=En(t.firstChild)}else e.effectTag=-1025&e.effectTag|2,Ta=!1,wa=e}}function ka(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;wa=e}function Ca(e){if(e!==wa)return!1;if(!Ta)return ka(e),Ta=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!yn(t,e.memoizedProps))for(t=Ea;t;)_a(e,t),t=En(t.nextSibling);if(ka(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Ea=En(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Ea=null}}else Ea=wa?En(e.stateNode.nextSibling):null;return!0}function Aa(){Ea=wa=null,Ta=!1}var Oa=K.ReactCurrentOwner,Pa=!1;function Na(e,t,n,r){t.child=null===e?ko(t,null,n,r):xo(t,e.child,n,r)}function Ia(e,t,n,r,i){n=n.render;var o=t.ref;return no(t,i),r=Yo(e,t,n,r,o,i),null===e||Pa?(t.effectTag|=1,Na(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),Ya(e,t,i))}function Ra(e,t,n,r,i,o){if(null===e){var a=n.type;return"function"!=typeof a||xl(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Cl(n.type,null,r,null,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ma(e,t,a,r,i,o))}return a=e.child,i<o&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:Fr)(i,r)&&e.ref===t.ref)?Ya(e,t,o):(t.effectTag|=1,(e=kl(a,r)).ref=t.ref,e.return=t,t.child=e)}function Ma(e,t,n,r,i,o){return null!==e&&Fr(e.memoizedProps,r)&&e.ref===t.ref&&(Pa=!1,i<o)?(t.expirationTime=e.expirationTime,Ya(e,t,o)):Da(e,t,n,r,o)}function La(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function Da(e,t,n,r,i){var o=mi(n)?pi:fi.current;return o=hi(t,o),no(t,i),n=Yo(e,t,n,r,o,i),null===e||Pa?(t.effectTag|=1,Na(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),Ya(e,t,i))}function Ua(e,t,n,r,i){if(mi(n)){var o=!0;bi(t)}else o=!1;if(no(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),yo(t,n,r),wo(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,u=t.memoizedProps;a.props=u;var l=a.context,s=n.contextType;"object"==typeof s&&null!==s?s=ro(s):s=hi(t,s=mi(n)?pi:fi.current);var c=n.getDerivedStateFromProps,f="function"==typeof c||"function"==typeof a.getSnapshotBeforeUpdate;f||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(u!==r||l!==s)&&bo(t,a,r,s),io=!1;var d=t.memoizedState;a.state=d,co(t,r,a,i),l=t.memoizedState,u!==r||d!==l||di.current||io?("function"==typeof c&&(mo(t,n,c,r),l=t.memoizedState),(u=io||vo(t,n,u,r,d,l,s))?(f||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.effectTag|=4)):("function"==typeof a.componentDidMount&&(t.effectTag|=4),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=s,r=u):("function"==typeof a.componentDidMount&&(t.effectTag|=4),r=!1)}else a=t.stateNode,ao(e,t),u=t.memoizedProps,a.props=t.type===t.elementType?u:Yi(t.type,u),l=a.context,"object"==typeof(s=n.contextType)&&null!==s?s=ro(s):s=hi(t,s=mi(n)?pi:fi.current),(f="function"==typeof(c=n.getDerivedStateFromProps)||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(u!==r||l!==s)&&bo(t,a,r,s),io=!1,l=t.memoizedState,a.state=l,co(t,r,a,i),d=t.memoizedState,u!==r||l!==d||di.current||io?("function"==typeof c&&(mo(t,n,c,r),d=t.memoizedState),(c=io||vo(t,n,u,r,l,d,s))?(f||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,d,s),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,d,s)),"function"==typeof a.componentDidUpdate&&(t.effectTag|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!=typeof a.componentDidUpdate||u===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||u===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),t.memoizedProps=r,t.memoizedState=d),a.props=r,a.state=d,a.context=s,r=c):("function"!=typeof a.componentDidUpdate||u===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||u===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),r=!1);return ja(e,t,n,r,o,i)}function ja(e,t,n,r,i,o){La(e,t);var a=0!=(64&t.effectTag);if(!r&&!a)return i&&wi(t,n,!1),Ya(e,t,o);r=t.stateNode,Oa.current=t;var u=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.effectTag|=1,null!==e&&a?(t.child=xo(t,e.child,null,o),t.child=xo(t,null,u,o)):Na(e,t,u,o),t.memoizedState=r.state,i&&wi(t,n,!0),t.child}function Fa(e){var t=e.stateNode;t.pendingContext?vi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&vi(0,t.context,!1),Io(e,t.containerInfo)}var za,Ba,Va,Ha={dehydrated:null,retryTime:0};function Wa(e,t,n){var r,i=t.mode,o=t.pendingProps,a=Do.current,u=!1;if((r=0!=(64&t.effectTag))||(r=0!=(2&a)&&(null===e||null!==e.memoizedState)),r?(u=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(a|=1),si(Do,1&a),null===e){if(void 0!==o.fallback&&xa(t),u){if(u=o.fallback,(o=Al(null,i,0,null)).return=t,0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=Al(u,i,n,null)).return=t,o.sibling=n,t.memoizedState=Ha,t.child=o,n}return i=o.children,t.memoizedState=null,t.child=ko(t,null,i,n)}if(null!==e.memoizedState){if(i=(e=e.child).sibling,u){if(o=o.fallback,(n=kl(e,e.pendingProps)).return=t,0==(2&t.mode)&&(u=null!==t.memoizedState?t.child.child:t.child)!==e.child)for(n.child=u;null!==u;)u.return=n,u=u.sibling;return(i=kl(i,o)).return=t,n.sibling=i,n.childExpirationTime=0,t.memoizedState=Ha,t.child=n,i}return n=xo(t,e.child,o.children,n),t.memoizedState=null,t.child=n}if(e=e.child,u){if(u=o.fallback,(o=Al(null,i,0,null)).return=t,o.child=e,null!==e&&(e.return=o),0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=Al(u,i,n,null)).return=t,o.sibling=n,n.effectTag|=2,o.childExpirationTime=0,t.memoizedState=Ha,t.child=o,n}return t.memoizedState=null,t.child=xo(t,e,o.children,n)}function Ga(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t),to(e.return,t)}function $a(e,t,n,r,i,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailExpiration:0,tailMode:i,lastEffect:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailExpiration=0,a.tailMode=i,a.lastEffect=o)}function qa(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Na(e,t,r.children,n),0!=(2&(r=Do.current)))r=1&r|2,t.effectTag|=64;else{if(null!==e&&0!=(64&e.effectTag))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ga(e,n);else if(19===e.tag)Ga(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(si(Do,r),0==(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Uo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),$a(t,!1,i,n,o,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Uo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}$a(t,!0,n,null,o,t.lastEffect);break;case"together":$a(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function Ya(e,t,n){null!==e&&(t.dependencies=e.dependencies);var r=t.expirationTime;if(0!==r&&al(r),t.childExpirationTime<n)return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=kl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=kl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Qa(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ka(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return mi(t.type)&&gi(),null;case 3:return Ro(),li(di),li(fi),(n=t.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||!Ca(t)||(t.effectTag|=4),null;case 5:Lo(t),n=No(Po.current);var o=t.type;if(null!==e&&null!=t.stateNode)Ba(e,t,o,r,n),e.ref!==t.ref&&(t.effectTag|=128);else{if(!r){if(null===t.stateNode)throw Error(a(166));return null}if(e=No(Ao.current),Ca(t)){r=t.stateNode,o=t.type;var u=t.memoizedProps;switch(r[Sn]=t,r[xn]=u,o){case"iframe":case"object":case"embed":qt("load",r);break;case"video":case"audio":for(e=0;e<Ke.length;e++)qt(Ke[e],r);break;case"source":qt("error",r);break;case"img":case"image":case"link":qt("error",r),qt("load",r);break;case"form":qt("reset",r),qt("submit",r);break;case"details":qt("toggle",r);break;case"input":_e(r,u),qt("invalid",r),ln(n,"onChange");break;case"select":r._wrapperState={wasMultiple:!!u.multiple},qt("invalid",r),ln(n,"onChange");break;case"textarea":Ne(r,u),qt("invalid",r),ln(n,"onChange")}for(var l in on(o,u),e=null,u)if(u.hasOwnProperty(l)){var s=u[l];"children"===l?"string"==typeof s?r.textContent!==s&&(e=["children",s]):"number"==typeof s&&r.textContent!==""+s&&(e=["children",""+s]):S.hasOwnProperty(l)&&null!=s&&ln(n,l)}switch(o){case"input":we(r),ke(r,u,!0);break;case"textarea":we(r),Re(r);break;case"select":case"option":break;default:"function"==typeof u.onClick&&(r.onclick=sn)}n=e,t.updateQueue=n,null!==n&&(t.effectTag|=4)}else{switch(l=9===n.nodeType?n:n.ownerDocument,e===un&&(e=De(o)),e===un?"script"===o?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(o,{is:r.is}):(e=l.createElement(o),"select"===o&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,o),e[Sn]=t,e[xn]=r,za(e,t),t.stateNode=e,l=an(o,r),o){case"iframe":case"object":case"embed":qt("load",e),s=r;break;case"video":case"audio":for(s=0;s<Ke.length;s++)qt(Ke[s],e);s=r;break;case"source":qt("error",e),s=r;break;case"img":case"image":case"link":qt("error",e),qt("load",e),s=r;break;case"form":qt("reset",e),qt("submit",e),s=r;break;case"details":qt("toggle",e),s=r;break;case"input":_e(e,r),s=Te(e,r),qt("invalid",e),ln(n,"onChange");break;case"option":s=Ae(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=i({},r,{value:void 0}),qt("invalid",e),ln(n,"onChange");break;case"textarea":Ne(e,r),s=Pe(e,r),qt("invalid",e),ln(n,"onChange");break;default:s=r}on(o,s);var c=s;for(u in c)if(c.hasOwnProperty(u)){var f=c[u];"style"===u?nn(e,f):"dangerouslySetInnerHTML"===u?null!=(f=f?f.__html:void 0)&&Fe(e,f):"children"===u?"string"==typeof f?("textarea"!==o||""!==f)&&ze(e,f):"number"==typeof f&&ze(e,""+f):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(S.hasOwnProperty(u)?null!=f&&ln(n,u):null!=f&&X(e,u,f,l))}switch(o){case"input":we(e),ke(e,r,!1);break;case"textarea":we(e),Re(e);break;case"option":null!=r.value&&e.setAttribute("value",""+ye(r.value));break;case"select":e.multiple=!!r.multiple,null!=(n=r.value)?Oe(e,!!r.multiple,n,!1):null!=r.defaultValue&&Oe(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof s.onClick&&(e.onclick=sn)}vn(o,r)&&(t.effectTag|=4)}null!==t.ref&&(t.effectTag|=128)}return null;case 6:if(e&&null!=t.stateNode)Va(0,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));n=No(Po.current),No(Ao.current),Ca(t)?(n=t.stateNode,r=t.memoizedProps,n[Sn]=t,n.nodeValue!==r&&(t.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Sn]=t,t.stateNode=n)}return null;case 13:return li(Do),r=t.memoizedState,0!=(64&t.effectTag)?(t.expirationTime=n,t):(n=null!==r,r=!1,null===e?void 0!==t.memoizedProps.fallback&&Ca(t):(r=null!==(o=e.memoizedState),n||null===o||null!==(o=e.child.sibling)&&(null!==(u=t.firstEffect)?(t.firstEffect=o,o.nextEffect=u):(t.firstEffect=t.lastEffect=o,o.nextEffect=null),o.effectTag=8)),n&&!r&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&Do.current)?Cu===wu&&(Cu=Eu):(Cu!==wu&&Cu!==Eu||(Cu=Tu),0!==Iu&&null!==Su&&(Rl(Su,ku),Ml(Su,Iu)))),(n||r)&&(t.effectTag|=4),null);case 4:return Ro(),null;case 10:return eo(t),null;case 17:return mi(t.type)&&gi(),null;case 19:if(li(Do),null===(r=t.memoizedState))return null;if(o=0!=(64&t.effectTag),null===(u=r.rendering)){if(o)Qa(r,!1);else if(Cu!==wu||null!==e&&0!=(64&e.effectTag))for(u=t.child;null!==u;){if(null!==(e=Uo(u))){for(t.effectTag|=64,Qa(r,!1),null!==(o=e.updateQueue)&&(t.updateQueue=o,t.effectTag|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=t.child;null!==r;)u=n,(o=r).effectTag&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(e=o.alternate)?(o.childExpirationTime=0,o.expirationTime=u,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null):(o.childExpirationTime=e.childExpirationTime,o.expirationTime=e.expirationTime,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,u=e.dependencies,o.dependencies=null===u?null:{expirationTime:u.expirationTime,firstContext:u.firstContext,responders:u.responders}),r=r.sibling;return si(Do,1&Do.current|2),t.child}u=u.sibling}}else{if(!o)if(null!==(e=Uo(u))){if(t.effectTag|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.effectTag|=4),Qa(r,!0),null===r.tail&&"hidden"===r.tailMode&&!u.alternate)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Fi()-r.renderingStartTime>r.tailExpiration&&1<n&&(t.effectTag|=64,o=!0,Qa(r,!1),t.expirationTime=t.childExpirationTime=n-1);r.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=r.last)?n.sibling=u:t.child=u,r.last=u)}return null!==r.tail?(0===r.tailExpiration&&(r.tailExpiration=Fi()+500),n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Fi(),n.sibling=null,t=Do.current,si(Do,o?1&t|2:1&t),n):null}throw Error(a(156,t.tag))}function Xa(e){switch(e.tag){case 1:mi(e.type)&&gi();var t=e.effectTag;return 4096&t?(e.effectTag=-4097&t|64,e):null;case 3:if(Ro(),li(di),li(fi),0!=(64&(t=e.effectTag)))throw Error(a(285));return e.effectTag=-4097&t|64,e;case 5:return Lo(e),null;case 13:return li(Do),4096&(t=e.effectTag)?(e.effectTag=-4097&t|64,e):null;case 19:return li(Do),null;case 4:return Ro(),null;case 10:return eo(e),null;default:return null}}function Ja(e,t){return{value:e,source:t,stack:ve(t)}}za=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ba=function(e,t,n,r,o){var a=e.memoizedProps;if(a!==r){var u,l,s=t.stateNode;switch(No(Ao.current),e=null,n){case"input":a=Te(s,a),r=Te(s,r),e=[];break;case"option":a=Ae(s,a),r=Ae(s,r),e=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),e=[];break;case"textarea":a=Pe(s,a),r=Pe(s,r),e=[];break;default:"function"!=typeof a.onClick&&"function"==typeof r.onClick&&(s.onclick=sn)}for(u in on(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u)for(l in s=a[u])s.hasOwnProperty(l)&&(n||(n={}),n[l]="");else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(S.hasOwnProperty(u)?e||(e=[]):(e=e||[]).push(u,null));for(u in r){var c=r[u];if(s=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&c!==s&&(null!=c||null!=s))if("style"===u)if(s){for(l in s)!s.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&s[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(e||(e=[]),e.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,s=s?s.__html:void 0,null!=c&&s!==c&&(e=e||[]).push(u,c)):"children"===u?s===c||"string"!=typeof c&&"number"!=typeof c||(e=e||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(S.hasOwnProperty(u)?(null!=c&&ln(o,u),e||s===c||(e=[])):(e=e||[]).push(u,c))}n&&(e=e||[]).push("style",n),o=e,(t.updateQueue=o)&&(t.effectTag|=4)}},Va=function(e,t,n,r){n!==r&&(t.effectTag|=4)};var Za="function"==typeof WeakSet?WeakSet:Set;function eu(e,t){var n=t.source,r=t.stack;null===r&&null!==n&&(r=ve(n)),null!==n&&ge(n.type),t=t.value,null!==e&&1===e.tag&&ge(e.type);try{console.error(t)}catch(e){setTimeout((function(){throw e}))}}function tu(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){yl(e,t)}else t.current=null}function nu(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.effectTag&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Yi(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(a(163))}function ru(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==t)}}function iu(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ou(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:return void iu(3,n);case 1:if(e=n.stateNode,4&n.effectTag)if(null===t)e.componentDidMount();else{var r=n.elementType===n.type?t.memoizedProps:Yi(n.type,t.memoizedProps);e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate)}return void(null!==(t=n.updateQueue)&&fo(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}fo(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.effectTag&&vn(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Dt(n)))));case 19:case 17:case 20:case 21:return}throw Error(a(163))}function au(e,t,n){switch("function"==typeof Tl&&Tl(t),t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e.next;Vi(97<n?97:n,(function(){var e=r;do{var n=e.destroy;if(void 0!==n){var i=t;try{n()}catch(e){yl(i,e)}}e=e.next}while(e!==r)}))}break;case 1:tu(t),"function"==typeof(n=t.stateNode).componentWillUnmount&&function(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){yl(e,t)}}(t,n);break;case 5:tu(t);break;case 4:cu(e,t,n)}}function uu(e){var t=e.alternate;e.return=null,e.child=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.alternate=null,e.firstEffect=null,e.lastEffect=null,e.pendingProps=null,e.memoizedProps=null,e.stateNode=null,null!==t&&uu(t)}function lu(e){return 5===e.tag||3===e.tag||4===e.tag}function su(e){e:{for(var t=e.return;null!==t;){if(lu(t)){var n=t;break e}t=t.return}throw Error(a(160))}switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(a(161))}16&n.effectTag&&(ze(t,""),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||lu(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break e}}r?function e(t,n,r){var i=t.tag,o=5===i||6===i;if(o)t=o?t.stateNode:t.stateNode.instance,n?8===r.nodeType?r.parentNode.insertBefore(t,n):r.insertBefore(t,n):(8===r.nodeType?(n=r.parentNode).insertBefore(t,r):(n=r).appendChild(t),null!==(r=r._reactRootContainer)&&void 0!==r||null!==n.onclick||(n.onclick=sn));else if(4!==i&&null!==(t=t.child))for(e(t,n,r),t=t.sibling;null!==t;)e(t,n,r),t=t.sibling}(e,n,t):function e(t,n,r){var i=t.tag,o=5===i||6===i;if(o)t=o?t.stateNode:t.stateNode.instance,n?r.insertBefore(t,n):r.appendChild(t);else if(4!==i&&null!==(t=t.child))for(e(t,n,r),t=t.sibling;null!==t;)e(t,n,r),t=t.sibling}(e,n,t)}function cu(e,t,n){for(var r,i,o=t,u=!1;;){if(!u){u=o.return;e:for(;;){if(null===u)throw Error(a(160));switch(r=u.stateNode,u.tag){case 5:i=!1;break e;case 3:case 4:r=r.containerInfo,i=!0;break e}u=u.return}u=!0}if(5===o.tag||6===o.tag){e:for(var l=e,s=o,c=n,f=s;;)if(au(l,f,c),null!==f.child&&4!==f.tag)f.child.return=f,f=f.child;else{if(f===s)break e;for(;null===f.sibling;){if(null===f.return||f.return===s)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}i?(l=r,s=o.stateNode,8===l.nodeType?l.parentNode.removeChild(s):l.removeChild(s)):r.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,i=!0,o.child.return=o,o=o.child;continue}}else if(au(e,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(u=!1)}o.sibling.return=o.return,o=o.sibling}}function fu(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void ru(3,t);case 1:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps,i=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[xn]=r,"input"===e&&"radio"===r.type&&null!=r.name&&Se(n,r),an(e,i),t=an(e,r),i=0;i<o.length;i+=2){var u=o[i],l=o[i+1];"style"===u?nn(n,l):"dangerouslySetInnerHTML"===u?Fe(n,l):"children"===u?ze(n,l):X(n,u,l,t)}switch(e){case"input":xe(n,r);break;case"textarea":Ie(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(e=r.value)?Oe(n,!!r.multiple,e,!1):t!==!!r.multiple&&(null!=r.defaultValue?Oe(n,!!r.multiple,r.defaultValue,!0):Oe(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(a(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((t=t.stateNode).hydrate&&(t.hydrate=!1,Dt(t.containerInfo)));case 12:return;case 13:if(n=t,null===t.memoizedState?r=!1:(r=!0,n=t.child,Mu=Fi()),null!==n)e:for(e=n;;){if(5===e.tag)o=e.stateNode,r?"function"==typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=e.stateNode,i=null!=(i=e.memoizedProps.style)&&i.hasOwnProperty("display")?i.display:null,o.style.display=tn("display",i));else if(6===e.tag)e.stateNode.nodeValue=r?"":e.memoizedProps;else{if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){(o=e.child.sibling).return=e,e=o;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===n)break;for(;null===e.sibling;){if(null===e.return||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}return void du(t);case 19:return void du(t);case 17:return}throw Error(a(163))}function du(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Za),t.forEach((function(t){var r=wl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}var pu="function"==typeof WeakMap?WeakMap:Map;function hu(e,t,n){(n=uo(n,null)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Du||(Du=!0,Uu=r),eu(e,t)},n}function mu(e,t,n){(n=uo(n,null)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return eu(e,t),r(i)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===ju?ju=new Set([this]):ju.add(this),eu(e,t));var n=t.stack;this.componentDidCatch(t.value,{componentStack:null!==n?n:""})}),n}var gu,vu=Math.ceil,yu=K.ReactCurrentDispatcher,bu=K.ReactCurrentOwner,wu=0,Eu=3,Tu=4,_u=0,Su=null,xu=null,ku=0,Cu=wu,Au=null,Ou=1073741823,Pu=1073741823,Nu=null,Iu=0,Ru=!1,Mu=0,Lu=null,Du=!1,Uu=null,ju=null,Fu=!1,zu=null,Bu=90,Vu=null,Hu=0,Wu=null,Gu=0;function $u(){return 0!=(48&_u)?1073741821-(Fi()/10|0):0!==Gu?Gu:Gu=1073741821-(Fi()/10|0)}function qu(e,t,n){if(0==(2&(t=t.mode)))return 1073741823;var r=zi();if(0==(4&t))return 99===r?1073741823:1073741822;if(0!=(16&_u))return ku;if(null!==n)e=qi(e,0|n.timeoutMs||5e3,250);else switch(r){case 99:e=1073741823;break;case 98:e=qi(e,150,100);break;case 97:case 96:e=qi(e,5e3,250);break;case 95:e=2;break;default:throw Error(a(326))}return null!==Su&&e===ku&&--e,e}function Yu(e,t){if(50<Hu)throw Hu=0,Wu=null,Error(a(185));if(null!==(e=Qu(e,t))){var n=zi();1073741823===t?0!=(8&_u)&&0==(48&_u)?Zu(e):(Xu(e),0===_u&&Gi()):Xu(e),0==(4&_u)||98!==n&&99!==n||(null===Vu?Vu=new Map([[e,t]]):(void 0===(n=Vu.get(e))||n>t)&&Vu.set(e,t))}}function Qu(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t);var r=e.return,i=null;if(null===r&&3===e.tag)i=e.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<t&&(r.childExpirationTime=t),null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null!==i&&(Su===i&&(al(t),Cu===Tu&&Rl(i,ku)),Ml(i,t)),i}function Ku(e){var t=e.lastExpiredTime;if(0!==t)return t;if(!Il(e,t=e.firstPendingTime))return t;var n=e.lastPingedTime;return 2>=(e=n>(e=e.nextKnownPendingLevel)?n:e)&&t!==e?0:e}function Xu(e){if(0!==e.lastExpiredTime)e.callbackExpirationTime=1073741823,e.callbackPriority=99,e.callbackNode=Wi(Zu.bind(null,e));else{var t=Ku(e),n=e.callbackNode;if(0===t)null!==n&&(e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90);else{var r=$u();if(1073741823===t?r=99:1===t||2===t?r=95:r=0>=(r=10*(1073741821-t)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var i=e.callbackPriority;if(e.callbackExpirationTime===t&&i>=r)return;n!==Ii&&_i(n)}e.callbackExpirationTime=t,e.callbackPriority=r,t=1073741823===t?Wi(Zu.bind(null,e)):Hi(r,Ju.bind(null,e),{timeout:10*(1073741821-t)-Fi()}),e.callbackNode=t}}}function Ju(e,t){if(Gu=0,t)return Ll(e,t=$u()),Xu(e),null;var n=Ku(e);if(0!==n){if(t=e.callbackNode,0!=(48&_u))throw Error(a(327));if(ml(),e===Su&&n===ku||nl(e,n),null!==xu){var r=_u;_u|=16;for(var i=il();;)try{ll();break}catch(t){rl(e,t)}if(Zi(),_u=r,yu.current=i,1===Cu)throw t=Au,nl(e,n),Rl(e,n),Xu(e),t;if(null===xu)switch(i=e.finishedWork=e.current.alternate,e.finishedExpirationTime=n,r=Cu,Su=null,r){case wu:case 1:throw Error(a(345));case 2:Ll(e,2<n?2:n);break;case Eu:if(Rl(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=fl(i)),1073741823===Ou&&10<(i=Mu+500-Fi())){if(Ru){var o=e.lastPingedTime;if(0===o||o>=n){e.lastPingedTime=n,nl(e,n);break}}if(0!==(o=Ku(e))&&o!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}e.timeoutHandle=bn(dl.bind(null,e),i);break}dl(e);break;case Tu:if(Rl(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=fl(i)),Ru&&(0===(i=e.lastPingedTime)||i>=n)){e.lastPingedTime=n,nl(e,n);break}if(0!==(i=Ku(e))&&i!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}if(1073741823!==Pu?r=10*(1073741821-Pu)-Fi():1073741823===Ou?r=0:(r=10*(1073741821-Ou)-5e3,0>(r=(i=Fi())-r)&&(r=0),(n=10*(1073741821-n)-i)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vu(r/1960))-r)&&(r=n)),10<r){e.timeoutHandle=bn(dl.bind(null,e),r);break}dl(e);break;case 5:if(1073741823!==Ou&&null!==Nu){o=Ou;var u=Nu;if(0>=(r=0|u.busyMinDurationMs)?r=0:(i=0|u.busyDelayMs,r=(o=Fi()-(10*(1073741821-o)-(0|u.timeoutMs||5e3)))<=i?0:i+r-o),10<r){Rl(e,n),e.timeoutHandle=bn(dl.bind(null,e),r);break}}dl(e);break;default:throw Error(a(329))}if(Xu(e),e.callbackNode===t)return Ju.bind(null,e)}}return null}function Zu(e){var t=e.lastExpiredTime;if(t=0!==t?t:1073741823,0!=(48&_u))throw Error(a(327));if(ml(),e===Su&&t===ku||nl(e,t),null!==xu){var n=_u;_u|=16;for(var r=il();;)try{ul();break}catch(t){rl(e,t)}if(Zi(),_u=n,yu.current=r,1===Cu)throw n=Au,nl(e,t),Rl(e,t),Xu(e),n;if(null!==xu)throw Error(a(261));e.finishedWork=e.current.alternate,e.finishedExpirationTime=t,Su=null,dl(e),Xu(e)}return null}function el(e,t){var n=_u;_u|=1;try{return e(t)}finally{0===(_u=n)&&Gi()}}function tl(e,t){var n=_u;_u&=-2,_u|=8;try{return e(t)}finally{0===(_u=n)&&Gi()}}function nl(e,t){e.finishedWork=null,e.finishedExpirationTime=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,wn(n)),null!==xu)for(n=xu.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&gi();break;case 3:Ro(),li(di),li(fi);break;case 5:Lo(r);break;case 4:Ro();break;case 13:case 19:li(Do);break;case 10:eo(r)}n=n.return}Su=e,xu=kl(e.current,null),ku=t,Cu=wu,Au=null,Pu=Ou=1073741823,Nu=null,Iu=0,Ru=!1}function rl(e,t){for(;;){try{if(Zi(),Fo.current=ga,Go)for(var n=Vo.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}if(Bo=0,Wo=Ho=Vo=null,Go=!1,null===xu||null===xu.return)return Cu=1,Au=t,xu=null;e:{var i=e,o=xu.return,a=xu,u=t;if(t=ku,a.effectTag|=2048,a.firstEffect=a.lastEffect=null,null!==u&&"object"==typeof u&&"function"==typeof u.then){var l=u;if(0==(2&a.mode)){var s=a.alternate;s?(a.updateQueue=s.updateQueue,a.memoizedState=s.memoizedState,a.expirationTime=s.expirationTime):(a.updateQueue=null,a.memoizedState=null)}var c=0!=(1&Do.current),f=o;do{var d;if(d=13===f.tag){var p=f.memoizedState;if(null!==p)d=null!==p.dehydrated;else{var h=f.memoizedProps;d=void 0!==h.fallback&&(!0!==h.unstable_avoidThisFallback||!c)}}if(d){var m=f.updateQueue;if(null===m){var g=new Set;g.add(l),f.updateQueue=g}else m.add(l);if(0==(2&f.mode)){if(f.effectTag|=64,a.effectTag&=-2981,1===a.tag)if(null===a.alternate)a.tag=17;else{var v=uo(1073741823,null);v.tag=2,lo(a,v)}a.expirationTime=1073741823;break e}u=void 0,a=t;var y=i.pingCache;if(null===y?(y=i.pingCache=new pu,u=new Set,y.set(l,u)):void 0===(u=y.get(l))&&(u=new Set,y.set(l,u)),!u.has(a)){u.add(a);var b=bl.bind(null,i,l,a);l.then(b,b)}f.effectTag|=4096,f.expirationTime=t;break e}f=f.return}while(null!==f);u=Error((ge(a.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+ve(a))}5!==Cu&&(Cu=2),u=Ja(u,a),f=o;do{switch(f.tag){case 3:l=u,f.effectTag|=4096,f.expirationTime=t,so(f,hu(f,l,t));break e;case 1:l=u;var w=f.type,E=f.stateNode;if(0==(64&f.effectTag)&&("function"==typeof w.getDerivedStateFromError||null!==E&&"function"==typeof E.componentDidCatch&&(null===ju||!ju.has(E)))){f.effectTag|=4096,f.expirationTime=t,so(f,mu(f,l,t));break e}}f=f.return}while(null!==f)}xu=cl(xu)}catch(e){t=e;continue}break}}function il(){var e=yu.current;return yu.current=ga,null===e?ga:e}function ol(e,t){e<Ou&&2<e&&(Ou=e),null!==t&&e<Pu&&2<e&&(Pu=e,Nu=t)}function al(e){e>Iu&&(Iu=e)}function ul(){for(;null!==xu;)xu=sl(xu)}function ll(){for(;null!==xu&&!Ri();)xu=sl(xu)}function sl(e){var t=gu(e.alternate,e,ku);return e.memoizedProps=e.pendingProps,null===t&&(t=cl(e)),bu.current=null,t}function cl(e){xu=e;do{var t=xu.alternate;if(e=xu.return,0==(2048&xu.effectTag)){if(t=Ka(t,xu,ku),1===ku||1!==xu.childExpirationTime){for(var n=0,r=xu.child;null!==r;){var i=r.expirationTime,o=r.childExpirationTime;i>n&&(n=i),o>n&&(n=o),r=r.sibling}xu.childExpirationTime=n}if(null!==t)return t;null!==e&&0==(2048&e.effectTag)&&(null===e.firstEffect&&(e.firstEffect=xu.firstEffect),null!==xu.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=xu.firstEffect),e.lastEffect=xu.lastEffect),1<xu.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=xu:e.firstEffect=xu,e.lastEffect=xu))}else{if(null!==(t=Xa(xu)))return t.effectTag&=2047,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=2048)}if(null!==(t=xu.sibling))return t;xu=e}while(null!==xu);return Cu===wu&&(Cu=5),null}function fl(e){var t=e.expirationTime;return t>(e=e.childExpirationTime)?t:e}function dl(e){var t=zi();return Vi(99,pl.bind(null,e,t)),null}function pl(e,t){do{ml()}while(null!==zu);if(0!=(48&_u))throw Error(a(327));var n=e.finishedWork,r=e.finishedExpirationTime;if(null===n)return null;if(e.finishedWork=null,e.finishedExpirationTime=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90,e.nextKnownPendingLevel=0;var i=fl(n);if(e.firstPendingTime=i,r<=e.lastSuspendedTime?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:r<=e.firstSuspendedTime&&(e.firstSuspendedTime=r-1),r<=e.lastPingedTime&&(e.lastPingedTime=0),r<=e.lastExpiredTime&&(e.lastExpiredTime=0),e===Su&&(xu=Su=null,ku=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){var o=_u;_u|=32,bu.current=null,mn=$t;var u=pn();if(hn(u)){if("selectionStart"in u)var l={start:u.selectionStart,end:u.selectionEnd};else e:{var s=(l=(l=u.ownerDocument)&&l.defaultView||window).getSelection&&l.getSelection();if(s&&0!==s.rangeCount){l=s.anchorNode;var c=s.anchorOffset,f=s.focusNode;s=s.focusOffset;try{l.nodeType,f.nodeType}catch(e){l=null;break e}var d=0,p=-1,h=-1,m=0,g=0,v=u,y=null;t:for(;;){for(var b;v!==l||0!==c&&3!==v.nodeType||(p=d+c),v!==f||0!==s&&3!==v.nodeType||(h=d+s),3===v.nodeType&&(d+=v.nodeValue.length),null!==(b=v.firstChild);)y=v,v=b;for(;;){if(v===u)break t;if(y===l&&++m===c&&(p=d),y===f&&++g===s&&(h=d),null!==(b=v.nextSibling))break;y=(v=y).parentNode}v=b}l=-1===p||-1===h?null:{start:p,end:h}}else l=null}l=l||{start:0,end:0}}else l=null;gn={activeElementDetached:null,focusedElem:u,selectionRange:l},$t=!1,Lu=i;do{try{hl()}catch(e){if(null===Lu)throw Error(a(330));yl(Lu,e),Lu=Lu.nextEffect}}while(null!==Lu);Lu=i;do{try{for(u=e,l=t;null!==Lu;){var w=Lu.effectTag;if(16&w&&ze(Lu.stateNode,""),128&w){var E=Lu.alternate;if(null!==E){var T=E.ref;null!==T&&("function"==typeof T?T(null):T.current=null)}}switch(1038&w){case 2:su(Lu),Lu.effectTag&=-3;break;case 6:su(Lu),Lu.effectTag&=-3,fu(Lu.alternate,Lu);break;case 1024:Lu.effectTag&=-1025;break;case 1028:Lu.effectTag&=-1025,fu(Lu.alternate,Lu);break;case 4:fu(Lu.alternate,Lu);break;case 8:cu(u,c=Lu,l),uu(c)}Lu=Lu.nextEffect}}catch(e){if(null===Lu)throw Error(a(330));yl(Lu,e),Lu=Lu.nextEffect}}while(null!==Lu);if(T=gn,E=pn(),w=T.focusedElem,l=T.selectionRange,E!==w&&w&&w.ownerDocument&&function e(t,n){return!(!t||!n)&&(t===n||(!t||3!==t.nodeType)&&(n&&3===n.nodeType?e(t,n.parentNode):"contains"in t?t.contains(n):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(n))))}(w.ownerDocument.documentElement,w)){null!==l&&hn(w)&&(E=l.start,void 0===(T=l.end)&&(T=E),"selectionStart"in w?(w.selectionStart=E,w.selectionEnd=Math.min(T,w.value.length)):(T=(E=w.ownerDocument||document)&&E.defaultView||window).getSelection&&(T=T.getSelection(),c=w.textContent.length,u=Math.min(l.start,c),l=void 0===l.end?u:Math.min(l.end,c),!T.extend&&u>l&&(c=l,l=u,u=c),c=dn(w,u),f=dn(w,l),c&&f&&(1!==T.rangeCount||T.anchorNode!==c.node||T.anchorOffset!==c.offset||T.focusNode!==f.node||T.focusOffset!==f.offset)&&((E=E.createRange()).setStart(c.node,c.offset),T.removeAllRanges(),u>l?(T.addRange(E),T.extend(f.node,f.offset)):(E.setEnd(f.node,f.offset),T.addRange(E))))),E=[];for(T=w;T=T.parentNode;)1===T.nodeType&&E.push({element:T,left:T.scrollLeft,top:T.scrollTop});for("function"==typeof w.focus&&w.focus(),w=0;w<E.length;w++)(T=E[w]).element.scrollLeft=T.left,T.element.scrollTop=T.top}$t=!!mn,gn=mn=null,e.current=n,Lu=i;do{try{for(w=e;null!==Lu;){var _=Lu.effectTag;if(36&_&&ou(w,Lu.alternate,Lu),128&_){E=void 0;var S=Lu.ref;if(null!==S){var x=Lu.stateNode;switch(Lu.tag){case 5:E=x;break;default:E=x}"function"==typeof S?S(E):S.current=E}}Lu=Lu.nextEffect}}catch(e){if(null===Lu)throw Error(a(330));yl(Lu,e),Lu=Lu.nextEffect}}while(null!==Lu);Lu=null,Mi(),_u=o}else e.current=n;if(Fu)Fu=!1,zu=e,Bu=t;else for(Lu=i;null!==Lu;)t=Lu.nextEffect,Lu.nextEffect=null,Lu=t;if(0===(t=e.firstPendingTime)&&(ju=null),1073741823===t?e===Wu?Hu++:(Hu=0,Wu=e):Hu=0,"function"==typeof El&&El(n.stateNode,r),Xu(e),Du)throw Du=!1,e=Uu,Uu=null,e;return 0!=(8&_u)||Gi(),null}function hl(){for(;null!==Lu;){var e=Lu.effectTag;0!=(256&e)&&nu(Lu.alternate,Lu),0==(512&e)||Fu||(Fu=!0,Hi(97,(function(){return ml(),null}))),Lu=Lu.nextEffect}}function ml(){if(90!==Bu){var e=97<Bu?97:Bu;return Bu=90,Vi(e,gl)}}function gl(){if(null===zu)return!1;var e=zu;if(zu=null,0!=(48&_u))throw Error(a(331));var t=_u;for(_u|=32,e=e.current.firstEffect;null!==e;){try{var n=e;if(0!=(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:ru(5,n),iu(5,n)}}catch(t){if(null===e)throw Error(a(330));yl(e,t)}n=e.nextEffect,e.nextEffect=null,e=n}return _u=t,Gi(),!0}function vl(e,t,n){lo(e,t=hu(e,t=Ja(n,t),1073741823)),null!==(e=Qu(e,1073741823))&&Xu(e)}function yl(e,t){if(3===e.tag)vl(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){vl(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===ju||!ju.has(r))){lo(n,e=mu(n,e=Ja(t,e),1073741823)),null!==(n=Qu(n,1073741823))&&Xu(n);break}}n=n.return}}function bl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),Su===e&&ku===n?Cu===Tu||Cu===Eu&&1073741823===Ou&&Fi()-Mu<500?nl(e,ku):Ru=!0:Il(e,n)&&(0!==(t=e.lastPingedTime)&&t<n||(e.lastPingedTime=n,Xu(e)))}function wl(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(t=qu(t=$u(),e,null)),null!==(e=Qu(e,t))&&Xu(e)}gu=function(e,t,n){var r=t.expirationTime;if(null!==e){var i=t.pendingProps;if(e.memoizedProps!==i||di.current)Pa=!0;else{if(r<n){switch(Pa=!1,t.tag){case 3:Fa(t),Aa();break;case 5:if(Mo(t),4&t.mode&&1!==n&&i.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:mi(t.type)&&bi(t);break;case 4:Io(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value,i=t.type._context,si(Qi,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(r=t.child.childExpirationTime)&&r>=n?Wa(e,t,n):(si(Do,1&Do.current),null!==(t=Ya(e,t,n))?t.sibling:null);si(Do,1&Do.current);break;case 19:if(r=t.childExpirationTime>=n,0!=(64&e.effectTag)){if(r)return qa(e,t,n);t.effectTag|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null),si(Do,Do.current),!r)return null}return Ya(e,t,n)}Pa=!1}}else Pa=!1;switch(t.expirationTime=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,i=hi(t,fi.current),no(t,n),i=Yo(null,t,r,e,i,n),t.effectTag|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,mi(r)){var o=!0;bi(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,oo(t);var u=r.getDerivedStateFromProps;"function"==typeof u&&mo(t,r,u,e),i.updater=go,t.stateNode=i,i._reactInternalFiber=t,wo(t,r,e,n),t=ja(null,t,r,!0,o,n)}else t.tag=0,Na(null,t,i,n),t=t.child;return t;case 16:e:{if(i=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,function(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}}(i),1!==i._status)throw i._result;switch(i=i._result,t.type=i,o=t.tag=function(e){if("function"==typeof e)return xl(e)?1:0;if(null!=e){if((e=e.$$typeof)===le)return 11;if(e===fe)return 14}return 2}(i),e=Yi(i,e),o){case 0:t=Da(null,t,i,e,n);break e;case 1:t=Ua(null,t,i,e,n);break e;case 11:t=Ia(null,t,i,e,n);break e;case 14:t=Ra(null,t,i,Yi(i.type,e),r,n);break e}throw Error(a(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Da(e,t,r,i=t.elementType===r?i:Yi(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ua(e,t,r,i=t.elementType===r?i:Yi(r,i),n);case 3:if(Fa(t),r=t.updateQueue,null===e||null===r)throw Error(a(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,ao(e,t),co(t,r,null,n),(r=t.memoizedState.element)===i)Aa(),t=Ya(e,t,n);else{if((i=t.stateNode.hydrate)&&(Ea=En(t.stateNode.containerInfo.firstChild),wa=t,i=Ta=!0),i)for(n=ko(t,null,r,n),t.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Na(e,t,r,n),Aa();t=t.child}return t;case 5:return Mo(t),null===e&&xa(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,u=i.children,yn(r,i)?u=null:null!==o&&yn(r,o)&&(t.effectTag|=16),La(e,t),4&t.mode&&1!==n&&i.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(Na(e,t,u,n),t=t.child),t;case 6:return null===e&&xa(t),null;case 13:return Wa(e,t,n);case 4:return Io(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=xo(t,null,r,n):Na(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ia(e,t,r,i=t.elementType===r?i:Yi(r,i),n);case 7:return Na(e,t,t.pendingProps,n),t.child;case 8:case 12:return Na(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,u=t.memoizedProps,o=i.value;var l=t.type._context;if(si(Qi,l._currentValue),l._currentValue=o,null!==u)if(l=u.value,0===(o=Ur(l,o)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(l,o):1073741823))){if(u.children===i.children&&!di.current){t=Ya(e,t,n);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var s=l.dependencies;if(null!==s){u=l.child;for(var c=s.firstContext;null!==c;){if(c.context===r&&0!=(c.observedBits&o)){1===l.tag&&((c=uo(n,null)).tag=2,lo(l,c)),l.expirationTime<n&&(l.expirationTime=n),null!==(c=l.alternate)&&c.expirationTime<n&&(c.expirationTime=n),to(l.return,n),s.expirationTime<n&&(s.expirationTime=n);break}c=c.next}}else u=10===l.tag&&l.type===t.type?null:l.child;if(null!==u)u.return=l;else for(u=l;null!==u;){if(u===t){u=null;break}if(null!==(l=u.sibling)){l.return=u.return,u=l;break}u=u.return}l=u}Na(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(o=t.pendingProps).children,no(t,n),r=r(i=ro(i,o.unstable_observedBits)),t.effectTag|=1,Na(e,t,r,n),t.child;case 14:return o=Yi(i=t.type,t.pendingProps),Ra(e,t,i,o=Yi(i.type,o),r,n);case 15:return Ma(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Yi(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,mi(r)?(e=!0,bi(t)):e=!1,no(t,n),yo(t,r,i),wo(t,r,i,n),ja(null,t,r,!0,e,n);case 19:return qa(e,t,n)}throw Error(a(156,t.tag))};var El=null,Tl=null;function _l(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Sl(e,t,n,r){return new _l(e,t,n,r)}function xl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function kl(e,t){var n=e.alternate;return null===n?((n=Sl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Cl(e,t,n,r,i,o){var u=2;if(r=e,"function"==typeof e)xl(e)&&(u=1);else if("string"==typeof e)u=5;else e:switch(e){case ne:return Al(n.children,i,o,t);case ue:u=8,i|=7;break;case re:u=8,i|=1;break;case ie:return(e=Sl(12,n,t,8|i)).elementType=ie,e.type=ie,e.expirationTime=o,e;case se:return(e=Sl(13,n,t,i)).type=se,e.elementType=se,e.expirationTime=o,e;case ce:return(e=Sl(19,n,t,i)).elementType=ce,e.expirationTime=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case oe:u=10;break e;case ae:u=9;break e;case le:u=11;break e;case fe:u=14;break e;case de:u=16,r=null;break e;case pe:u=22;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Sl(u,n,t,i)).elementType=e,t.type=r,t.expirationTime=o,t}function Al(e,t,n,r){return(e=Sl(7,e,r,t)).expirationTime=n,e}function Ol(e,t,n){return(e=Sl(6,e,null,t)).expirationTime=n,e}function Pl(e,t,n){return(t=Sl(4,null!==e.children?e.children:[],e.key,t)).expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nl(e,t,n){this.tag=t,this.current=null,this.containerInfo=e,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Il(e,t){var n=e.firstSuspendedTime;return e=e.lastSuspendedTime,0!==n&&n>=t&&e<=t}function Rl(e,t){var n=e.firstSuspendedTime,r=e.lastSuspendedTime;n<t&&(e.firstSuspendedTime=t),(r>t||0===n)&&(e.lastSuspendedTime=t),t<=e.lastPingedTime&&(e.lastPingedTime=0),t<=e.lastExpiredTime&&(e.lastExpiredTime=0)}function Ml(e,t){t>e.firstPendingTime&&(e.firstPendingTime=t);var n=e.firstSuspendedTime;0!==n&&(t>=n?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:t>=e.lastSuspendedTime&&(e.lastSuspendedTime=t+1),t>e.nextKnownPendingLevel&&(e.nextKnownPendingLevel=t))}function Ll(e,t){var n=e.lastExpiredTime;(0===n||n>t)&&(e.lastExpiredTime=t)}function Dl(e,t,n,r){var i=t.current,o=$u(),u=po.suspense;o=qu(o,i,u);e:if(n){t:{if(Ze(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(a(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break t;case 1:if(mi(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}}l=l.return}while(null!==l);throw Error(a(171))}if(1===n.tag){var s=n.type;if(mi(s)){n=yi(n,s,l);break e}}n=l}else n=ci;return null===t.context?t.context=n:t.pendingContext=n,(t=uo(o,u)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),lo(i,t),Yu(i,o),o}function Ul(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function jl(e,t){null!==(e=e.memoizedState)&&null!==e.dehydrated&&e.retryTime<t&&(e.retryTime=t)}function Fl(e,t){jl(e,t),(e=e.alternate)&&jl(e,t)}function zl(e,t,n){var r=new Nl(e,t,n=null!=n&&!0===n.hydrate),i=Sl(3,null,null,2===t?7:1===t?3:0);r.current=i,i.stateNode=r,oo(i),e[kn]=r.current,n&&0!==t&&function(e,t){var n=Je(t);kt.forEach((function(e){ht(e,t,n)})),Ct.forEach((function(e){ht(e,t,n)}))}(0,9===e.nodeType?e:e.ownerDocument),this._internalRoot=r}function Bl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Vl(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o._internalRoot;if("function"==typeof i){var u=i;i=function(){var e=Ul(a);u.call(e)}}Dl(t,a,e,i)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new zl(e,0,t?{hydrate:!0}:void 0)}(n,r),a=o._internalRoot,"function"==typeof i){var l=i;i=function(){var e=Ul(a);l.call(e)}}tl((function(){Dl(t,a,e,i)}))}return Ul(a)}function Hl(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:te,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Wl(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Bl(t))throw Error(a(200));return Hl(e,t,null,n)}zl.prototype.render=function(e){Dl(e,this._internalRoot,null,null)},zl.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Dl(null,e,null,(function(){t[kn]=null}))},mt=function(e){if(13===e.tag){var t=qi($u(),150,100);Yu(e,t),Fl(e,t)}},gt=function(e){13===e.tag&&(Yu(e,3),Fl(e,3))},vt=function(e){if(13===e.tag){var t=$u();Yu(e,t=qu(t,e,null)),Fl(e,t)}},A=function(e,t,n){switch(t){case"input":if(xe(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Pn(r);if(!i)throw Error(a(90));Ee(r),xe(r,i)}}}break;case"textarea":Ie(e,n);break;case"select":null!=(t=n.value)&&Oe(e,!!n.multiple,t,!1)}},M=el,L=function(e,t,n,r,i){var o=_u;_u|=4;try{return Vi(98,e.bind(null,t,n,r,i))}finally{0===(_u=o)&&Gi()}},D=function(){0==(49&_u)&&(function(){if(null!==Vu){var e=Vu;Vu=null,e.forEach((function(e,t){Ll(t,e),Xu(t)})),Gi()}}(),ml())},U=function(e,t){var n=_u;_u|=2;try{return e(t)}finally{0===(_u=n)&&Gi()}};var Gl,$l,ql={Events:[An,On,Pn,k,_,Un,function(e){it(e,Dn)},I,R,Xt,ut,ml,{current:!1}]};$l=(Gl={findFiberByHostInstance:Cn,bundleType:0,version:"16.13.1",rendererPackageName:"react-dom"}).findFiberByHostInstance,function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var n=t.inject(e);El=function(e){try{t.onCommitFiberRoot(n,e,void 0,64==(64&e.current.effectTag))}catch(e){}},Tl=function(e){try{t.onCommitFiberUnmount(n,e)}catch(e){}}}catch(e){}}(i({},Gl,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:K.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=nt(e))?null:e.stateNode},findFiberByHostInstance:function(e){return $l?$l(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null})),t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ql,t.createPortal=Wl,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw Error(a(268,Object.keys(e)))}return e=null===(e=nt(t))?null:e.stateNode},t.flushSync=function(e,t){if(0!=(48&_u))throw Error(a(187));var n=_u;_u|=1;try{return Vi(99,e.bind(null,t))}finally{_u=n,Gi()}},t.hydrate=function(e,t,n){if(!Bl(t))throw Error(a(200));return Vl(null,e,t,!0,n)},t.render=function(e,t,n){if(!Bl(t))throw Error(a(200));return Vl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Bl(e))throw Error(a(40));return!!e._reactRootContainer&&(tl((function(){Vl(null,null,e,!1,(function(){e._reactRootContainer=null,e[kn]=null}))})),!0)},t.unstable_batchedUpdates=el,t.unstable_createPortal=function(e,t){return Wl(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Bl(n))throw Error(a(200));if(null==e||void 0===e._reactInternalFiber)throw Error(a(38));return Vl(e,t,n,!1,r)},t.version="16.13.1"},function(e,t,n){"use strict";e.exports=n(25)},function(e,t,n){"use strict";
/** @license React v0.19.1
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r,i,o,a,u;if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,s=null,c=function(){if(null!==l)try{var e=t.unstable_now();l(!0,e),l=null}catch(e){throw setTimeout(c,0),e}},f=Date.now();t.unstable_now=function(){return Date.now()-f},r=function(e){null!==l?setTimeout(r,0,e):(l=e,setTimeout(c,0))},i=function(e,t){s=setTimeout(e,t)},o=function(){clearTimeout(s)},a=function(){return!1},u=t.unstable_forceFrameRate=function(){}}else{var d=window.performance,p=window.Date,h=window.setTimeout,m=window.clearTimeout;if("undefined"!=typeof console){var g=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof g&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"==typeof d&&"function"==typeof d.now)t.unstable_now=function(){return d.now()};else{var v=p.now();t.unstable_now=function(){return p.now()-v}}var y=!1,b=null,w=-1,E=5,T=0;a=function(){return t.unstable_now()>=T},u=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):E=0<e?Math.floor(1e3/e):5};var _=new MessageChannel,S=_.port2;_.port1.onmessage=function(){if(null!==b){var e=t.unstable_now();T=e+E;try{b(!0,e)?S.postMessage(null):(y=!1,b=null)}catch(e){throw S.postMessage(null),e}}else y=!1},r=function(e){b=e,y||(y=!0,S.postMessage(null))},i=function(e,n){w=h((function(){e(t.unstable_now())}),n)},o=function(){m(w),w=-1}}function x(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<A(i,t)))break e;e[r]=t,e[n]=i,n=r}}function k(e){return void 0===(e=e[0])?null:e}function C(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var o=2*(r+1)-1,a=e[o],u=o+1,l=e[u];if(void 0!==a&&0>A(a,n))void 0!==l&&0>A(l,a)?(e[r]=l,e[u]=n,r=u):(e[r]=a,e[o]=n,r=o);else{if(!(void 0!==l&&0>A(l,n)))break e;e[r]=l,e[u]=n,r=u}}}return t}return null}function A(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var O=[],P=[],N=1,I=null,R=3,M=!1,L=!1,D=!1;function U(e){for(var t=k(P);null!==t;){if(null===t.callback)C(P);else{if(!(t.startTime<=e))break;C(P),t.sortIndex=t.expirationTime,x(O,t)}t=k(P)}}function j(e){if(D=!1,U(e),!L)if(null!==k(O))L=!0,r(F);else{var t=k(P);null!==t&&i(j,t.startTime-e)}}function F(e,n){L=!1,D&&(D=!1,o()),M=!0;var r=R;try{for(U(n),I=k(O);null!==I&&(!(I.expirationTime>n)||e&&!a());){var u=I.callback;if(null!==u){I.callback=null,R=I.priorityLevel;var l=u(I.expirationTime<=n);n=t.unstable_now(),"function"==typeof l?I.callback=l:I===k(O)&&C(O),U(n)}else C(O);I=k(O)}if(null!==I)var s=!0;else{var c=k(P);null!==c&&i(j,c.startTime-n),s=!1}return s}finally{I=null,R=r,M=!1}}function z(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var B=u;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){L||M||(L=!0,r(F))},t.unstable_getCurrentPriorityLevel=function(){return R},t.unstable_getFirstCallbackNode=function(){return k(O)},t.unstable_next=function(e){switch(R){case 1:case 2:case 3:var t=3;break;default:t=R}var n=R;R=t;try{return e()}finally{R=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=B,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=R;R=e;try{return t()}finally{R=n}},t.unstable_scheduleCallback=function(e,n,a){var u=t.unstable_now();if("object"==typeof a&&null!==a){var l=a.delay;l="number"==typeof l&&0<l?u+l:u,a="number"==typeof a.timeout?a.timeout:z(e)}else a=z(e),l=u;return e={id:N++,callback:n,priorityLevel:e,startTime:l,expirationTime:a=l+a,sortIndex:-1},l>u?(e.sortIndex=l,x(P,e),null===k(O)&&e===k(P)&&(D?o():D=!0,i(j,l-u))):(e.sortIndex=a,x(O,e),L||M||(L=!0,r(F))),e},t.unstable_shouldYield=function(){var e=t.unstable_now();U(e);var n=k(O);return n!==I&&null!==I&&null!==n&&null!==n.callback&&n.startTime<=e&&n.expirationTime<I.expirationTime||a()},t.unstable_wrapCallback=function(e){var t=R;return function(){var n=R;R=t;try{return e.apply(this,arguments)}finally{R=n}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=f(o),u=f(n(2)),l=f(n(10)),s=n(9),c=f(n(29));function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.handleLoad=function(){r.forceUpdate()},r._isMounted=!1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"componentDidMount",value:function(){this._isMounted=!0;var e=this.getDoc();e&&"complete"===e.readyState?this.forceUpdate():this.node.addEventListener("load",this.handleLoad)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.node.removeEventListener("load",this.handleLoad)}},{key:"getDoc",value:function(){return this.node?this.node.contentDocument:null}},{key:"getMountTarget",value:function(){var e=this.getDoc();return this.props.mountTarget?e.querySelector(this.props.mountTarget):e.body.children[0]}},{key:"renderFrameContents",value:function(){if(!this._isMounted)return null;var e=this.getDoc();if(!e)return null;var t=this.props.contentDidMount,n=this.props.contentDidUpdate,r=e.defaultView||e.parentView,i=a.default.createElement(c.default,{contentDidMount:t,contentDidUpdate:n},a.default.createElement(s.FrameContextProvider,{value:{document:e,window:r}},a.default.createElement("div",{className:"frame-content"},this.props.children)));e.body.children.length<1&&(e.open("text/html","replace"),e.write(this.props.initialContent),e.close());var o=this.getMountTarget();return[u.default.createPortal(this.props.head,this.getDoc().head),u.default.createPortal(i,o)]}},{key:"render",value:function(){var e=this,t=r({},this.props,{children:void 0});return delete t.head,delete t.initialContent,delete t.mountTarget,delete t.contentDidMount,delete t.contentDidUpdate,a.default.createElement("iframe",r({},t,{ref:function(t){e.node=t}}),this.renderFrameContents())}}]),t}(o.Component);d.propTypes={style:l.default.object,head:l.default.node,initialContent:l.default.string,mountTarget:l.default.string,contentDidMount:l.default.func,contentDidUpdate:l.default.func,children:l.default.oneOfType([l.default.element,l.default.arrayOf(l.default.element)])},d.defaultProps={style:{},head:null,children:void 0,mountTarget:void 0,contentDidMount:function(){},contentDidUpdate:function(){},initialContent:'<!DOCTYPE html><html><head></head><body><div class="frame-root"></div></body></html>'},t.default=d},function(e,t,n){"use strict";var r=n(28);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),o=(a(i),a(n(10)));function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var s=function(e){function t(){return u(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.props.contentDidMount()}},{key:"componentDidUpdate",value:function(){this.props.contentDidUpdate()}},{key:"render",value:function(){return i.Children.only(this.props.children)}}]),t}(i.Component);s.propTypes={children:o.default.element.isRequired,contentDidMount:o.default.func.isRequired,contentDidUpdate:o.default.func.isRequired},t.default=s},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i,o,a,u){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[n,r,i,o,a,u],c=0;(l=new Error(t.replace(/%s/g,(function(){return s[c++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},function(e,t){var n=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function r(e){return e?e.replace(/^\s+|\s+$/g,""):""}e.exports=function(e,t){t=t||{};var i=1,o=1;function a(e){var t=e.match(/\n/g);t&&(i+=t.length);var n=e.lastIndexOf("\n");o=~n?e.length-n:o+e.length}function u(){var e={line:i,column:o};return function(t){return t.position=new l(e),m(),t}}function l(e){this.start=e,this.end={line:i,column:o},this.source=t.source}l.prototype.content=e;var s=[];function c(n){var r=new Error(t.source+":"+i+":"+o+": "+n);if(r.reason=n,r.filename=t.source,r.line=i,r.column=o,r.source=e,!t.silent)throw r;s.push(r)}function f(){return h(/^{\s*/)}function d(){return h(/^}/)}function p(){var t,n=[];for(m(),g(n);e.length&&"}"!=e.charAt(0)&&(t=C()||A());)!1!==t&&(n.push(t),g(n));return n}function h(t){var n=t.exec(e);if(n){var r=n[0];return a(r),e=e.slice(r.length),n}}function m(){h(/^\s*/)}function g(e){var t;for(e=e||[];t=v();)!1!==t&&e.push(t);return e}function v(){var t=u();if("/"==e.charAt(0)&&"*"==e.charAt(1)){for(var n=2;""!=e.charAt(n)&&("*"!=e.charAt(n)||"/"!=e.charAt(n+1));)++n;if(n+=2,""===e.charAt(n-1))return c("End of comment missing");var r=e.slice(2,n-2);return o+=2,a(r),e=e.slice(n),o+=2,t({type:"comment",comment:r})}}function y(){var e=h(/^([^{]+)/);if(e)return r(e[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,(function(e){return e.replace(/,/g,"")})).split(/\s*(?![^(]*\)),\s*/).map((function(e){return e.replace(/\u200C/g,",")}))}function b(){var e=u(),t=h(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(t){if(t=r(t[0]),!h(/^:\s*/))return c("property missing ':'");var i=h(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),o=e({type:"declaration",property:t.replace(n,""),value:i?r(i[0]).replace(n,""):""});return h(/^[;\s]*/),o}}function w(){var e,t=[];if(!f())return c("missing '{'");for(g(t);e=b();)!1!==e&&(t.push(e),g(t));return d()?t:c("missing '}'")}function E(){for(var e,t=[],n=u();e=h(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]),h(/^,\s*/);if(t.length)return n({type:"keyframe",values:t,declarations:w()})}var T,_=k("import"),S=k("charset"),x=k("namespace");function k(e){var t=new RegExp("^@"+e+"\\s*([^;]+);");return function(){var n=u(),r=h(t);if(r){var i={type:e};return i[e]=r[1].trim(),n(i)}}}function C(){if("@"==e[0])return function(){var e=u();if(t=h(/^@([-\w]+)?keyframes\s*/)){var t,n=t[1];if(!(t=h(/^([-\w]+)\s*/)))return c("@keyframes missing name");var r,i=t[1];if(!f())return c("@keyframes missing '{'");for(var o=g();r=E();)o.push(r),o=o.concat(g());return d()?e({type:"keyframes",name:i,vendor:n,keyframes:o}):c("@keyframes missing '}'")}}()||function(){var e=u(),t=h(/^@media *([^{]+)/);if(t){var n=r(t[1]);if(!f())return c("@media missing '{'");var i=g().concat(p());return d()?e({type:"media",media:n,rules:i}):c("@media missing '}'")}}()||function(){var e=u(),t=h(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(t)return e({type:"custom-media",name:r(t[1]),media:r(t[2])})}()||function(){var e=u(),t=h(/^@supports *([^{]+)/);if(t){var n=r(t[1]);if(!f())return c("@supports missing '{'");var i=g().concat(p());return d()?e({type:"supports",supports:n,rules:i}):c("@supports missing '}'")}}()||_()||S()||x()||function(){var e=u(),t=h(/^@([-\w]+)?document *([^{]+)/);if(t){var n=r(t[1]),i=r(t[2]);if(!f())return c("@document missing '{'");var o=g().concat(p());return d()?e({type:"document",document:i,vendor:n,rules:o}):c("@document missing '}'")}}()||function(){var e=u();if(h(/^@page */)){var t=y()||[];if(!f())return c("@page missing '{'");for(var n,r=g();n=b();)r.push(n),r=r.concat(g());return d()?e({type:"page",selectors:t,declarations:r}):c("@page missing '}'")}}()||function(){var e=u();if(h(/^@host\s*/)){if(!f())return c("@host missing '{'");var t=g().concat(p());return d()?e({type:"host",rules:t}):c("@host missing '}'")}}()||function(){var e=u();if(h(/^@font-face\s*/)){if(!f())return c("@font-face missing '{'");for(var t,n=g();t=b();)n.push(t),n=n.concat(g());return d()?e({type:"font-face",declarations:n}):c("@font-face missing '}'")}}()}function A(){var e=u(),t=y();return t?(g(),e({type:"rule",selectors:t,declarations:w()})):c("selector missing")}return function e(t,n){var r=t&&"string"==typeof t.type,i=r?t:n;for(var o in t){var a=t[o];Array.isArray(a)?a.forEach((function(t){e(t,i)})):a&&"object"==typeof a&&e(a,i)}r&&Object.defineProperty(t,"parent",{configurable:!0,writable:!0,enumerable:!1,value:n||null});return t}((T=p(),{type:"stylesheet",stylesheet:{source:t.source,rules:T,parsingErrors:s}}))}},function(e,t,n){var r=n(33),i=n(34);e.exports=function(e,t){var o=(t=t||{}).compress?new r(t):new i(t);if(t.sourcemap){n(35)(o);var a=o.compile(e);return o.applySourceMaps(),{code:a,map:"generator"===t.sourcemap?o.map:o.map.toJSON()}}return a=o.compile(e)}},function(e,t,n){var r=n(11),i=n(12);function o(e){r.call(this,e)}e.exports=o,i(o,r),o.prototype.compile=function(e){return e.stylesheet.rules.map(this.visit,this).join("")},o.prototype.comment=function(e){return this.emit("",e.position)},o.prototype.import=function(e){return this.emit("@import "+e.import+";",e.position)},o.prototype.media=function(e){return this.emit("@media "+e.media,e.position)+this.emit("{")+this.mapVisit(e.rules)+this.emit("}")},o.prototype.document=function(e){var t="@"+(e.vendor||"")+"document "+e.document;return this.emit(t,e.position)+this.emit("{")+this.mapVisit(e.rules)+this.emit("}")},o.prototype.charset=function(e){return this.emit("@charset "+e.charset+";",e.position)},o.prototype.namespace=function(e){return this.emit("@namespace "+e.namespace+";",e.position)},o.prototype.supports=function(e){return this.emit("@supports "+e.supports,e.position)+this.emit("{")+this.mapVisit(e.rules)+this.emit("}")},o.prototype.keyframes=function(e){return this.emit("@"+(e.vendor||"")+"keyframes "+e.name,e.position)+this.emit("{")+this.mapVisit(e.keyframes)+this.emit("}")},o.prototype.keyframe=function(e){var t=e.declarations;return this.emit(e.values.join(","),e.position)+this.emit("{")+this.mapVisit(t)+this.emit("}")},o.prototype.page=function(e){var t=e.selectors.length?e.selectors.join(", "):"";return this.emit("@page "+t,e.position)+this.emit("{")+this.mapVisit(e.declarations)+this.emit("}")},o.prototype["font-face"]=function(e){return this.emit("@font-face",e.position)+this.emit("{")+this.mapVisit(e.declarations)+this.emit("}")},o.prototype.host=function(e){return this.emit("@host",e.position)+this.emit("{")+this.mapVisit(e.rules)+this.emit("}")},o.prototype["custom-media"]=function(e){return this.emit("@custom-media "+e.name+" "+e.media+";",e.position)},o.prototype.rule=function(e){var t=e.declarations;return t.length?this.emit(e.selectors.join(","),e.position)+this.emit("{")+this.mapVisit(t)+this.emit("}"):""},o.prototype.declaration=function(e){return this.emit(e.property+":"+e.value,e.position)+this.emit(";")}},function(e,t,n){var r=n(11),i=n(12);function o(e){e=e||{},r.call(this,e),this.indentation=e.indent}e.exports=o,i(o,r),o.prototype.compile=function(e){return this.stylesheet(e)},o.prototype.stylesheet=function(e){return this.mapVisit(e.stylesheet.rules,"\n\n")},o.prototype.comment=function(e){return this.emit(this.indent()+"/*"+e.comment+"*/",e.position)},o.prototype.import=function(e){return this.emit("@import "+e.import+";",e.position)},o.prototype.media=function(e){return this.emit("@media "+e.media,e.position)+this.emit(" {\n"+this.indent(1))+this.mapVisit(e.rules,"\n\n")+this.emit(this.indent(-1)+"\n}")},o.prototype.document=function(e){var t="@"+(e.vendor||"")+"document "+e.document;return this.emit(t,e.position)+this.emit("  {\n"+this.indent(1))+this.mapVisit(e.rules,"\n\n")+this.emit(this.indent(-1)+"\n}")},o.prototype.charset=function(e){return this.emit("@charset "+e.charset+";",e.position)},o.prototype.namespace=function(e){return this.emit("@namespace "+e.namespace+";",e.position)},o.prototype.supports=function(e){return this.emit("@supports "+e.supports,e.position)+this.emit(" {\n"+this.indent(1))+this.mapVisit(e.rules,"\n\n")+this.emit(this.indent(-1)+"\n}")},o.prototype.keyframes=function(e){return this.emit("@"+(e.vendor||"")+"keyframes "+e.name,e.position)+this.emit(" {\n"+this.indent(1))+this.mapVisit(e.keyframes,"\n")+this.emit(this.indent(-1)+"}")},o.prototype.keyframe=function(e){var t=e.declarations;return this.emit(this.indent())+this.emit(e.values.join(", "),e.position)+this.emit(" {\n"+this.indent(1))+this.mapVisit(t,"\n")+this.emit(this.indent(-1)+"\n"+this.indent()+"}\n")},o.prototype.page=function(e){var t=e.selectors.length?e.selectors.join(", ")+" ":"";return this.emit("@page "+t,e.position)+this.emit("{\n")+this.emit(this.indent(1))+this.mapVisit(e.declarations,"\n")+this.emit(this.indent(-1))+this.emit("\n}")},o.prototype["font-face"]=function(e){return this.emit("@font-face ",e.position)+this.emit("{\n")+this.emit(this.indent(1))+this.mapVisit(e.declarations,"\n")+this.emit(this.indent(-1))+this.emit("\n}")},o.prototype.host=function(e){return this.emit("@host",e.position)+this.emit(" {\n"+this.indent(1))+this.mapVisit(e.rules,"\n\n")+this.emit(this.indent(-1)+"\n}")},o.prototype["custom-media"]=function(e){return this.emit("@custom-media "+e.name+" "+e.media+";",e.position)},o.prototype.rule=function(e){var t=this.indent(),n=e.declarations;return n.length?this.emit(e.selectors.map((function(e){return t+e})).join(",\n"),e.position)+this.emit(" {\n")+this.emit(this.indent(1))+this.mapVisit(n,"\n")+this.emit(this.indent(-1))+this.emit("\n"+this.indent()+"}"):""},o.prototype.declaration=function(e){return this.emit(this.indent())+this.emit(e.property+": "+e.value,e.position)+this.emit(";")},o.prototype.indent=function(e){return this.level=this.level||1,null!=e?(this.level+=e,""):Array(this.level).join(this.indentation||"  ")}},function(e,t,n){var r=n(13).SourceMapGenerator,i=n(13).SourceMapConsumer,o=n(42),a=n(57),u=n(19);e.exports=function(e){for(var n in e._comment=e.comment,e.map=new r,e.position={line:1,column:1},e.files={},t)e[n]=t[n]};const l=function(e){return"\\"===u.sep?e.replace(/\\/g,"/").replace(/^[a-z]:\/?/i,"/"):e};t.updatePosition=function(e){var t=e.match(/\n/g);t&&(this.position.line+=t.length);var n=e.lastIndexOf("\n");this.position.column=~n?e.length-n:this.position.column+e.length},t.emit=function(e,t){if(t){var n=l(t.source||"source.css");this.map.addMapping({source:n,generated:{line:this.position.line,column:Math.max(this.position.column-1,0)},original:{line:t.start.line,column:t.start.column-1}}),this.addFile(n,t)}return this.updatePosition(e),e},t.addFile=function(e,t){"string"==typeof t.content&&(Object.prototype.hasOwnProperty.call(this.files,e)||(this.files[e]=t.content))},t.applySourceMaps=function(){Object.keys(this.files).forEach((function(e){var t=this.files[e];if(this.map.setSourceContent(e,t),!1!==this.options.inputSourcemaps){var n=o.resolveSync(t,e,a.readFileSync);if(n){var r=new i(n.map),s=n.sourcesRelativeTo;this.map.applySourceMap(r,e,l(u.dirname(s)))}}}),this)},t.comment=function(e){return/^# sourceMappingURL=/.test(e.comment)?this.emit("",e.position):this._comment(e)}},function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},t.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},function(e,t,n){var r=n(3);function i(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}i.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)},i.prototype.add=function(e){var t,n,i,o,a,u;t=this._last,n=e,i=t.generatedLine,o=n.generatedLine,a=t.generatedColumn,u=n.generatedColumn,o>i||o==i&&u>=a||r.compareByGeneratedPositionsInflated(t,n)<=0?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))},i.prototype.toArray=function(){return this._sorted||(this._array.sort(r.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},t.MappingList=i},function(e,t,n){var r=n(3),i=n(39),o=n(16).ArraySet,a=n(15),u=n(40).quickSort;function l(e,t){var n=e;return"string"==typeof e&&(n=r.parseSourceMapInput(e)),null!=n.sections?new f(n,t):new s(n,t)}function s(e,t){var n=e;"string"==typeof e&&(n=r.parseSourceMapInput(e));var i=r.getArg(n,"version"),a=r.getArg(n,"sources"),u=r.getArg(n,"names",[]),l=r.getArg(n,"sourceRoot",null),s=r.getArg(n,"sourcesContent",null),c=r.getArg(n,"mappings"),f=r.getArg(n,"file",null);if(i!=this._version)throw new Error("Unsupported version: "+i);l&&(l=r.normalize(l)),a=a.map(String).map(r.normalize).map((function(e){return l&&r.isAbsolute(l)&&r.isAbsolute(e)?r.relative(l,e):e})),this._names=o.fromArray(u.map(String),!0),this._sources=o.fromArray(a,!0),this._absoluteSources=this._sources.toArray().map((function(e){return r.computeSourceURL(l,e,t)})),this.sourceRoot=l,this.sourcesContent=s,this._mappings=c,this._sourceMapURL=t,this.file=f}function c(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function f(e,t){var n=e;"string"==typeof e&&(n=r.parseSourceMapInput(e));var i=r.getArg(n,"version"),a=r.getArg(n,"sections");if(i!=this._version)throw new Error("Unsupported version: "+i);this._sources=new o,this._names=new o;var u={line:-1,column:0};this._sections=a.map((function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var n=r.getArg(e,"offset"),i=r.getArg(n,"line"),o=r.getArg(n,"column");if(i<u.line||i===u.line&&o<u.column)throw new Error("Section offsets must be ordered and non-overlapping.");return u=n,{generatedOffset:{generatedLine:i+1,generatedColumn:o+1},consumer:new l(r.getArg(e,"map"),t)}}))}l.fromSourceMap=function(e,t){return s.fromSourceMap(e,t)},l.prototype._version=3,l.prototype.__generatedMappings=null,Object.defineProperty(l.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),l.prototype.__originalMappings=null,Object.defineProperty(l.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),l.prototype._charIsMappingSeparator=function(e,t){var n=e.charAt(t);return";"===n||","===n},l.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},l.GENERATED_ORDER=1,l.ORIGINAL_ORDER=2,l.GREATEST_LOWER_BOUND=1,l.LEAST_UPPER_BOUND=2,l.prototype.eachMapping=function(e,t,n){var i,o=t||null;switch(n||l.GENERATED_ORDER){case l.GENERATED_ORDER:i=this._generatedMappings;break;case l.ORIGINAL_ORDER:i=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var a=this.sourceRoot;i.map((function(e){var t=null===e.source?null:this._sources.at(e.source);return{source:t=r.computeSourceURL(a,t,this._sourceMapURL),generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}}),this).forEach(e,o)},l.prototype.allGeneratedPositionsFor=function(e){var t=r.getArg(e,"line"),n={source:r.getArg(e,"source"),originalLine:t,originalColumn:r.getArg(e,"column",0)};if(n.source=this._findSourceIndex(n.source),n.source<0)return[];var o=[],a=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",r.compareByOriginalPositions,i.LEAST_UPPER_BOUND);if(a>=0){var u=this._originalMappings[a];if(void 0===e.column)for(var l=u.originalLine;u&&u.originalLine===l;)o.push({line:r.getArg(u,"generatedLine",null),column:r.getArg(u,"generatedColumn",null),lastColumn:r.getArg(u,"lastGeneratedColumn",null)}),u=this._originalMappings[++a];else for(var s=u.originalColumn;u&&u.originalLine===t&&u.originalColumn==s;)o.push({line:r.getArg(u,"generatedLine",null),column:r.getArg(u,"generatedColumn",null),lastColumn:r.getArg(u,"lastGeneratedColumn",null)}),u=this._originalMappings[++a]}return o},t.SourceMapConsumer=l,s.prototype=Object.create(l.prototype),s.prototype.consumer=l,s.prototype._findSourceIndex=function(e){var t,n=e;if(null!=this.sourceRoot&&(n=r.relative(this.sourceRoot,n)),this._sources.has(n))return this._sources.indexOf(n);for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==e)return t;return-1},s.fromSourceMap=function(e,t){var n=Object.create(s.prototype),i=n._names=o.fromArray(e._names.toArray(),!0),a=n._sources=o.fromArray(e._sources.toArray(),!0);n.sourceRoot=e._sourceRoot,n.sourcesContent=e._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=e._file,n._sourceMapURL=t,n._absoluteSources=n._sources.toArray().map((function(e){return r.computeSourceURL(n.sourceRoot,e,t)}));for(var l=e._mappings.toArray().slice(),f=n.__generatedMappings=[],d=n.__originalMappings=[],p=0,h=l.length;p<h;p++){var m=l[p],g=new c;g.generatedLine=m.generatedLine,g.generatedColumn=m.generatedColumn,m.source&&(g.source=a.indexOf(m.source),g.originalLine=m.originalLine,g.originalColumn=m.originalColumn,m.name&&(g.name=i.indexOf(m.name)),d.push(g)),f.push(g)}return u(n.__originalMappings,r.compareByOriginalPositions),n},s.prototype._version=3,Object.defineProperty(s.prototype,"sources",{get:function(){return this._absoluteSources.slice()}}),s.prototype._parseMappings=function(e,t){for(var n,i,o,l,s,f=1,d=0,p=0,h=0,m=0,g=0,v=e.length,y=0,b={},w={},E=[],T=[];y<v;)if(";"===e.charAt(y))f++,y++,d=0;else if(","===e.charAt(y))y++;else{for((n=new c).generatedLine=f,l=y;l<v&&!this._charIsMappingSeparator(e,l);l++);if(o=b[i=e.slice(y,l)])y+=i.length;else{for(o=[];y<l;)a.decode(e,y,w),s=w.value,y=w.rest,o.push(s);if(2===o.length)throw new Error("Found a source, but no line and column");if(3===o.length)throw new Error("Found a source and line, but no column");b[i]=o}n.generatedColumn=d+o[0],d=n.generatedColumn,o.length>1&&(n.source=m+o[1],m+=o[1],n.originalLine=p+o[2],p=n.originalLine,n.originalLine+=1,n.originalColumn=h+o[3],h=n.originalColumn,o.length>4&&(n.name=g+o[4],g+=o[4])),T.push(n),"number"==typeof n.originalLine&&E.push(n)}u(T,r.compareByGeneratedPositionsDeflated),this.__generatedMappings=T,u(E,r.compareByOriginalPositions),this.__originalMappings=E},s.prototype._findMapping=function(e,t,n,r,o,a){if(e[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[n]);if(e[r]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[r]);return i.search(e,t,o,a)},s.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var n=this._generatedMappings[e+1];if(t.generatedLine===n.generatedLine){t.lastGeneratedColumn=n.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},s.prototype.originalPositionFor=function(e){var t={generatedLine:r.getArg(e,"line"),generatedColumn:r.getArg(e,"column")},n=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",r.compareByGeneratedPositionsDeflated,r.getArg(e,"bias",l.GREATEST_LOWER_BOUND));if(n>=0){var i=this._generatedMappings[n];if(i.generatedLine===t.generatedLine){var o=r.getArg(i,"source",null);null!==o&&(o=this._sources.at(o),o=r.computeSourceURL(this.sourceRoot,o,this._sourceMapURL));var a=r.getArg(i,"name",null);return null!==a&&(a=this._names.at(a)),{source:o,line:r.getArg(i,"originalLine",null),column:r.getArg(i,"originalColumn",null),name:a}}}return{source:null,line:null,column:null,name:null}},s.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&(this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return null==e})))},s.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var n=this._findSourceIndex(e);if(n>=0)return this.sourcesContent[n];var i,o=e;if(null!=this.sourceRoot&&(o=r.relative(this.sourceRoot,o)),null!=this.sourceRoot&&(i=r.urlParse(this.sourceRoot))){var a=o.replace(/^file:\/\//,"");if("file"==i.scheme&&this._sources.has(a))return this.sourcesContent[this._sources.indexOf(a)];if((!i.path||"/"==i.path)&&this._sources.has("/"+o))return this.sourcesContent[this._sources.indexOf("/"+o)]}if(t)return null;throw new Error('"'+o+'" is not in the SourceMap.')},s.prototype.generatedPositionFor=function(e){var t=r.getArg(e,"source");if((t=this._findSourceIndex(t))<0)return{line:null,column:null,lastColumn:null};var n={source:t,originalLine:r.getArg(e,"line"),originalColumn:r.getArg(e,"column")},i=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",r.compareByOriginalPositions,r.getArg(e,"bias",l.GREATEST_LOWER_BOUND));if(i>=0){var o=this._originalMappings[i];if(o.source===n.source)return{line:r.getArg(o,"generatedLine",null),column:r.getArg(o,"generatedColumn",null),lastColumn:r.getArg(o,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},t.BasicSourceMapConsumer=s,f.prototype=Object.create(l.prototype),f.prototype.constructor=l,f.prototype._version=3,Object.defineProperty(f.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var n=0;n<this._sections[t].consumer.sources.length;n++)e.push(this._sections[t].consumer.sources[n]);return e}}),f.prototype.originalPositionFor=function(e){var t={generatedLine:r.getArg(e,"line"),generatedColumn:r.getArg(e,"column")},n=i.search(t,this._sections,(function(e,t){var n=e.generatedLine-t.generatedOffset.generatedLine;return n||e.generatedColumn-t.generatedOffset.generatedColumn})),o=this._sections[n];return o?o.consumer.originalPositionFor({line:t.generatedLine-(o.generatedOffset.generatedLine-1),column:t.generatedColumn-(o.generatedOffset.generatedLine===t.generatedLine?o.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},f.prototype.hasContentsOfAllSources=function(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))},f.prototype.sourceContentFor=function(e,t){for(var n=0;n<this._sections.length;n++){var r=this._sections[n].consumer.sourceContentFor(e,!0);if(r)return r}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},f.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var n=this._sections[t];if(-1!==n.consumer._findSourceIndex(r.getArg(e,"source"))){var i=n.consumer.generatedPositionFor(e);if(i)return{line:i.line+(n.generatedOffset.generatedLine-1),column:i.column+(n.generatedOffset.generatedLine===i.line?n.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},f.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var i=this._sections[n],o=i.consumer._generatedMappings,a=0;a<o.length;a++){var l=o[a],s=i.consumer._sources.at(l.source);s=r.computeSourceURL(i.consumer.sourceRoot,s,this._sourceMapURL),this._sources.add(s),s=this._sources.indexOf(s);var c=null;l.name&&(c=i.consumer._names.at(l.name),this._names.add(c),c=this._names.indexOf(c));var f={source:s,generatedLine:l.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:l.generatedColumn+(i.generatedOffset.generatedLine===l.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:l.originalLine,originalColumn:l.originalColumn,name:c};this.__generatedMappings.push(f),"number"==typeof f.originalLine&&this.__originalMappings.push(f)}u(this.__generatedMappings,r.compareByGeneratedPositionsDeflated),u(this.__originalMappings,r.compareByOriginalPositions)},t.IndexedSourceMapConsumer=f},function(e,t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,n,r,i){if(0===n.length)return-1;var o=function e(n,r,i,o,a,u){var l=Math.floor((r-n)/2)+n,s=a(i,o[l],!0);return 0===s?l:s>0?r-l>1?e(l,r,i,o,a,u):u==t.LEAST_UPPER_BOUND?r<o.length?r:-1:l:l-n>1?e(n,l,i,o,a,u):u==t.LEAST_UPPER_BOUND?l:n<0?-1:n}(-1,n.length,e,n,r,i||t.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&0===r(n[o],n[o-1],!0);)--o;return o}},function(e,t){function n(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function r(e,t,i,o){if(i<o){var a=i-1;n(e,(c=i,f=o,Math.round(c+Math.random()*(f-c))),o);for(var u=e[o],l=i;l<o;l++)t(e[l],u)<=0&&n(e,a+=1,l);n(e,a+1,l);var s=a+1;r(e,t,i,s-1),r(e,t,s+1,o)}var c,f}t.quickSort=function(e,t){r(e,t,0,e.length-1)}},function(e,t,n){var r=n(14).SourceMapGenerator,i=n(3),o=/(\r?\n)/,a="$$$isSourceNode$$$";function u(e,t,n,r,i){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==n?null:n,this.name=null==i?null:i,this[a]=!0,null!=r&&this.add(r)}u.fromStringWithSourceMap=function(e,t,n){var r=new u,a=e.split(o),l=0,s=function(){return e()+(e()||"");function e(){return l<a.length?a[l++]:void 0}},c=1,f=0,d=null;return t.eachMapping((function(e){if(null!==d){if(!(c<e.generatedLine)){var t=(n=a[l]||"").substr(0,e.generatedColumn-f);return a[l]=n.substr(e.generatedColumn-f),f=e.generatedColumn,p(d,t),void(d=e)}p(d,s()),c++,f=0}for(;c<e.generatedLine;)r.add(s()),c++;if(f<e.generatedColumn){var n=a[l]||"";r.add(n.substr(0,e.generatedColumn)),a[l]=n.substr(e.generatedColumn),f=e.generatedColumn}d=e}),this),l<a.length&&(d&&p(d,s()),r.add(a.splice(l).join(""))),t.sources.forEach((function(e){var o=t.sourceContentFor(e);null!=o&&(null!=n&&(e=i.join(n,e)),r.setSourceContent(e,o))})),r;function p(e,t){if(null===e||void 0===e.source)r.add(t);else{var o=n?i.join(n,e.source):e.source;r.add(new u(e.originalLine,e.originalColumn,o,t,e.name))}}},u.prototype.add=function(e){if(Array.isArray(e))e.forEach((function(e){this.add(e)}),this);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this},u.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this},u.prototype.walk=function(e){for(var t,n=0,r=this.children.length;n<r;n++)(t=this.children[n])[a]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})},u.prototype.join=function(e){var t,n,r=this.children.length;if(r>0){for(t=[],n=0;n<r-1;n++)t.push(this.children[n]),t.push(e);t.push(this.children[n]),this.children=t}return this},u.prototype.replaceRight=function(e,t){var n=this.children[this.children.length-1];return n[a]?n.replaceRight(e,t):"string"==typeof n?this.children[this.children.length-1]=n.replace(e,t):this.children.push("".replace(e,t)),this},u.prototype.setSourceContent=function(e,t){this.sourceContents[i.toSetString(e)]=t},u.prototype.walkSourceContents=function(e){for(var t=0,n=this.children.length;t<n;t++)this.children[t][a]&&this.children[t].walkSourceContents(e);var r=Object.keys(this.sourceContents);for(t=0,n=r.length;t<n;t++)e(i.fromSetString(r[t]),this.sourceContents[r[t]])},u.prototype.toString=function(){var e="";return this.walk((function(t){e+=t})),e},u.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},n=new r(e),i=!1,o=null,a=null,u=null,l=null;return this.walk((function(e,r){t.code+=e,null!==r.source&&null!==r.line&&null!==r.column?(o===r.source&&a===r.line&&u===r.column&&l===r.name||n.addMapping({source:r.source,original:{line:r.line,column:r.column},generated:{line:t.line,column:t.column},name:r.name}),o=r.source,a=r.line,u=r.column,l=r.name,i=!0):i&&(n.addMapping({generated:{line:t.line,column:t.column}}),o=null,i=!1);for(var s=0,c=e.length;s<c;s++)10===e.charCodeAt(s)?(t.line++,t.column=0,s+1===c?(o=null,i=!1):i&&n.addMapping({source:r.source,original:{line:r.line,column:r.column},generated:{line:t.line,column:t.column},name:r.name})):t.column++})),this.walkSourceContents((function(e,t){n.setSourceContent(e,t)})),{code:t.code,map:n}},t.SourceNode=u},function(e,t,n){(function(t){var r=n(45),i=n(50),o=n(19),a=n(56);function u(){return Array.prototype.reduce.call(arguments,(function(e,t){return i.resolve(e,t)}))}function l(e){return"\\"===o.sep?e.replace(/\\/g,"/").replace(/^[a-z]:\/?/i,"/"):e}function s(e){return a(e.replace(/\+/g,"%2B"))}function c(e,n,r){t((function(){e(n,r)}))}function f(e,t){try{return JSON.parse(e.replace(/^\)\]\}'/,""))}catch(e){throw e.sourceMapData=t,e}}function d(e,t,n){var r=s(t);try{return String(e(r))}catch(e){throw e.sourceMapData=n,e}}var p=/[#@] sourceMappingURL=([^\s'"]*)/,h=RegExp("(?:/\\*(?:\\s*\r?\n(?://)?)?(?:"+p.source+")\\s*\\*/|//(?:"+p.source+"))\\s*");function m(e,t,n,r){var i;try{i=w(e,t)}catch(e){return c(r,e)}if(!i||i.map)return c(r,null,i);n(s(i.url),(function(e,t){if(e)return e.sourceMapData=i,r(e);i.map=String(t);try{i.map=f(i.map,i)}catch(e){return r(e)}r(null,i)}))}function g(e,t,n){var r=w(e,t);return!r||r.map||(r.map=d(n,r.url,r),r.map=f(r.map,r)),r}var v=/^data:([^,;]*)(;[^,;]*)*(?:,(.*))?$/,y=/^(?:application|text)\/json$/;function b(e){if("undefined"==typeof TextDecoder||"undefined"==typeof Uint8Array)return r(e);var t=function(e){for(var t=r(e),n=t.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=t.charCodeAt(o);return i}(e);return new TextDecoder("utf-8",{fatal:!0}).decode(t)}function w(e,t){t=l(t);var n=function(e){var t=e.match(h);return t?t[1]||t[2]||"":null}(e);if(!n)return null;var r=n.match(v);if(r){var i=r[1]||"text/plain",o=r[2]||"",a=r[3]||"",s={sourceMappingURL:n,url:null,sourcesRelativeTo:t,map:a};if(!y.test(i)){var c=new Error("Unuseful data uri mime type: "+i);throw c.sourceMapData=s,c}try{s.map=f(";base64"===o?b(a):decodeURIComponent(a),s)}catch(c){throw c.sourceMapData=s,c}return s}var d=u(t,n);return{sourceMappingURL:n,url:d,sourcesRelativeTo:d,map:null}}function E(e,t,n,r,i){"function"==typeof r&&(i=r,r={});var o=e.sources?e.sources.length:0,a={sourcesResolved:[],sourcesContent:[]};if(0!==o){var u=function(){0===--o&&i(null,a)};S(e,t,r,(function(e,t,r){if(a.sourcesResolved[r]=e,"string"==typeof t)a.sourcesContent[r]=t,c(u,null);else{var i=s(e);n(i,(function(e,t){a.sourcesContent[r]=e||String(t),u()}))}}))}else c(i,null,a)}function T(e,t,n,r){var i={sourcesResolved:[],sourcesContent:[]};return e.sources&&0!==e.sources.length?(S(e,t,r,(function(e,t,r){if(i.sourcesResolved[r]=e,null!==n)if("string"==typeof t)i.sourcesContent[r]=t;else{var o=s(e);try{i.sourcesContent[r]=String(n(o))}catch(e){i.sourcesContent[r]=e}}})),i):i}var _=/\/?$/;function S(e,t,n,r){var i;n=n||{},t=l(t);for(var o=0,a=e.sources.length;o<a;o++)i=null,"string"==typeof n.sourceRoot?i=n.sourceRoot:"string"==typeof e.sourceRoot&&!1!==n.sourceRoot&&(i=e.sourceRoot),r(null===i||""===i?u(t,e.sources[o]):u(t,i.replace(_,"/"),e.sources[o]),(e.sourcesContent||[])[o],o)}e.exports={resolveSourceMap:m,resolveSourceMapSync:g,resolveSources:E,resolveSourcesSync:T,resolve:function(e,t,n,r,i){if("function"==typeof r&&(i=r,r={}),null===e){var o={sourceMappingURL:null,url:t,sourcesRelativeTo:t,map:null},a=s(t);n(a,(function(e,t){if(e)return e.sourceMapData=o,i(e);o.map=String(t);try{o.map=f(o.map,o)}catch(e){return i(e)}u(o)}))}else m(e,t,n,(function(e,t){return e?i(e):t?void u(t):i(null,null)}));function u(e){E(e.map,e.sourcesRelativeTo,n,r,(function(t,n){if(t)return i(t);e.sourcesResolved=n.sourcesResolved,e.sourcesContent=n.sourcesContent,i(null,e)}))}},resolveSync:function(e,t,n,r){var i;if(null===e){(i={sourceMappingURL:null,url:t,sourcesRelativeTo:t,map:null}).map=d(n,t,i),i.map=f(i.map,i)}else if(!(i=g(e,t,n)))return null;var o=T(i.map,i.sourcesRelativeTo,n,r);return i.sourcesResolved=o.sourcesResolved,i.sourcesContent=o.sourcesContent,i},parseMapToJSON:f}}).call(this,n(43).setImmediate)},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(44),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(4))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i,o,a,u,l=1,s={},c=!1,f=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){h(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){h(e.data)},r=function(e){o.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(i=f.documentElement,r=function(e){var t=f.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):r=function(e){setTimeout(h,0,e)}:(a="setImmediate$"+Math.random()+"$",u=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&h(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",u,!1):e.attachEvent("onmessage",u),r=function(t){e.postMessage(a+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return s[l]=i,r(l),l++},d.clearImmediate=p}function p(e){delete s[e]}function h(e){if(c)setTimeout(h,0,e);else{var t=s[e];if(t){c=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{p(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(4),n(17))},function(e,t,n){(function(e,t){!function(n){"use strict";var r,i="function"==typeof(r=n.atob)?r:"function"==typeof e?function(t){
//!! Deliberately using an API that's deprecated in node.js because
//!! this file is for browsers and we expect them to cope with it.
//!! Discussion: github.com/node-browser-compat/atob/pull/9
return new e(t,"base64").toString("binary")}:"object"==typeof n.base64js?function(e){var t=n.base64js.b64ToByteArray(e);return Array.prototype.map.call(t,(function(e){return String.fromCharCode(e)})).join("")}:function(){throw new Error("You're probably in an old browser or an iOS webworker. It might help to include beatgammit's base64-js.")};n.atob=i,t&&t.exports&&(t.exports=i)}(window)}).call(this,n(46).Buffer,n(18)(e))},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(47),i=n(48),o=n(49);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return s(this,e,t,n)}function s(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=d(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(t,n),i=(e=u(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|p(t.length);return 0===(e=u(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?u(e,0):d(e,t);if("Buffer"===t.type&&o(t.data))return d(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(c(t),e=u(e,t<0?0:0|p(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|p(t.length);e=u(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function h(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return B(e).length;default:if(r)return z(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,n);case"utf8":case"utf-8":return k(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return x(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var o,a=1,u=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,u/=2,l/=2,n/=2}function s(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var c=-1;for(o=n;o<u;o++)if(s(e,o)===s(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(n+l>u&&(n=u-l),o=n;o>=0;o--){for(var f=!0,d=0;d<l;d++)if(s(e,o+d)!==s(t,d)){f=!1;break}if(f)return o}return-1}function b(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var u=parseInt(t.substr(2*a,2),16);if(isNaN(u))return a;e[n+a]=u}return a}function w(e,t,n,r){return V(z(t,e.length-n),e,n,r)}function E(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function T(e,t,n,r){return E(e,t,n,r)}function _(e,t,n,r){return V(B(t),e,n,r)}function S(e,t,n,r){return V(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function x(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function k(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,u,l,s=e[i],c=null,f=s>239?4:s>223?3:s>191?2:1;if(i+f<=n)switch(f){case 1:s<128&&(c=s);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&s)<<6|63&o)>127&&(c=l);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(l=(15&s)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=e[i+1],a=e[i+2],u=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&u)&&(l=(15&s)<<18|(63&o)<<12|(63&a)<<6|63&u)>65535&&l<1114112&&(c=l)}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=f}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return s(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0?u(e,t):void 0!==n?"string"==typeof r?u(e,t).fill(n,r):u(e,t).fill(n):u(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return f(null,e)},l.allocUnsafeSlow=function(e){return f(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},l.byteLength=h,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?k(this,0,e):m.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,r,i){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),u=Math.min(o,a),s=this.slice(r,i),c=e.slice(t,n),f=0;f<u;++f)if(s[f]!==c[f]){o=s[f],a=c[f];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return E(this,e,t,n);case"latin1":case"binary":return T(this,e,t,n);case"base64":return _(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function O(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=F(e[o]);return i}function P(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function N(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,n,r,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function R(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function M(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function L(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(e,t,n,r,o){return o||L(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function U(e,t,n,r,o){return o||L(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var i=t-e;n=new l(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUInt8=function(e,t){return t||N(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||N(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||N(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||N(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||N(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||N(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||N(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||N(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||N(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||I(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||I(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):M(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);I(this,e,t,n,i-1,-i)}var o=0,a=1,u=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===u&&0!==this[t+o-1]&&(u=1),this[t+o]=(e/a>>0)-u&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);I(this,e,t,n,i-1,-i)}var o=n-1,a=1,u=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===u&&0!==this[t+o+1]&&(u=1),this[t+o]=(e/a>>0)-u&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):M(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=l.isBuffer(e)?e:z(new l(e,r).toString()),u=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%u]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function B(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(4))},function(e,t,n){"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=s(e),a=r[0],u=r[1],l=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,u)),c=0,f=u>0?a-4:a;for(n=0;n<f;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;2===u&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,l[c++]=255&t);1===u&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=0,u=n-i;a<u;a+=16383)o.push(c(e,a,a+16383>u?u:a+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,l=a.length;u<l;++u)r[u]=a[u],i[a.charCodeAt(u)]=u;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var i,o,a=[],u=t;u<n;u+=3)i=(e[u]<<16&16711680)+(e[u+1]<<8&65280)+(255&e[u+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,n,r,i){var o,a,u=8*i-r-1,l=(1<<u)-1,s=l>>1,c=-7,f=n?i-1:0,d=n?-1:1,p=e[t+f];for(f+=d,o=p&(1<<-c)-1,p>>=-c,c+=u;c>0;o=256*o+e[t+f],f+=d,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+e[t+f],f+=d,c-=8);if(0===o)o=1-s;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=s}return(p?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,u,l,s=8*o-i-1,c=(1<<s)-1,f=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+f>=1?d/l:d*Math.pow(2,1-f))*l>=2&&(a++,l/=2),a+f>=c?(u=0,a=c):a+f>=1?(u=(t*l-1)*Math.pow(2,i),a+=f):(u=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+p]=255&u,p+=h,u/=256,i-=8);for(a=a<<i|u,s+=i;s>0;e[n+p]=255&a,p+=h,a/=256,s-=8);e[n+p-h]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";var r=n(51),i=n(52);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){i.isString(e)&&(e=b(e));return e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var a=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,s=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),c=["'"].concat(s),f=["%","/","?",";","#"].concat(c),d=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(53);function b(e,t,n){if(e&&i.isObject(e)&&e instanceof o)return e;var r=new o;return r.parse(e,t,n),r}o.prototype.parse=function(e,t,n){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),u=-1!==o&&o<e.indexOf("#")?"?":"#",s=e.split(u);s[0]=s[0].replace(/\\/g,"/");var b=e=s.join(u);if(b=b.trim(),!n&&1===e.split("#").length){var w=l.exec(b);if(w)return this.path=b,this.href=b,this.pathname=w[1],w[2]?(this.search=w[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var E=a.exec(b);if(E){var T=(E=E[0]).toLowerCase();this.protocol=T,b=b.substr(E.length)}if(n||E||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var _="//"===b.substr(0,2);!_||E&&g[E]||(b=b.substr(2),this.slashes=!0)}if(!g[E]&&(_||E&&!v[E])){for(var S,x,k=-1,C=0;C<d.length;C++){-1!==(A=b.indexOf(d[C]))&&(-1===k||A<k)&&(k=A)}-1!==(x=-1===k?b.lastIndexOf("@"):b.lastIndexOf("@",k))&&(S=b.slice(0,x),b=b.slice(x+1),this.auth=decodeURIComponent(S)),k=-1;for(C=0;C<f.length;C++){var A;-1!==(A=b.indexOf(f[C]))&&(-1===k||A<k)&&(k=A)}-1===k&&(k=b.length),this.host=b.slice(0,k),b=b.slice(k),this.parseHost(),this.hostname=this.hostname||"";var O="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!O)for(var P=this.hostname.split(/\./),N=(C=0,P.length);C<N;C++){var I=P[C];if(I&&!I.match(p)){for(var R="",M=0,L=I.length;M<L;M++)I.charCodeAt(M)>127?R+="x":R+=I[M];if(!R.match(p)){var D=P.slice(0,C),U=P.slice(C+1),j=I.match(h);j&&(D.push(j[1]),U.unshift(j[2])),U.length&&(b="/"+U.join(".")+b),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),O||(this.hostname=r.toASCII(this.hostname));var F=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+F,this.href+=this.host,O&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!m[T])for(C=0,N=c.length;C<N;C++){var B=c[C];if(-1!==b.indexOf(B)){var V=encodeURIComponent(B);V===B&&(V=escape(B)),b=b.split(B).join(V)}}var H=b.indexOf("#");-1!==H&&(this.hash=b.substr(H),b=b.slice(0,H));var W=b.indexOf("?");if(-1!==W?(this.search=b.substr(W),this.query=b.substr(W+1),t&&(this.query=y.parse(this.query)),b=b.slice(0,W)):t&&(this.search="",this.query={}),b&&(this.pathname=b),v[T]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){F=this.pathname||"";var G=this.search||"";this.path=F+G}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,a="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(a=y.stringify(this.query));var u=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),u&&"?"!==u.charAt(0)&&(u="?"+u),t+o+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(u=u.replace("#","%23"))+r},o.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var n=new o,r=Object.keys(this),a=0;a<r.length;a++){var u=r[a];n[u]=this[u]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),s=0;s<l.length;s++){var c=l[s];"protocol"!==c&&(n[c]=e[c])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!v[e.protocol]){for(var f=Object.keys(e),d=0;d<f.length;d++){var p=f[d];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||g[e.protocol])n.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),n.pathname=h.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var m=n.pathname||"",y=n.search||"";n.path=m+y}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),w=e.host||e.pathname&&"/"===e.pathname.charAt(0),E=w||b||n.host&&e.pathname,T=E,_=n.pathname&&n.pathname.split("/")||[],S=(h=e.pathname&&e.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(S&&(n.hostname="",n.port=null,n.host&&(""===_[0]?_[0]=n.host:_.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),E=E&&(""===h[0]||""===_[0])),w)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,_=h;else if(h.length)_||(_=[]),_.pop(),_=_.concat(h),n.search=e.search,n.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(S)n.hostname=n.host=_.shift(),(O=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=O.shift(),n.host=n.hostname=O.shift());return n.search=e.search,n.query=e.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!_.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var x=_.slice(-1)[0],k=(n.host||e.host||_.length>1)&&("."===x||".."===x)||""===x,C=0,A=_.length;A>=0;A--)"."===(x=_[A])?_.splice(A,1):".."===x?(_.splice(A,1),C++):C&&(_.splice(A,1),C--);if(!E&&!T)for(;C--;C)_.unshift("..");!E||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),k&&"/"!==_.join("/").substr(-1)&&_.push("");var O,P=""===_[0]||_[0]&&"/"===_[0].charAt(0);S&&(n.hostname=n.host=P?"":_.length?_.shift():"",(O=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=O.shift(),n.host=n.hostname=O.shift()));return(E=E||n.host&&_.length)&&!P&&_.unshift(""),_.length?n.pathname=_.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var e=this.host,t=u.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){(function(e,r){var i;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(o){t&&t.nodeType,e&&e.nodeType;var a="object"==typeof r&&r;a.global!==a&&a.window!==a&&a.self;var u,l=2147483647,s=/^xn--/,c=/[^\x20-\x7E]/,f=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,h=String.fromCharCode;function m(e){throw new RangeError(d[e])}function g(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function v(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+g((e=e.replace(f,".")).split("."),t).join(".")}function y(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function b(e){return g(e,(function(e){var t="";return e>65535&&(t+=h((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=h(e)})).join("")}function w(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function E(e,t,n){var r=0;for(e=n?p(e/700):e>>1,e+=p(e/t);e>455;r+=36)e=p(e/35);return p(r+36*e/(e+38))}function T(e){var t,n,r,i,o,a,u,s,c,f,d,h=[],g=e.length,v=0,y=128,w=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&m("not-basic"),h.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<g;){for(o=v,a=1,u=36;i>=g&&m("invalid-input"),((s=(d=e.charCodeAt(i++))-48<10?d-22:d-65<26?d-65:d-97<26?d-97:36)>=36||s>p((l-v)/a))&&m("overflow"),v+=s*a,!(s<(c=u<=w?1:u>=w+26?26:u-w));u+=36)a>p(l/(f=36-c))&&m("overflow"),a*=f;w=E(v-o,t=h.length+1,0==o),p(v/t)>l-y&&m("overflow"),y+=p(v/t),v%=t,h.splice(v++,0,y)}return b(h)}function _(e){var t,n,r,i,o,a,u,s,c,f,d,g,v,b,T,_=[];for(g=(e=y(e)).length,t=128,n=0,o=72,a=0;a<g;++a)(d=e[a])<128&&_.push(h(d));for(r=i=_.length,i&&_.push("-");r<g;){for(u=l,a=0;a<g;++a)(d=e[a])>=t&&d<u&&(u=d);for(u-t>p((l-n)/(v=r+1))&&m("overflow"),n+=(u-t)*v,t=u,a=0;a<g;++a)if((d=e[a])<t&&++n>l&&m("overflow"),d==t){for(s=n,c=36;!(s<(f=c<=o?1:c>=o+26?26:c-o));c+=36)T=s-f,b=36-f,_.push(h(w(f+T%b,0))),s=p(T/b);_.push(h(w(s,0))),o=E(n,v,r==i),n=0,++r}++n,++t}return _.join("")}u={version:"1.4.1",ucs2:{decode:y,encode:b},decode:T,encode:_,toASCII:function(e){return v(e,(function(e){return c.test(e)?"xn--"+_(e):e}))},toUnicode:function(e){return v(e,(function(e){return s.test(e)?T(e.slice(4).toLowerCase()):e}))}},void 0===(i=function(){return u}.call(t,n,t,e))||(e.exports=i)}()}).call(this,n(18)(e),n(4))},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(54),t.encode=t.stringify=n(55)},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var u=/\+/g;e=e.split(t);var l=1e3;o&&"number"==typeof o.maxKeys&&(l=o.maxKeys);var s=e.length;l>0&&s>l&&(s=l);for(var c=0;c<s;++c){var f,d,p,h,m=e[c].replace(u,"%20"),g=m.indexOf(n);g>=0?(f=m.substr(0,g),d=m.substr(g+1)):(f=m,d=""),p=decodeURIComponent(f),h=decodeURIComponent(d),r(a,p)?i(a[p])?a[p].push(h):a[p]=[a[p],h]:a[p]=h}return a};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,u){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?o(a(e),(function(a){var u=encodeURIComponent(r(a))+n;return i(e[a])?o(e[a],(function(e){return u+encodeURIComponent(r(e))})).join(t):u+encodeURIComponent(r(e[a]))})).join(t):u?encodeURIComponent(r(u))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";var r=new RegExp("%[a-f0-9]{2}","gi"),i=new RegExp("(%[a-f0-9]{2})+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],o(n),o(r))}function a(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(r),n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(r);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"","%FF%FE":""},n=i.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var r=a(n[0]);r!==n[0]&&(t[n[0]]=r)}n=i.exec(e)}t["%C2"]="";for(var o=Object.keys(t),u=0;u<o.length;u++){var l=o[u];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},function(e,t){},function(e,t,n){"use strict";n.r(t),n.d(t,"Renderer",(function(){return ht})),n.d(t,"bootstrap",(function(){return mt}));var r=n(0),i=n.n(r),o=n(2),a=n.n(o),u=n(6),l=n.n(u),s=n(1),c=function(e){if(e&&e.length){for(var t="https://fonts.googleapis.com/css2?",n=0;n<e.length;n++){0!==n&&e[n].family&&(t+="&"),t+="family="+e[n].family.replace(/,[^,]*$/,"").replace(/\s+/g,"+");var r=e[n].variants;if(r){for(var i=[],o=[],a=0;a<r.length;a++){0===a&&(t+=":");var u=r[a];-1!==u.indexOf("italic")?(-1===t.indexOf("ital")&&(t+="ital"),u.replace("italic","").length>0?o.push(Number(u.replace("italic",""))):o.push(400)):"regular"===u?i.push(400):i.push(Number(u))}if(i.length>0||o.length>0){if(":"!==t[t.length-1]&&","!==t[t.length-1]&&(t+=","),t+="wght@",i.sort(),o.length>0){o.sort();for(var l=0;l<o.length;l++)o[l]="1,"+o[l];for(l=0;l<i.length;l++)i[l]="0,"+i[l]}for(l=0;l<i.length;l++)t+=i[l],(l<i.length-1||0!==o.length)&&(t+=";");if(o.length>0)for(l=0;l<o.length;l++)t+=o[l],l<o.length-1&&(t+=";")}}}return t}},f=n(7),d=n.n(f),p=function(){return(p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},h=function(e,t,n,r){for(var i={normal:{},hover:{},focus:{},active:{},error:{}},o=[["left","center","right"],["top","middle","bottom"],["margin","marginLeft"],["margin","marginRight"],["margin","marginTop"],["margin","marginBottom"],["padding","paddingLeft"],["padding","paddingRight"],["padding","paddingTop"],["padding","paddingBottom"]],a=0,u=n;a<u.length;a++){var l=u[a];if(r&&l===t)break;for(var s=function(t){if("error"!==t)for(var n=0,r=o;n<r.length;n++)for(var a=r[n],u=function(n){void 0!==e.styles[l][t][n]&&a.filter((function(e){return e!==n})).filter((function(e){return void 0!==i[t][e]})).forEach((function(e){delete i[t][e]}))},s=0,c=a;s<c.length;s++){u(c[s])}i[t]=p(p({},i[t]),e.styles[l][t])},c=0,f=Object.keys(i);c<f.length;c++){s(f[c])}if(l===t)break}return i},m=function(e){return window.exitintel.config.cdnURL+"/file/getImageV3/"+e},g=["textAlign"],v=function(e,t){var n=["position","left","top","bottom","right","width","display","flexDirection","alignItems","justifyContent","flexGrow","flexShrink","textAlign","zIndex","margin","marginRight","marginLeft","marginTop","marginBottom","maxWidth","maxHeight","transform"];return(e===s.ElementTypeEnum.CONTAINER||e===s.ElementTypeEnum.ELEMENT&&t===s.ElementSubTypeEnum.TEXT)&&n.push("borderRadius","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","backgroundImage","backgroundPosition","backgroundSize","backgroundRepeat","backgroundColor","eiBackgroundColor","eiBackgroundColorFallbackColor","borderWidth","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","borderStyle","borderColor"),n},y=function(e){return e.reduce((function(e,t){return t.type===s.ElementTypeEnum.CONTAINER?(e.push(t),e=e.concat(y(t.elements))):e.push(t),e}),[])},b=y,w=["fadeOut","fadeOutDown","fadeOutDownBig","fadeOutLeft","fadeOutLeftBig","fadeOutRight","fadeOutRightBig","fadeOutUp","fadeOutUpBig","bounceOut","bounceOutDown","bounceOutLeft","bounceOutRight","bounceOutUp","slideOutDown","slideOutLeft","slideOutRight","slideOutUp","zoomOut","zoomOutDown","zoomOutLeft","zoomOutRight","zoomOutUp","flipOutX","flipOutY","rotateOut","rotateOutDownLeft","rotateOutDownRight","rotateOutUpLeft","rotateOutUpRight"],E=n(8),T=function(e){return e.left&&"auto"!==e.left&&(e.right="auto"),e.right&&"auto"!==e.right&&(e.left="auto"),e.top&&"auto"!==e.top&&(e.bottom="auto"),e.bottom&&"auto"!==e.bottom&&(e.top="auto"),e};function _(e,t){(function(e){return"string"==typeof e&&e.includes(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&e.includes("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function S(e){return Math.min(1,Math.max(0,e))}function x(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function k(e){return e<=1?100*Number(e)+"%":e}function C(e){return 1===e.length?"0"+e:String(e)}function A(e,t,n){e=_(e,255),t=_(t,255),n=_(n,255);var r=Math.max(e,t,n),i=Math.min(e,t,n),o=0,a=0,u=(r+i)/2;if(r===i)a=0,o=0;else{var l=r-i;switch(a=u>.5?l/(2-r-i):l/(r+i),r){case e:o=(t-n)/l+(t<n?6:0);break;case t:o=(n-e)/l+2;break;case n:o=(e-t)/l+4}o/=6}return{h:o,s:a,l:u}}function O(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*n*(t-e):n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function P(e,t,n){e=_(e,255),t=_(t,255),n=_(n,255);var r=Math.max(e,t,n),i=Math.min(e,t,n),o=0,a=r,u=r-i,l=0===r?0:u/r;if(r===i)o=0;else{switch(r){case e:o=(t-n)/u+(t<n?6:0);break;case t:o=(n-e)/u+2;break;case n:o=(e-t)/u+4}o/=6}return{h:o,s:l,v:a}}function N(e,t,n,r){var i=[C(Math.round(e).toString(16)),C(Math.round(t).toString(16)),C(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function I(e){return Math.round(255*parseFloat(e)).toString(16)}function R(e){return M(e)/255}function M(e){return parseInt(e,16)}var L={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function D(e){var t,n,r,i={r:0,g:0,b:0},o=1,a=null,u=null,l=null,s=!1,c=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(L[e])e=L[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var n=z.rgb.exec(e);if(n)return{r:n[1],g:n[2],b:n[3]};if(n=z.rgba.exec(e))return{r:n[1],g:n[2],b:n[3],a:n[4]};if(n=z.hsl.exec(e))return{h:n[1],s:n[2],l:n[3]};if(n=z.hsla.exec(e))return{h:n[1],s:n[2],l:n[3],a:n[4]};if(n=z.hsv.exec(e))return{h:n[1],s:n[2],v:n[3]};if(n=z.hsva.exec(e))return{h:n[1],s:n[2],v:n[3],a:n[4]};if(n=z.hex8.exec(e))return{r:M(n[1]),g:M(n[2]),b:M(n[3]),a:R(n[4]),format:t?"name":"hex8"};if(n=z.hex6.exec(e))return{r:M(n[1]),g:M(n[2]),b:M(n[3]),format:t?"name":"hex"};if(n=z.hex4.exec(e))return{r:M(n[1]+n[1]),g:M(n[2]+n[2]),b:M(n[3]+n[3]),a:R(n[4]+n[4]),format:t?"name":"hex8"};if(n=z.hex3.exec(e))return{r:M(n[1]+n[1]),g:M(n[2]+n[2]),b:M(n[3]+n[3]),format:t?"name":"hex"};return!1}(e)),"object"==typeof e&&(B(e.r)&&B(e.g)&&B(e.b)?(t=e.r,n=e.g,r=e.b,i={r:255*_(t,255),g:255*_(n,255),b:255*_(r,255)},s=!0,c="%"===String(e.r).substr(-1)?"prgb":"rgb"):B(e.h)&&B(e.s)&&B(e.v)?(a=k(e.s),u=k(e.v),i=function(e,t,n){e=6*_(e,360),t=_(t,100),n=_(n,100);var r=Math.floor(e),i=e-r,o=n*(1-t),a=n*(1-i*t),u=n*(1-(1-i)*t),l=r%6;return{r:255*[n,a,o,o,u,n][l],g:255*[u,n,n,a,o,o][l],b:255*[o,o,u,n,n,a][l]}}(e.h,a,u),s=!0,c="hsv"):B(e.h)&&B(e.s)&&B(e.l)&&(a=k(e.s),l=k(e.l),i=function(e,t,n){var r,i,o;if(e=_(e,360),t=_(t,100),n=_(n,100),0===t)i=n,o=n,r=n;else{var a=n<.5?n*(1+t):n+t-n*t,u=2*n-a;r=O(u,a,e+1/3),i=O(u,a,e),o=O(u,a,e-1/3)}return{r:255*r,g:255*i,b:255*o}}(e.h,a,l),s=!0,c="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(o=e.a)),o=x(o),{ok:s,format:e.format||c,r:Math.min(255,Math.max(i.r,0)),g:Math.min(255,Math.max(i.g,0)),b:Math.min(255,Math.max(i.b,0)),a:o}}var U="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",j="[\\s|\\(]+("+U+")[,|\\s]+("+U+")[,|\\s]+("+U+")\\s*\\)?",F="[\\s|\\(]+("+U+")[,|\\s]+("+U+")[,|\\s]+("+U+")[,|\\s]+("+U+")\\s*\\)?",z={CSS_UNIT:new RegExp(U),rgb:new RegExp("rgb"+j),rgba:new RegExp("rgba"+F),hsl:new RegExp("hsl"+j),hsla:new RegExp("hsla"+F),hsv:new RegExp("hsv"+j),hsva:new RegExp("hsva"+F),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function B(e){return Boolean(z.CSS_UNIT.exec(String(e)))}var V=function(){function e(t,n){var r;if(void 0===t&&(t=""),void 0===n&&(n={}),t instanceof e)return t;"number"==typeof t&&(t=function(e){return{r:e>>16,g:(65280&e)>>8,b:255&e}}(t)),this.originalInput=t;var i=D(t);this.originalInput=t,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(r=n.format)&&void 0!==r?r:i.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},e.prototype.getLuminance=function(){var e=this.toRgb(),t=e.r/255,n=e.g/255,r=e.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(e){return this.a=x(e),this.roundA=Math.round(100*this.a)/100,this},e.prototype.toHsv=function(){var e=P(this.r,this.g,this.b);return{h:360*e.h,s:e.s,v:e.v,a:this.a}},e.prototype.toHsvString=function(){var e=P(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.v);return 1===this.a?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this.roundA+")"},e.prototype.toHsl=function(){var e=A(this.r,this.g,this.b);return{h:360*e.h,s:e.s,l:e.l,a:this.a}},e.prototype.toHslString=function(){var e=A(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.l);return 1===this.a?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this.roundA+")"},e.prototype.toHex=function(e){return void 0===e&&(e=!1),N(this.r,this.g,this.b,e)},e.prototype.toHexString=function(e){return void 0===e&&(e=!1),"#"+this.toHex(e)},e.prototype.toHex8=function(e){return void 0===e&&(e=!1),function(e,t,n,r,i){var o=[C(Math.round(e).toString(16)),C(Math.round(t).toString(16)),C(Math.round(n).toString(16)),C(I(r))];return i&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))&&o[3].startsWith(o[3].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}(this.r,this.g,this.b,this.a,e)},e.prototype.toHex8String=function(e){return void 0===e&&(e=!1),"#"+this.toHex8(e)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),n=Math.round(this.b);return 1===this.a?"rgb("+e+", "+t+", "+n+")":"rgba("+e+", "+t+", "+n+", "+this.roundA+")"},e.prototype.toPercentageRgb=function(){var e=function(e){return Math.round(100*_(e,255))+"%"};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var e=function(e){return Math.round(100*_(e,255))};return 1===this.a?"rgb("+e(this.r)+"%, "+e(this.g)+"%, "+e(this.b)+"%)":"rgba("+e(this.r)+"%, "+e(this.g)+"%, "+e(this.b)+"%, "+this.roundA+")"},e.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var e="#"+N(this.r,this.g,this.b,!1),t=0,n=Object.entries(L);t<n.length;t++){var r=n[t],i=r[0];if(e===r[1])return i}return!1},e.prototype.toString=function(e){var t=Boolean(e);e=null!=e?e:this.format;var n=!1,r=this.a<1&&this.a>=0;return t||!r||!e.startsWith("hex")&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this.a?this.toName():this.toRgbString()},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.l+=t/100,n.l=S(n.l),new e(n)},e.prototype.brighten=function(t){void 0===t&&(t=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-t/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-t/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-t/100*255))),new e(n)},e.prototype.darken=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.l-=t/100,n.l=S(n.l),new e(n)},e.prototype.tint=function(e){return void 0===e&&(e=10),this.mix("white",e)},e.prototype.shade=function(e){return void 0===e&&(e=10),this.mix("black",e)},e.prototype.desaturate=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.s-=t/100,n.s=S(n.s),new e(n)},e.prototype.saturate=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.s+=t/100,n.s=S(n.s),new e(n)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var n=this.toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,new e(n)},e.prototype.mix=function(t,n){void 0===n&&(n=50);var r=this.toRgb(),i=new e(t).toRgb(),o=n/100;return new e({r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a})},e.prototype.analogous=function(t,n){void 0===t&&(t=6),void 0===n&&(n=30);var r=this.toHsl(),i=360/n,o=[this];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,o.push(new e(r));return o},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){void 0===t&&(t=6);for(var n=this.toHsv(),r=n.h,i=n.s,o=n.v,a=[],u=1/t;t--;)a.push(new e({h:r,s:i,v:o})),o=(o+u)%1;return a},e.prototype.splitcomplement=function(){var t=this.toHsl(),n=t.h;return[this,new e({h:(n+72)%360,s:t.s,l:t.l}),new e({h:(n+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var n=this.toRgb(),r=new e(t).toRgb();return new e({r:r.r+(n.r-r.r)*n.a,g:r.g+(n.g-r.g)*n.a,b:r.b+(n.b-r.b)*n.a})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var n=this.toHsl(),r=n.h,i=[this],o=360/t,a=1;a<t;a++)i.push(new e({h:(r+a*o)%360,s:n.s,l:n.l}));return i},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();var H=function(){return(H=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},W=function(e){var t={},n=[];if(void 0!==e.center){var r=e.center.toString();if(r.match(/[0-9]+%$/))t.left=50+parseInt(r.replace("%",""),10)+"%",n.push("translateX(-50%)");else{var i=parseInt(r.replace(/px/,""),10);t.left="50%",n.push("translateX(calc(-50% + ("+i+"px)))")}t.right="auto"}if(void 0!==e.middle){var o=e.middle.toString();if(o.match(/[0-9]+%$/))t.top=50+parseInt(o.replace("%",""),10)+"%",n.push("translateY(calc("+(50+parseInt(o.replace("%",""),10))+"%))");else{var a=parseInt(o.replace(/px/,""),10);t.top="50%",n.push("translateY(calc(-50% + ("+a+"px)))")}t.bottom="auto"}return{style:t,transformParts:n}},G=function(e,t){void 0===t&&(t=!1);for(var n=[],r=0,i=Object.entries(e);r<i.length;r++){var o=i[r],a=o[0],u=o[1];n.push(a.replace(/([A-Z])/g,(function(e){return"-"+e[0].toLocaleLowerCase()}))+": "+u+(t?" !important":""))}return n.join(";")+";"},$=function(e,t,n,r,i,o){for(var a,u,l=[],c=[s.PseudoStateMode.HOVER,s.PseudoStateMode.ACTIVE,s.PseudoStateMode.FOCUS],f=function(f){var p=0===e.indexOf(f),y=[],_="@media (min-width: "+(p?"0":s.availableViewports[f].breakpointStart)+"px)",S=h(t,f,e,!1),x=S.normal,k=d()(x,{$merge:x}),C=W(x),A=C.style,O=C.transformParts;if(k=d()(k,{$merge:A}),x.borderStyle&&!x.borderColor&&(x.borderColor="black"),n)for(var P=0,N=Object.entries(n);P<N.length;P++){var I=N[P],R=I[0],M=I[1];k[R]=M}for(var L in x.eiBackgroundImage&&(k.backgroundImage="url("+m(x.eiBackgroundImage.id)+")"),k.animationName&&(k.WebkitAnimationName=k.animationName),k.animationDuration=(x.animationDuration||"0")+"s",k.animationDelay=(x.animationDelay||"0")+"s",(null===(C=k.background)||void 0===C?void 0:C.toString().match(/gradient/))?k.backgroundImage&&(k.backgroundImage=[k.backgroundImage,null===(N=k.background)||void 0===N?void 0:N.toString()].join(", "),delete k.background):(k.backgroundColor=k.background,delete k.background),k.transform?k.transform=O.concat([k.transform]).join(" "):k.transform=O.join(" "),k.animationName&&r&&(a=function(e,t,n,r){var i,o=(e=e)+"_"+n;if(-1!==t.join(" ").indexOf("@keyframes "+o))return[t.join(" ")];var a=Object(E.parse)(t.join(" "));if(void 0!==a){var u;try{u=JSON.parse(JSON.stringify(null===(i=a.stylesheet)||void 0===i?void 0:i.rules.find((function(t){var n=t;return"keyframes"===n.type&&n.name&&n.name===e}))))}catch(e){return}u.name=o;var l=u.keyframes;return l&&l.forEach((function(e){e.declarations&&e.declarations.map((function(e){"transform"===e.property&&(e.value=e.value+" "+r.join(" "))}))})),a.stylesheet&&a.stylesheet.rules.push(u),[Object(E.stringify)(a)]}}(k.animationName,r,t.id,O))&&(u="_"+t.id,k.animationName+=u,k.WebkitAnimationName+=u,i(a,t)),x.zIndex&&x.zIndex<0&&(k.zIndex=0),k=T(k))""!==k[L]&&void 0!==k[L]||delete k[L],"animationDuration"!==L&&"animationDelay"!==L||k.animationName||delete k[L];for(var D=0,U=c;D<U.length;D++){var j=U[D];y.push("#el_"+t.id+":"+j+" { "+G(S[j])+" }"),t.type===s.ElementTypeEnum.ELEMENT&&t.subType===s.ElementSubTypeEnum.CLOSE&&(S[j].stroke=S[j].color?S[j].color:"",y.push("#el_"+t.id+":"+j+">svg { "+G(S[j])+" }"))}if(t.type===s.ElementTypeEnum.ELEMENT&&t.subType===s.ElementSubTypeEnum.INPUT)y.push("#el_wrapper_"+t.id+" { "+G(function(e,t,n){var r=Object.assign({},e),i={};for(var o in r)(v(t,n).includes(o)||g.includes(o))&&(i[o]=r[o]);return i}(k,s.ElementTypeEnum.ELEMENT,s.ElementSubTypeEnum.INPUT))+" }"),y.push("#el_"+t.id+" { "+G(H({borderWidth:0,position:"relative",left:0,top:0,width:"100%"},function(e,t,n){var r=Object.assign({},e),i={};for(var o in r)v(t,n).includes(o)&&!g.includes(o)||(i[o]=r[o]);return i}(k,s.ElementTypeEnum.ELEMENT,s.ElementSubTypeEnum.INPUT)))+" }");else if(t.type!==s.ElementTypeEnum.ELEMENT||t.subType!==s.ElementSubTypeEnum.BUTTON&&t.subType!==s.ElementSubTypeEnum.CLOSE)y.push("#el_"+t.id+" { "+G(k)+" }");else{var F=H(H({},k),{strokeWidth:"unset",stroke:"unset"}),z={strokeWidth:k.strokeWidth?k.strokeWidth:3,stroke:k.color?k.color:"#707070",strokeLinecap:k.strokeLinecap?k.strokeLinecap:"square"};k.borderWidth||(F.borderWidth="0px"),k.backgroundColor||(F.backgroundColor="transparent"),y.push("#el_"+t.id+">svg { "+G(z)+" }"),y.push("#el_"+t.id+" { "+G(F)+" }")}if("absolute"===k.position&&y.push(".ad_not_visible #el_"+t.id+" { display: none !important; }"),t.type===s.ElementTypeEnum.ELEMENT&&t.subType===s.ElementSubTypeEnum.INPUT){if(x.color){var B=new V(x.color);B.setAlpha(B.getAlpha()/2),x.color=B.toRgbString()}y.push("#el_"+t.id+"::placeholder { color: "+(x.placeholderColor||x.color)+" }"),y.push("#el_"+t.id+".has_error { "+G(S.error)+" }");var $={};(null===(I=S.error)||void 0===I?void 0:I.eiErrorMessage)&&($=S.error.eiErrorMessage),$=H(H({},$),{boxSizing:"border-box",fontFamily:x.fontFamily,fontSize:x.fontSize,width:(null===(D=x.width)||void 0===D?void 0:D.toString().match(/%/))?"100%":x.width}),y.push("#el_"+t.id+"_error_message { "+G($)+" }")}(t.type===s.ElementTypeEnum.CONTAINER&&(t.subType,s.ContainerSubTypeEnum.BUTTON_GROUP),t.type===s.ElementTypeEnum.CONTAINER&&t.subType===s.ContainerSubTypeEnum.BUTTON_GROUP)&&b(t.elements).forEach((function(e){for(var n=0,r=Object.entries(e.styles[f]);n<r.length;n++){var i=r[n],o=i[0],a=i[1];y.push("#el_"+t.id+":"+o+" #el_"+e.id+" { "+G(a)+" }")}}));x.animationName&&!o&&(w.includes(x.animationName)?(y.push("#el_wrapper_"+t.id+".animation-finished { opacity: 0 }"),y.push("#el_"+t.id+".animation-finished { opacity: 0 }")):(y.push("#el_wrapper_"+t.id+".animation-not-started { opacity: 0 }"),y.push("#el_"+t.id+".animation-not-started { opacity: 0 }"))),l.push(_+" { "+y.join("\n")+" }")},p=0,y=e;p<y.length;p++){f(y[p])}return l.push("#el_"+t.id+" { box-sizing: border-box }"),l.join("\n")},q=function(e,t,n,r,i){return new Promise((function(o,a){var u=window.exitintel.campaign.get(n),l=null==u?void 0:u.selectedAd;window.exitintel.visitor.setConvertedCampaign(n,{adId:r}),window.exitintel.event.log("collect-data",{campaignId:n,adId:null==l?void 0:l.id,data:e,onDone:function(u){if(u){o();for(var l=0;l<t.length;l++)window.exitintel.visitor.setGatheredData(t[l]);try{window.exitintel.events.emit("data-collected",{campaignId:n,adId:r,element:i.label,data:e})}catch(e){window.exitintel.util.error(e)}}else alert("Your data was not sent. Please try again in a few moments."),a()}})}))},Y=Object(r.forwardRef)((function(e,t){var n=e.action,r=e.ad,o=[],a=[];return r.ad.steps.forEach((function(e){a=a.concat(b(e.elements)).filter((function(e){return e.type===s.ElementTypeEnum.ELEMENT&&e.subType===s.ElementSubTypeEnum.INPUT}))})),a.forEach((function(e){var t;if(!n.omittedElements.includes(e.id)&&e.name){var i=null===(t=r.data.find((function(t){return t.field===e.id})))||void 0===t?void 0:t.value;o.push({name:e.name,value:i})}})),n.additionalVars&&n.additionalVars.forEach((function(e){o.push({name:e.name,value:e.value})})),i.a.createElement("form",{ref:t,action:n.url,target:"new-window"===n.submitMethod?"_blank":void 0,method:"POST",onSubmit:function(e){if("ajax"===n.submitMethod){e.preventDefault();var t={};o.map((function(e){return t[e.name]=e.value})),fetch(n.url,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){}),(function(e){throw alert("An error occured. Please check your data and try again later."),Error(e)}))}}},o.map((function(e,t){return i.a.createElement("input",{key:t,readOnly:!0,name:e.name,value:e.value})})))})),Q=function(e){var t=e.action,n=e.goToStep,r=e.resolve,o=e.reject;return i.a.createElement("div",{className:"exi_alert"},i.a.createElement("div",{className:"exi_alert_overlay_cover"}),i.a.createElement("div",{className:"exi_css_reset exi_alert_container exi_alert_defaults"},i.a.createElement("div",{className:"exi_css_reset exi_alert_container_inner exi_alert_defaults"},i.a.createElement("div",{className:"exi_alert_title exi_alert_defaults"},i.a.createElement("img",{src:"eu"===t.icon?"https://assets.exitintel.com/eu_gdpr.png":window.exitintel.config.cdnURL+t.customIcon,width:"25",height:"25",className:"exi_gdpr_icon"}),t.title),i.a.createElement("div",{className:"exi_alert_body exi_alert_defaults"},t.body),i.a.createElement("div",{className:"exi_alert_actions exi_alert_defaults"},i.a.createElement("a",{href:"#",className:"exi_css_reset exi_alert_defaults exi_alert_action_secondary",onClick:function(){window.exitintel.util.jQuery(".exi_alert").remove(),"goto-step"===t.decline.action&&t.decline.step&&n(t.decline.step),o("GDPR declined")}},t.decline.text),i.a.createElement("a",{href:"#",className:"exi_css_reset exi_alert_defaults exi_alert_action_primary",onClick:function(){window.exitintel.util.jQuery(".exi_alert").remove(),r()}},t.accept.text))),i.a.createElement("div",{className:"exi_below_alert_copy",dangerouslySetInnerHTML:{__html:t.footnote}})))},K=function(e){var t=null;return e.some((function e(n){return n.type&&n.type===s.ElementTypeEnum.ELEMENT&&n.subType===s.ElementSubTypeEnum.INPUT&&n.inputSubType===s.ElementInputSubTypeEnum.INPUT_EMAIL?(t=n,!0):Array.isArray(n.elements)&&n.elements.some(e)})),t||null},X=function(e){for(var t=0;t<e.length;t++)if(K([e[t]]))return t+1;return-1},J=X;window.exitintel.findStepWithEmailV3=X;var Z,ee=function(e){if(""===e)return!0;return!!/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},te=function(e){if(void 0===e)return!0;if(""===e)return!0;var t=e.match(/\d/g);return!(!t||t&&t.length<10)},ne=function(){return(ne=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},re=function(e,t){return function(n,r){if(!n||!r)throw"setErrorMessage: You should provide all arguments";if(void 0===e.currentStep)throw"setErrorMessage: Couldn't find current step";var i=function(e,t){var n=null;return e.elements.some((function e(r){return r.type&&r.type===s.ElementTypeEnum.ELEMENT&&r.subType===s.ElementSubTypeEnum.INPUT&&r.name===t?(n=r,!0):Array.isArray(r.elements)&&r.elements.some(e)})),n||null}(e.ad.steps[e.currentStep],n);if(!i)throw'setErrorMessage: Input with name "'+n+'" could not found in step '+(e.currentStep+1);var o=[{field:i.id,errorMessage:r}];if(e=t(ne(ne({},e),{errors:o})),o.length)throw new Error("Validation failed")}},ie=function(e,t){return function(n){if(n<1||n>e.ad.steps.length)throw"goToStep: You should provide a valid step";t(n-1)}},oe=function(){return(oe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ae=function(e,t){return function(){e=t(oe(oe({},e),{errors:[]})),console.warn("resetErrors: Reseting all errors")}},ue=function(e,t){var n,r={},i=(n=[],[e].forEach((function e(t){t&&t.type&&t.type===s.ElementTypeEnum.ELEMENT&&t.subType===s.ElementSubTypeEnum.INPUT&&n.push(t),t.elements&&Array.isArray(t.elements)&&t.elements.forEach(e)})),n);return i?(i.forEach((function(e){var n,i=e.name||"",o=null===(n=t.find((function(t){return t.field===e.id})))||void 0===n?void 0:n.value;r[i]=o||""})),r):r},le=function(e){return e?{campaign_id:e.id,campaign_title:e.title,ad_id:e.selectedAd.id,ad_title:e.selectedAd.title}:{}},se=function(e,t,n){var r=!1;return e.some((function e(i){i.label&&i.label===t&&(i.content=n,r=!0),i.elements&&Array.isArray(i.elements)&&i.elements.forEach(e)})),r},ce=function(){return(ce=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},fe=function(e,t){return function(n,r){if(!n||!r)throw"setContent: You should provide all arguments";if(void 0===e.currentStep)throw"setContent: Couldn't find current step";if(!se(e.ad.steps,n,r))throw"setContent: Could not found elements with label="+n+" ";e=t(ce({},e))}},de=function(e,t){return b(e.map((function(e){return e.elements})).reduce((function(e,t){return e.concat(t)}),[])).filter((function(e){return!!e.classes&&e.classes.split(",").map((function(e){return e.trim()})).includes(t)}))},pe=function(e,t){return function(n,r){if(!n||!r)throw"setInputValueByClass: You should provide all arguments";if(void 0===e.currentStep)throw"setInputValueByClass: Couldn't find current step";var i=de(e.ad.steps,n);if(!i)throw"setInputValueByClass: Could not found elements with className="+n+" ";i.filter((function(e){return e.type===s.ElementTypeEnum.ELEMENT&&e.subType===s.ElementSubTypeEnum.INPUT})).map((function(e){return e.id})).forEach((function(e){return t(e,r)}))}},he=function(e,t,n){var r=!1;return e.some((function e(i){if(i.classes){var o=i.classes.split(",").map((function(e){return e.trim()}));o&&o.includes(t)&&(i.content=n,r=!0)}i.elements&&Array.isArray(i.elements)&&i.elements.forEach(e)})),r},me=function(){return(me=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ge=function(e,t){return function(n,r){if(!n||!r)throw"setContentByClass: You should provide all arguments";if(void 0===e.currentStep)throw"setContentByClass: Couldn't find current step";if(!he(e.ad.steps,n,r))throw"setContentByClass: Could not found elements with className="+n+" ";e=t(me({},e))}},ve=function(){return(ve=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ye=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function u(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}l((r=r.apply(e,t||[])).next())}))},be=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},we=function(e,t,n,i,o,u){return ye(void 0,void 0,void 0,(function(){var l,c,f,d,p,h;return be(this,(function(m){switch(m.label){case 0:l=e,c=function(e){var c,f,d,p,h,m,g,v,y,w,E,T,_,S,x,k,C,A,O,P,N,I,R,M,L,D,U,j,F,z,B,V,H;return be(this,(function(W){switch(W.label){case 0:switch(e.type){case s.ButtonActionType.CLOSE_AD:return[3,1];case s.ButtonActionType.ACCEPT_DECLINE_PROMPT:return[3,2];case s.ButtonActionType.COLLECT_DATA:return[3,10];case s.ButtonActionType.CUSTOM_CODE:return[3,15];case s.ButtonActionType.DOWNLOAD_FILE:return[3,20];case s.ButtonActionType.FB_LEAD_EVENT:return[3,21];case s.ButtonActionType.GO_TO_STEP:return[3,22];case s.ButtonActionType.SEND_TO_GOOGLE_ANALYTICS:return[3,23];case s.ButtonActionType.SEND_TO_INTEGRATIONS_MANAGER:return[3,24];case s.ButtonActionType.TRIGGER_AD:return[3,25];case s.ButtonActionType.SUBMIT_FORM:return[3,30];case s.ButtonActionType.GOTO_URL:return[3,31]}return[3,32];case 1:l.hide(),l=i(ve(ve({},l),{visible:!1})),window.exitintel.visitor.setDisabledCampaign(l.campaignId),e.reload&&window.exitintel.elementActionTypes.reloadAds.install()();try{window.exitintel.events.emit("ad-closed",{campaignId:l.campaignId,adId:l.legacyAdId,element:t.label})}catch(e){window.exitintel.util.error(e)}return[3,32];case 2:c=[{code:"AT",name:"Austria"},{code:"BE",name:"Belgium"},{code:"BG",name:"Bulgaria"},{code:"HR",name:"Croatia"},{code:"CY",name:"Republic of Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"DK",name:"Denmark"},{code:"EE",name:"Estonia"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"DE",name:"Germany"},{code:"GR",name:"Greece"},{code:"HU",name:"Hungary"},{code:"IE",name:"Ireland"},{code:"IT",name:"Italy"},{code:"LV",name:"Latvia"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MT",name:"Malta"},{code:"NL",name:"Netherlands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"RO",name:"Romania"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"ES",name:"Spain"},{code:"SE",name:"Sweden"},{code:"GB",name:"UK"}],f=window.exitintel.storage.get("userCountry"),W.label=3;case 3:return W.trys.push([3,8,,9]),f?[3,5]:[4,window.exitintel.util.getCountry()];case 4:return p=W.sent(),[3,6];case 5:p=f,W.label=6;case 6:return d=p,window.exitintel.storage.set("userCountry",d,100),-1!==(h=e.countries).indexOf("EU")&&(h=h.filter((function(e){return"EU"!==e})).concat(c.map((function(e){return e.code})))),h.length>0&&-1===h.indexOf(d)?[2,{value:{status:"success"}}]:[4,new Promise((function(t,n){var i=r.createElement(Q,{action:e,goToStep:u,resolve:t,reject:n}),o=document.createElement("div");a.a.render(i,document.body.appendChild(o)),window.exitintel.util.jQuery(".exi_alert").fadeIn(200)}))];case 7:return W.sent(),[3,9];case 8:throw m=W.sent(),new Error(m);case 9:return[3,32];case 10:if(g={},v=[],y=[],w=[],l.ad.steps.forEach((function(e){w=w.concat(b(e.elements)).filter((function(e){return e.type===s.ElementTypeEnum.ELEMENT&&e.subType===s.ElementSubTypeEnum.INPUT}))})),w.forEach((function(t){var n;if(!e.omittedElements.includes(t.id)){var r=t.inputSubType,i=null===(n=l.data.find((function(e){return e.field===t.id})))||void 0===n?void 0:n.value;t.required&&!i&&y.push({field:t.id,errorMessage:s.INPUT_PROPERTIES[r].errorMessages.required}),r!==s.ElementInputSubTypeEnum.INPUT_EMAIL||ee(i)||y.push({field:t.id,errorMessage:s.INPUT_PROPERTIES[r].errorMessages.invalid}),r!==s.ElementInputSubTypeEnum.INPUT_PHONE_NUMBER||te(i)||y.push({field:t.id,errorMessage:s.INPUT_PROPERTIES[r].errorMessages.invalid}),t.name&&(g[t.name]=i,v.push(t.name))}})),console.warn("errors",y),l=i(ve(ve({},l),{errors:y})),y.length)throw new Error("Validation failed");W.label=11;case 11:return W.trys.push([11,13,,14]),[4,q(g,v,l.campaignId,l.legacyAdId,t)];case 12:return W.sent(),[3,14];case 13:throw W.sent(),new Error("Could not capture data");case 14:return[3,32];case 15:E=new Promise((function(r,a){new Function("ad","element","action","event","resolve","reject","isValidEmail","isValidPhoneNumber","setErrorMessage","resetErrors","goToStep","input","step","meta","setContent","setInputValueByClass","setContentByClass",e.code)(l,t,e,n,r,a,ee,te,re(l,i),ae(l,i),ie(l,u),function(e){if(void 0===e.currentStep)return{};var t=e.ad.steps[e.currentStep];return ue(t,e.data)}(l),function(e){var t=[];return e.ad.steps.forEach((function(n){t.push(ue(n,e.data))})),t}(l),le(window.exitintel.campaign.get(l.campaignId)),fe(l,i),pe(l,o),ge(l,i))})),W.label=16;case 16:return W.trys.push([16,18,,19]),[4,E];case 17:return W.sent(),[3,19];case 18:throw T=W.sent(),new Error(T);case 19:return[3,32];case 20:return e.newWindow?(window.open(window.exitintel.config.apiURL+"/file/getFileV3/"+(null===(I=e.file)||void 0===I?void 0:I.id),"_blank"),[3,32]):(window.location.href=window.exitintel.config.apiURL+"/file/getFileV3/"+(null===(p=e.file)||void 0===p?void 0:p.id)+"?download=true",[2,{value:{status:"stop"}}]);case 21:return window.fbq&&"function"==typeof window.fbq&&(_={contentCategory:e.contentCategory,contentName:e.contentName,value:e.value,currency:e.currency},window.fbq("track","Lead",_)),[3,32];case 22:if(S=null,document.activeElement instanceof HTMLIFrameElement?(x=document.activeElement,k=null===(F=x.contentDocument)||void 0===F?void 0:F.activeElement,x.contentWindow&&(k instanceof x.contentWindow.HTMLInputElement||k instanceof x.contentWindow.HTMLTextAreaElement)&&(S=k)):(document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement)&&(S=document.activeElement),S&&S.blur(),void 0===l.currentStep)throw new Error("Aborting... No current step");if(C=-1,(C="prev"===e.stepNumber?l.currentStep-1:"next"===e.stepNumber?l.currentStep+1:parseInt(e.stepNumber,10))<0||C>l.ad.steps.length-1)throw new Error("Invalid step");return l=i(ve(ve({},l),{currentStep:C})),[3,32];case 23:return A=window.exitintel.campaign.get(l.campaignId),window.exitintel.integrations.ga.trackEvent(e.eventCategory||"Exit Intel",e.eventAction||"Conversion",e.eventLabel||(null==A?void 0:A.title)+" / "+l.title,e.eventValue||0),[3,32];case 24:if(O={},e.fields)for(N in P=function(t){var n=l.data.find((function(e){return e.field===t})),r=e.fields[t];O[r]=null==n?void 0:n.value},e.fields)P(N);return e.integration&&(I=e.integration.split(":"),R=I[0],M=I[1],L=l.data.find((function(t){return t.field===e.emailFieldId})),D=L?L.value:null,window.exitintel.integrations[R.toLowerCase()].send(M,D,O,!1).fail((function(){throw alert("We were unable to process your information. Please check your email address and try again in a few moments."),new Error("Unable to send info to integrations manager")})).done((function(){return{status:"success"}}))),[3,32];case 25:window.exitintel.util.log("trigger ad..."),U=function(t){var n,r,i,o,a,u,l;return be(this,(function(s){switch(s.label){case 0:if(t.id!=e.campaignId)return[2,"continue"];if(n=null,e.adId){for(i=0,o=t.enabled_ads;i<o.length;i++)if((a=o[i]).id==e.adId){n=a;break}window.exitintel.util.log(n),n||window.exitintel.util.log("Could not find ad "+e.adId+" in enabled ads.")}else t.selectedAd?n=t.selectedAd:(r=Math.floor(Math.random()*t.enabled_ads.length),n=t.enabled_ads[r]);u=new Promise((function(t,r){window.exitintel.ad.install(n,{noTriggers:!0}).then((function(r){var i=function(e,t){var n=1;return e.stepMode&&"auto"===e.stepMode?-1===(n=t.version&&"v3"===t.version?J(t.ad.selectedVersion.template.ad.steps):window.exitintel.ad.findStepWithEmail(t))&&(n=1,window.exitintel.util.log("Step with email not found! Fail silently to step = "+n)):void 0!==e.step&&e.step&&(n=parseInt(e.step,10)),n}(e,r);window.exitintel.ad.showAdFunction(n,r,{stepNumber:i-1})((function(e){r.showPanel.call(r,i-1)})),t()}),(function(e){var t="Could not trigger ad - "+e;window.exitintel.util.log(t),r(t)}))})),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,u];case 2:return s.sent(),[3,4];case 3:throw l=s.sent(),new Error(l);case 4:return[2]}}))},j=0,F=window.exitintel.campaign.available,W.label=26;case 26:return j<F.length?(z=F[j],[5,U(z)]):[3,29];case 27:W.sent(),W.label=28;case 28:return j++,[3,26];case 29:return[3,32];case 30:return(B=document.createElement("div")).setAttribute("style","display:none;"),V=r.createRef(),H=r.createElement(Y,{action:e,ad:l,ref:V}),a.a.render(H,document.body.appendChild(B)),e&&V.current&&("ajax"===e.submitMethod?V.current.dispatchEvent(new Event("submit")):V.current.submit()),[3,32];case 31:return e.newWindow?window.open(e.url,"_blank"):window.location.href=e.url,[3,32];case 32:return[2]}}))},f=0,d=t.actions,m.label=1;case 1:return f<d.length?(p=d[f],[5,c(p)]):[3,4];case 2:if("object"==typeof(h=m.sent()))return[2,h.value];m.label=3;case 3:return f++,[3,1];case 4:return[2,{status:"success"}]}}))}))};!function(e){e.NOT_STARTED="not-started",e.RUNNING="running",e.FINISHED="finished"}(Z||(Z={}));var Ee,Te,_e,Se,xe=function(e){var t=e.ad,n=e.el,o=e.setAd,a=e.setAdData,u=e.goToStep,l=e.visible,s=e.zIndex,c=Object(r.useRef)(null),f=Object(r.useState)(Z.NOT_STARTED),d=f[0],p=f[1];return i.a.createElement("button",{id:"el_"+n.id,ref:c,style:{zIndex:s,cursor:"pointer",animationPlayState:l?"running":"paused",WebkitTouchCallout:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none"},dangerouslySetInnerHTML:{__html:n.content?n.content:""},className:(n.classes?n.classes.split(",").map((function(e){return e.trim()})).join(" "):"")+" animation-"+d,onClick:function(e){window.exitintel.plugins.activityIndicator.show(),we(t,n,e,o,a,u).finally((function(){return window.exitintel.plugins.activityIndicator.hide()}))},onAnimationStart:function(e){e.stopPropagation(),p(Z.RUNNING)},onAnimationEnd:function(e){e.stopPropagation(),p(Z.FINISHED)}})},ke=function(e){var t=e.ad,n=e.el,o=e.setAd,a=e.setAdData,u=e.goToStep,l=e.visible,s=e.zIndex,c=Object(r.useRef)(null),f=Object(r.useState)(Z.NOT_STARTED),d=f[0],p=f[1];return i.a.createElement("button",{id:"el_"+n.id,ref:c,style:{zIndex:s,cursor:"pointer",userSelect:"none",lineHeight:0,animationPlayState:l?"running":"paused"},className:(n.classes?n.classes.split(",").map((function(e){return e.trim()})).join(" "):"")+" animation-"+d,onClick:function(e){window.exitintel.plugins.activityIndicator.show(),we(t,n,e,o,a,u).finally((function(){return window.exitintel.plugins.activityIndicator.hide()}))},onAnimationStart:function(e){e.stopPropagation(),p(Z.RUNNING)},onAnimationEnd:function(e){e.stopPropagation(),p(Z.FINISHED)}},i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 21.242 21.242"},i.a.createElement("g",{id:"Group_1","data-name":"Group 1",transform:"translate(-0.579 -0.579)"},i.a.createElement("line",{x2:"17",y2:"17",transform:"translate(2.66 2.66)",fill:"none"}),i.a.createElement("line",{x1:"17",y2:"17",transform:"translate(2.66 2.66)",fill:"none"}))))},Ce=Object(r.forwardRef)((function(e,t){var n=e.ad,o=e.el,a=e.setAd,u=e.setAdData,l=e.goToStep,s=e.visible,c=e.zIndex;t||(t=Object(r.useRef)(null));var f,d=Object(r.useState)(Z.NOT_STARTED),p=d[0],h=d[1];return i.a.createElement("div",{id:"el_"+o.id,ref:t,className:(f=["animation-"+p],o.classes&&f.push.apply(f,o.classes.split(",").map((function(e){return e.trim()}))),f.join(" ")),style:{animationPlayState:s?"running":"paused",zIndex:c},onAnimationStart:function(e){e.stopPropagation(),h(Z.RUNNING)},onAnimationEnd:function(e){e.stopPropagation(),h(Z.FINISHED)}},o.elements.map((function(e,t){return i.a.createElement(Ge,{key:e.id,ad:n,element:e,setAd:a,setAdData:u,goToStep:l,visible:s,zIndex:o.elements.length-t})})))}));!function(e){e.NONE="NONE",e.GOOGLE="GOOGLE",e.ADOBE="ADOBE"}(Te||(Te={})),function(e){e.iPhone5="iPhone5",e.iPhone6="iPhone6",e.smallDesktop="smallDesktop",e.desktop="desktop"}(_e||(_e={})),function(e){e.NORMAL="normal",e.HOVER="hover",e.FOCUS="focus",e.ACTIVE="active",e.ERROR="error"}(Se||(Se={}));var Ae,Oe,Pe,Ne,Ie,Re,Me,Le;!function(e){e.MOBILE="mobile",e.TABLET="tablet",e.DESKTOP="desktop"}(Ae||(Ae={})),function(e){e.CSS="css",e.JAVASCRIPT="javascript",e.HTML="html"}(Oe||(Oe={})),function(e){e.CONTAINER="container",e.ELEMENT="element"}(Pe||(Pe={})),function(e){e.NORMAL="normal",e.BUTTON_GROUP="button-group"}(Ne||(Ne={})),function(e){e.INPUT_GENERAL="input-general",e.INPUT_EMAIL="input-email",e.INPUT_FULL_NAME="input-name",e.INPUT_FIRST_NAME="input-given-name",e.INPUT_LAST_NAME="input-family-name",e.INPUT_PHONE_NUMBER="input-tel-national",e.INPUT_COMPANY_NAME="input-organization",e.INPUT_BIRTHDAY="input-bday"}(Ie||(Ie={})),function(e){e.INPUT="input",e.TEXT="text",e.BUTTON="button",e.IMAGE="image",e.CLOSE="close",e.CUSTOM_HTML="custom-html"}(Re||(Re={})),function(e){e.CLOSE_AD="close-ad",e.COLLECT_DATA="collect-data",e.GO_TO_STEP="goto-step",e.TRIGGER_AD="trigger-ad",e.CUSTOM_CODE="custom-code",e.ACCEPT_DECLINE_PROMPT="accept-decline-prompt",e.DOWNLOAD_FILE="download-file",e.SEND_TO_GOOGLE_ANALYTICS="send-to-google-analytics",e.FB_LEAD_EVENT="fb-lead-event",e.SEND_TO_INTEGRATIONS_MANAGER="send-to-integrations-manager",e.SUBMIT_FORM="submit-form",e.GOTO_URL="goto-url"}(Me||(Me={})),function(e){e.SEND_INTEGRATIONS="sendIntegrations",e.TRIGGER_AD="triggerAd",e.FORCE_AD_SELECTION="forceAdSelection",e.GET_CLIENTS="getClients",e.GET_CAMPAIGN_INFO="getCampaignInfo",e.PREVIEW_LIVE="previewLive",e.GET_CLIENT_INFO="getClientInfo",e.HAS_UNSAVED_CHANGES="hasUnsavedChanges",e.GET_ANIMATIONS_URL="getAnimationsURL"}(Le||(Le={}));var De,Ue,je=Object.freeze(((Ee={})[Ie.INPUT_GENERAL]={label:"General input",errorMessages:{required:"Please fill in this field",invalid:"Please check this field"},autocomplete:""},Ee[Ie.INPUT_EMAIL]={label:"Email address",errorMessages:{required:"Please enter your email address",invalid:"Please enter a valid email address"},autocomplete:"email"},Ee[Ie.INPUT_FULL_NAME]={label:"Name",errorMessages:{required:"Please enter your name",invalid:"Please enter your name"},autocomplete:"name"},Ee[Ie.INPUT_FIRST_NAME]={label:"First Name",errorMessages:{required:"Please enter your first name",invalid:"Please enter your first name"},autocomplete:"given-name"},Ee[Ie.INPUT_LAST_NAME]={label:"Last Name",errorMessages:{required:"Please enter your last name",invalid:"Please enter your last name"},autocomplete:"family-name"},Ee[Ie.INPUT_PHONE_NUMBER]={label:"Phone Number",errorMessages:{required:"Please enter your phone number",invalid:"Please enter a valid phone number"},autocomplete:"tel"},Ee[Ie.INPUT_COMPANY_NAME]={label:"Company Name",errorMessages:{required:"Please enter your company name",invalid:"Please enter your company name"},autocomplete:"organization"},Ee[Ie.INPUT_BIRTHDAY]={label:"Birthday",errorMessages:{required:"Please enter your birthday",invalid:"Please enter your birthday"},autocomplete:"bday"},Ee));Object.freeze({borderColor:"#A82A2A",borderWidth:"1px",eiErrorMessage:{color:"#A82A2A",background:"#FCE9ED",borderRadius:"4px"}});!function(e){e.CONTAINER="layers-draggable-container",e.ELEMENT="layers-draggable-element"}(De||(De={})),function(e){e.TREE="tree",e.NEW="new"}(Ue||(Ue={}));var Fe,ze=i.a.memo((function(e){var t=e.ad,n=e.el,o=e.errorMessage,a=e.setAdData,u=e.setAd,l=e.goToStep,c=e.visible,f=e.zIndex,d=Object(r.useState)(""),p=d[0],h=d[1];Object(r.useEffect)((function(){if(t.data&&t.data.length>0){var e=t.data.find((function(e){return e.field===n.id}));e&&e.value!==p&&h(e.value)}}),[t]);var m=Object(r.useRef)(null),g=Object(r.useRef)(null),v=Object(r.useState)(Z.NOT_STARTED),y=v[0],b=v[1],w="text";switch(n.inputSubType){case s.ElementInputSubTypeEnum.INPUT_EMAIL:w="email";break;case s.ElementInputSubTypeEnum.INPUT_PHONE_NUMBER:w="tel"}var E;return i.a.createElement("div",{id:"el_wrapper_"+n.id,ref:g,className:"animation-"+y,style:{animationPlayState:c?"running":"paused",zIndex:f},onAnimationStart:function(e){e.stopPropagation(),b(Z.RUNNING)},onAnimationEnd:function(e){e.stopPropagation(),b(Z.FINISHED)}},i.a.createElement("input",{id:"el_"+n.id,key:"el_"+n.id,className:(E=[],o&&E.push("has_error"),n.classes&&E.push.apply(E,n.classes.split(",").map((function(e){return e.trim()}))),E.join(" ")),value:p,type:w,name:n.name,ref:m,placeholder:n.placeholder,autoComplete:je[n.inputSubType].autocomplete,onChange:function(e){!function(e,t){var n;h(t),a(e,t),null===(n=m.current)||void 0===n||n.focus()}(n.id,e.target.value)},onKeyDown:function(e){var n,r;if(void 0!==t.currentStep){if(13===e.which){var i=(n=t.ad.steps[t.currentStep],r=null,n.elements.forEach((function e(t){t&&t.type&&(t.type===s.ElementTypeEnum.ELEMENT&&t.subType===s.ElementSubTypeEnum.BUTTON||t.type===s.ElementTypeEnum.CONTAINER&&t.subType===s.ContainerSubTypeEnum.BUTTON_GROUP)&&t.isDefault&&(r=t),t.elements&&Array.isArray(t.elements)&&t.elements.forEach(e)})),r||null);i&&(window.exitintel.plugins.activityIndicator.show(),we(t,i,e,u,a,l).finally((function(){return window.exitintel.plugins.activityIndicator.hide()})))}}else console.warn("no current step")}}),i.a.createElement("div",{className:"error_message",key:"el_"+n.id+"_error_message",id:"el_"+n.id+"_error_message",style:{display:o?"block":"none",position:"relative",padding:"10px 12px 9px",lineHeight:"1.5"}},o))}),(function(){return!1})),Be=function(e){var t=e.el,n=e.visible,o=e.zIndex,a=Object(r.useRef)(null),u=Object(r.useState)(Z.NOT_STARTED),l=u[0],s=u[1];return i.a.createElement("div",{id:"el_"+t.id,ref:a,dangerouslySetInnerHTML:{__html:t.content?t.content:""},className:(t.classes?t.classes.split(",").map((function(e){return e.trim()})).join(" "):"")+" animation-"+l,style:{animationPlayState:n?"running":"paused",zIndex:o},onAnimationStart:function(e){e.stopPropagation(),s(Z.RUNNING)},onAnimationEnd:function(e){e.stopPropagation(),s(Z.FINISHED)}})},Ve=function(e){var t=e.el,n=e.visible,o=e.zIndex,a=Object(r.useRef)(null),u=Object(r.useState)(Z.NOT_STARTED),l=u[0],s=u[1];return i.a.createElement("img",{id:"el_"+t.id,ref:a,src:t.image?m(t.image.id):void 0,className:(t.classes?t.classes.split(",").map((function(e){return e.trim()})).join(" "):"")+" animation-"+l,style:{animationPlayState:n?"running":"paused",zIndex:o},onAnimationStart:function(e){e.stopPropagation(),s(Z.RUNNING)},onAnimationEnd:function(e){e.stopPropagation(),s(Z.FINISHED)}})},He=function(e){var t=e.ad,n=e.el,o=e.setAd,a=e.setAdData,u=e.goToStep,l=e.visible,s=e.zIndex,c=Object(r.useRef)(null),f=Object(r.useState)(Z.NOT_STARTED),d=f[0],p=f[1];return i.a.createElement("div",{id:"el_"+n.id,ref:c,style:{zIndex:s,cursor:"pointer",animationPlayState:l?"running":"paused",WebkitTouchCallout:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none"},className:(n.classes?n.classes.split(",").map((function(e){return e.trim()})).join(" "):"")+" animation-"+d,onClick:function(e){window.exitintel.plugins.activityIndicator.show(),we(t,n,e,o,a,u).finally((function(){return window.exitintel.plugins.activityIndicator.hide()}))},onAnimationStart:function(e){e.stopPropagation(),p(Z.RUNNING)},onAnimationEnd:function(e){e.stopPropagation(),p(Z.FINISHED)}},n.elements.map((function(e,r){return i.a.createElement(Ge,{key:e.id,ad:t,element:e,setAd:o,setAdData:a,goToStep:u,visible:l,zIndex:n.elements.length-r})})))},We=function(e){var t=e.el,n=e.zIndex;return i.a.createElement("div",{id:"el_"+t.id,style:{zIndex:n},dangerouslySetInnerHTML:{__html:t.code?t.code:""}})},Ge=i.a.forwardRef((function(e,t){var n,r,o=e.ad,a=e.element,u=e.setAdData,l=e.setAd,c=e.goToStep,f=e.visible,d=e.zIndex;if(a.type!==s.ElementTypeEnum.ELEMENT)return a.type===s.ElementTypeEnum.CONTAINER?a.subType===s.ContainerSubTypeEnum.BUTTON_GROUP?i.a.createElement(He,{ad:o,key:"el_"+a.id,el:a,setAd:l,setAdData:u,goToStep:c,visible:f,zIndex:d}):i.a.createElement(Ce,{ref:t,ad:o,key:"el_"+a.id,el:a,setAd:l,setAdData:u,goToStep:c,visible:f,zIndex:d}):null;switch(a.subType){case s.ElementSubTypeEnum.INPUT:return i.a.createElement(ze,{key:"el_"+a.id,ad:o,el:a,errorMessage:null===(r=null===(n=o.errors)||void 0===n?void 0:n.find((function(e){return e.field===a.id})))||void 0===r?void 0:r.errorMessage,setAd:l,goToStep:c,setAdData:u,visible:f,zIndex:d});case s.ElementSubTypeEnum.BUTTON:return i.a.createElement(xe,{ad:o,key:"el_"+a.id,el:a,setAd:l,setAdData:u,goToStep:c,visible:f,zIndex:d});case s.ElementSubTypeEnum.CLOSE:return i.a.createElement(ke,{ad:o,key:"el_"+a.id,el:a,setAd:l,setAdData:u,goToStep:c,visible:f,zIndex:d});case s.ElementSubTypeEnum.IMAGE:return i.a.createElement(Ve,{key:"el_"+a.id,el:a,visible:f,zIndex:d});case s.ElementSubTypeEnum.CUSTOM_HTML:return i.a.createElement(We,{key:"el_"+a.id,el:a,visible:f,zIndex:d});case s.ElementSubTypeEnum.TEXT:default:return i.a.createElement(Be,{key:"el_"+a.id,el:a,visible:f,zIndex:d})}})),$e=function(e){for(var t=e[0],n=0,r=e;n<r.length;n++){var i=r[n];if(!(document.documentElement.clientWidth>s.availableViewports[i].width))break;t=i}return t},qe=function(){return(qe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ye=function(e){var t=e.step,n=(e.fontUrl,e.elementsFlat),o=e.topLevelElementIds,a=e.ad,u=e.e,l=e.innerWrapperStyle,c=(e.isLoaded,e.frameContext),f=e.dimensions,d=e.setAd,p=e.setAdData,m=e.goToStep,g=e.updateTopLevelFullscreenStatus,v=e.setForcedHeight,y=e.zIndex,b=i.a.createRef(),w=Object(r.useState)(),E=w[0],T=w[1],_=function(e,t){a.styles=e};return Object(r.useEffect)((function(){var e=function(){var e=h(u,$e(a.ad.viewports),a.ad.viewports,!1);(null==b?void 0:b.current)&&b.current.scrollHeight&&b.current.clientHeight&&b.current.scrollWidth&&b.current.clientWidth&&(("column"===e.normal.flexDirection||"column-reverse"===e.normal.flexDirection)&&(b.current.scrollHeight||0)>(b.current.clientHeight||0)||("row"===e.normal.flexDirection||"row-reverse"===e.normal.flexDirection)&&(b.current.scrollWidth||0)>(b.current.clientWidth||0)?T(!0):T(!1))};return window.addEventListener("resize",e,!0),e(),function(){window.removeEventListener("resize",e,!0)}})),Object(r.useEffect)((function(){var e=!1;t===a.currentStep&&b.current&&b.current.offsetHeight>=window.innerHeight&&b.current.offsetWidth>=window.innerWidth-40&&(e=!0),g(u.id,e)}),[b.current,a.currentStep,a.visible]),Object(r.useEffect)((function(){setTimeout((function(){var e=c.document.body.querySelector("#el_"+u.id).scrollHeight;e>0&&v(e)}),0)}),[f]),i.a.createElement(i.a.Fragment,null,i.a.createElement("style",null,"input,button {border-color: transparent; border-width: none; outline: red; background-color:transparent}","input {-webkit-appearance: none; -webkit-border-radius:0; border-radius: 0}",n.map((function(e){return $(a.ad.viewports,e,{},a.styles,_,o.includes(e.id))})).join("\n\n"),u.elements.map((function(e){if(e.type===s.ElementTypeEnum.CONTAINER)for(var t in e.styles)for(var n in e.styles[t])"absolute"===e.styles[t][n].position&&(e.styles[t][n].position="fixed")})),"#el_"+u.id+" {\n          "+G(l.important,!0)+"\n\n          "+G(l.notImportant)+"\n        }",E&&"\n          #el_"+u.id+" {\n            justify-content: flex-start !important;\n          }\n        ",".has_error {\n            "+G(qe({},s.DEFAULT_INPUT_ERROR_STYLES),!0)+"\n          }\n          \n          .error_message {\n          "+G(qe({},s.DEFAULT_INPUT_ERROR_STYLES.eiErrorMessage))+"\n        }",a.ad.inputErrorStyles&&".has_error {\n            "+G(qe({},a.ad.inputErrorStyles),!0)+"\n          }\n          \n          .error_message {\n          "+G(qe({},a.ad.inputErrorStyles.eiErrorMessage))+"\n        }"),i.a.createElement("style",null,a.styles&&a.styles.join(" ")),i.a.createElement(Ge,{ref:b,ad:a,element:u,setAd:d,setAdData:p,goToStep:m,visible:a.visible&&a.currentStep===t,zIndex:y}))},Qe=function(e,t){var n;return function(){clearTimeout(n),n=setTimeout((function(){n=null,e()}),t)}},Ke=function(e){for(var t in e)""===e[t]&&delete e[t];return e},Xe=n(20),Je=n.n(Xe),Ze=function(){return(Ze=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},et=new(function(){function e(){this.queue=[],this.isRunning=!1}return e.prototype.createIframe=function(){var e=document.createElement("iframe");return e.id="exitintel-preloader-"+(new Date).valueOf(),e.style.width="0px",e.style.height="0px",e.style.visibility="hidden",document.body.appendChild(e),e},e.prototype.removeIframe=function(e){e.remove()},e.prototype.add=function(e){var t=this;return new Promise((function(n,r){t.queue.push({spec:e,resolve:n,reject:r}),t.start.call(t)}))},e.prototype.start=function(){this.isRunning||this.process(),this.isRunning=!0},e.prototype.process=function(){var e=this,t=this.queue.shift();t?new Promise((function(n,r){var i=e.createIframe(),o=function(){i.remove(),n()},a=setTimeout((function(){console.warn("font timeout"),o()}),5e3);Je.a.load(Ze(Ze({context:i.contentWindow},t.spec),{events:!0,active:function(){clearTimeout(a),t.resolve(),setTimeout(o,11)},inactive:function(){clearTimeout(a),t.resolve(),setTimeout(o,10)}}))})).finally(this.process.bind(this)):this.isRunning=!1},e}()),tt=function(e){return et.add({classes:!1,typekit:{id:e}})},nt=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function u(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}l((r=r.apply(e,t||[])).next())}))},rt=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},it=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,u=o.length;a<u;a++,i++)r[i]=o[a];return r},ot=["position","width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","bottom","right","margin","boxShadow","animationName","animationDuration","animationDelay","pointerEvents"],at=i.a.forwardRef((function(e,t){var n=e.ad,o=e.setAd,a=e.setAdData,f=e.goToStep,d=e.updateTopLevelFullscreenStatus,p=(e.setFlexModeOverride,e.isLoaded),m=[],g=[],v=function(e,t){g[t.id]=e},y=[];n.ad.steps.forEach((function(e,t){m=m.concat(b(e.elements)),y.push({step:t,areFontsLoaded:!1})}));var E=n.ad.steps.map((function(e){return e.elements})).reduce((function(e,t){return e.concat(t)}),[]).map((function(e){return e.id}));m.map((function(e){$(n.ad.viewports,e,{},n.styles,v)}));var _=Object(r.useRef)(null),S=n.ad.fonts?c(n.ad.fonts):void 0,x=Object(r.useState)({height:window.innerHeight,width:window.innerWidth}),k=x[0],C=x[1],A=Object(r.useState)(),O=A[0],P=A[1],N=Object(r.useState)(void 0),I=N[0],R=N[1],M=Object(r.useState)(y),L=M[0],D=M[1],U=[],j=function(e,t){e.animationName&&(e.animationName+="_"+t),e.animationDuration&&(e.animationDuration+="s"),e.animationDelay&&(e.animationDelay+="s")};Object(r.useEffect)((function(){var e=Qe((function(){P(0),C({height:window.innerHeight,width:window.innerWidth})}),300);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),Object(r.useEffect)((function(){var e=!1;function t(t){return nt(this,void 0,void 0,(function(){var r,i,o,a,u,l,c;return rt(this,(function(f){switch(f.label){case 0:return f.trys.push([0,7,,8]),n.ad.fonts.filter((function(e){return e.provider===s.FontProvider.GOOGLE})).length>0?[4,et.add({classes:!1,context:I[t].window,google:{families:n.ad.fonts.filter((function(e){return!e.provider||e.provider===s.FontProvider.GOOGLE})).map((function(e){var t;return e.family.replace(/,[^,]*$/,"")+(e.variants?":"+(null===(t=e.variants)||void 0===t?void 0:t.join(",")):"")}))}})]:[3,2];case 1:f.sent(),f.label=2;case 2:if(!((r=n.ad.fonts.filter((function(e){return e.provider===s.FontProvider.ADOBE})).map((function(e){var t;return null===(t=e.adobeVariants)||void 0===t?void 0:t.map((function(e){return e.typekitId}))})).flat())&&r.length>0))return[3,6];i=Array.from(new Set(r)),o=0,a=i,f.label=3;case 3:return o<a.length?(u=a[o],[4,et.add({context:I[t].window,classes:!1,typekit:{id:u}})]):[3,6];case 4:f.sent(),f.label=5;case 5:return o++,[3,3];case 6:return e||(l=it(L),l.find((function(e){return e.step===parseInt(t)})).areFontsLoaded=!0,D(l)),[3,8];case 7:return c=f.sent(),console.error("Preloading of fonts failed: "+c),[3,8];case 8:return[2]}}))}))}return I&&function(e){nt(this,void 0,void 0,(function(){var n,r;return rt(this,(function(i){switch(i.label){case 0:n=0,r=Object.keys(e),i.label=1;case 1:return n<r.length?[4,t(r[n])]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))}(I),setTimeout((function(){var e=it(L);e.forEach((function(e){return e.areFontsLoaded=!0})),D(e)}),1e3),function(){e=!0}}),[I]);var F=function(e,t){var n,r=W(e.normal);if(r.transformParts.length>0){t.transform?t.transform=r.transformParts.concat([t.transform]).join(" "):t.transform=r.transformParts.join(" ");for(var i=0,o=ot;i<o.length;i++){var a=o[i];r.style[a]&&(t[a]=(null===(n=r.style[a])||void 0===n?void 0:n.toString())||"")}}},z=function(e,t,n){e.renderOutsideIframe&&t.normal.overflow?n.important.overflow=t.normal.overflow:n.important.overflow="auto"},B=function(e){n.flexModeOverride&&(e.important.justifyContent="flex-start")},V=function(e){return"@media (min-width: "+(0===n.ad.viewports.indexOf(e)?"0":s.availableViewports[e].breakpointStart)+"px)"},H=function(e){e.height&&"auto"!==e.height||(e.height=O+"px !important")},q=function(e){var t=L.find((function(t){return t.step===e}));return t&&t.areFontsLoaded?"visible":"hidden"};return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{display:n.visible?"block":"none"},key:"exitintel_ad_"+n.ad.id,ref:function(e){e&&(_.current=e,"function"==typeof t?t(e):t&&(t.current=e))}},n.ad.steps.map((function(e,t){var s=t;return i.a.createElement("div",{className:"step "+(n.currentStep===t?"current-step":""),key:"exitintel_step_"+e.id||!1,style:{display:n.currentStep===t?"block":"none"}},e.elements.map((function(t,c){for(var v,y=function(e){var t={important:{},notImportant:{}};return t.important.position=e.renderOutsideIframe?"absolute":"fixed",t.important.left=0,t.important.top=0,t.important.bottom=0,t.important.right=0,t.important.margin=0,t.important.width="100%",t.important.minHeight="100%",t.important.overflow="auto",t.important.animationName="none",t.notImportant.transform="none",t}(t),b=[],_=0,x=n.ad.viewports;_<x.length;_++){var C=x[_],A={};A.zIndex=81e6-c;for(var O=h(t,C,n.ad.viewports,!1),N=0,M=ot;N<M.length;N++){var L=M[N];t.renderOutsideIframe&&"boxShadow"===L||(A[L]=(null===(v=O.normal[L])||void 0===v?void 0:v.toString())||"")}F(O,A),T(A),Ke(A),A.transform||(A.transform="translate(0px, 0px)"),A.animationName&&(w.includes(A.animationName)?b.push("\n                      "+V(C)+" { \n                        #wrapper_"+n.ad.id+"_"+t.id+".animation-finished { \n                          opacity: 0; \n                        } \n                      }"):b.push("\n                      "+V(C)+" { \n                        #wrapper_"+n.ad.id+"_"+t.id+".animation-not-started { \n                          opacity: 0; \n                        } \n                      }")),j(A,t.id),z(t,O,y),B(y),A.transform||(A.transform="translate(0px, 0px)"),"fixed"!==n.ad.displayMethod?A.position="relative":A.position="fixed",H(A),b.push("\n                    "+V(C)+" { \n                      #wrapper_"+n.ad.id+"_"+t.id+" { \n                        "+G(A)+" \n                      } \n                    }")}var D=function(r){return U.push({step:s,context:r}),i.a.createElement(Ye,{step:s,ad:n,fontUrl:S,e:t,elementsFlat:m,topLevelElementIds:E,setAd:o,setAdData:a,goToStep:f,updateTopLevelFullscreenStatus:d,innerWrapperStyle:y,isLoaded:p,frameContext:r,setForcedHeight:P,dimensions:k,zIndex:e.elements.length-c})},W=Object(r.useState)(Z.NOT_STARTED),$=W[0],Y=W[1];return i.a.createElement("div",{key:"wrapper_"+t.id},i.a.createElement("style",null,g[t.id]),i.a.createElement("div",{id:"wrapper_"+n.ad.id+"_"+t.id,style:{animationPlayState:n.visible&&n.currentStep===s?"running":"paused"},onAnimationStart:function(e){e.stopPropagation(),Y(Z.RUNNING)},onAnimationEnd:function(e){e.stopPropagation(),Y(Z.FINISHED)},className:"animation-"+$},i.a.createElement("style",{id:"wrapper-style"},b.map((function(e){return e}))),t.renderOutsideIframe?D(window):i.a.createElement(l.a,{key:"frame_"+t.id,style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",border:0,visibility:q(s)},contentDidMount:function(){return function(){for(var e={},t=0,n=U;t<n.length;t++){var r=n[t];e[r.step]||(e[r.step]={}),e[r.step]=r.context}I||R(e)}()}},i.a.createElement(u.FrameContextConsumer,null,(function(e){return D(e)})))))})))}))),n.visible&&i.a.createElement("style",null,n.ad.codeSnippets&&n.ad.codeSnippets.filter((function(e){return e.type===s.CodeSnippetType.CSS})).map((function(e){return e.code})).join(" ")))})),ut=n(21),lt=n.n(ut),st=function(e){e.forEach((function e(t){t&&t.type&&t.type===s.ElementTypeEnum.ELEMENT&&(t.label=function(e){var t="";if(e.label&&""!==e.label)return t=e.label;switch(e.subType){case s.ElementSubTypeEnum.BUTTON||s.ElementSubTypeEnum.TEXT:t=e.content&&""!==e.content?e.content:e.subType===s.ElementSubTypeEnum.BUTTON?"Button":"Text";break;case s.ElementSubTypeEnum.INPUT:t=e.placeholder&&""!==e.placeholder?e.placeholder:"Input";break;case s.ElementSubTypeEnum.CLOSE:t="Close button";break;case s.ElementSubTypeEnum.IMAGE:t="Image";break;case s.ElementSubTypeEnum.CUSTOM_HTML:t="custom-html"}return t}(t)),t.elements&&Array.isArray(t.elements)&&t.elements.forEach(e)}))},ct=(Fe=function(e,t){return(Fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Fe(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),ft=function(){return(ft=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},dt=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function u(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}l((r=r.apply(e,t||[])).next())}))},pt=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},ht=function(e){function t(t){var n=e.call(this,t)||this;return n.createPromiseForJSSnippet=function(e,t){return new Promise((function(r,i){new Function("ad","resolve","reject","isValidEmail","isValidPhoneNumber","setErrorMessage","resetErrors","goToStep","meta",t)(e,r,i,ee,te,re(e,n.setAd),ae(e,n.setAd),ie(e,n.goToStep),le(window.exitintel.campaign.get(e.campaignId)))}))},n.show=function(e){return dt(n,void 0,void 0,(function(){var t,n,r,i,o,a;return pt(this,(function(u){switch(u.label){case 0:return[4,this.preloadImages()];case 1:return u.sent(),[4,this.preloadAnimations()];case 2:return t=u.sent(),[4,this.preloadAcceptDeclineDialog()];case 3:return u.sent(),[4,this.preloadFonts()];case 4:if(u.sent(),n=[],this.state.ad.ad.codeSnippets&&(n=this.state.ad.ad.codeSnippets.filter((function(e){return e.type===s.CodeSnippetType.JAVASCRIPT})).map((function(e){return e.code}))),!(n&&n.length>0))return[3,12];u.label=5;case 5:u.trys.push([5,10,,11]),r=0,i=n,u.label=6;case 6:return r<i.length?(o=i[r],[4,this.createPromiseForJSSnippet(this.state.ad,o)]):[3,9];case 7:u.sent(),u.label=8;case 8:return r++,[3,6];case 9:return this.state.ad.visible=!0,this.setState({isPreloading:!0,isLoaded:!0,ad:ft(ft({},this.state.ad),{visible:!0,styles:t?[t.css]:[],currentStep:e||0})}),[3,11];case 10:throw a=u.sent(),new Error(a);case 11:return[3,13];case 12:this.state.ad.visible=!0,this.setState({isPreloading:!0,isLoaded:!0,ad:ft(ft({},this.state.ad),{visible:!0,styles:t?[t.css]:[],currentStep:e||0})}),u.label=13;case 13:return this.state.ad&&this.state.ad.ad&&this.state.ad.ad.googleAnalyticsEvent&&window.exitintel.integrations.ga.trackEvent(this.state.ad.ad.googleAnalyticsEvent.category||"Exit Intel",this.state.ad.ad.googleAnalyticsEvent.action||"Impression",this.state.ad.ad.googleAnalyticsEvent.label||this.state.ad.campaignTitle+" / "+this.state.ad.title,this.state.ad.ad.googleAnalyticsEvent.value||0),[2]}}))}))},n.hide=function(){n.state.ad.visible=!1,n.setState({ad:ft(ft({},n.state.ad),{visible:!1})})},n.preload=function(){return dt(n,void 0,void 0,(function(){var e;return pt(this,(function(t){switch(t.label){case 0:return[4,this.preloadImages()];case 1:return t.sent(),[4,this.preloadAnimations()];case 2:return e=t.sent(),[4,this.preloadAcceptDeclineDialog()];case 3:return t.sent(),[4,this.preloadFonts()];case 4:return t.sent(),this.setState({isLoaded:!0,ad:ft(ft({},this.state.ad),{styles:e?[e.css]:[]})}),[2]}}))}))},n.preloadImages=function(){var e=[];if(n.state.ad){var t=[];n.state.ad.ad.steps.forEach((function(e){t=t.concat(b(e.elements))}));var r=$e(n.state.ad.ad.viewports);t.map((function(e){if(e.image)return[e.image.id];var t=[],i=h(e,r,n.state.ad.ad.viewports,!1),o=i.normal.eiBackgroundImage,a=i.normal.display;return void 0!==o&&(void 0===a||void 0!==a&&"none"!==a)&&t.push(o.id),t})).reduce((function(e,t){return e.concat(t)}),[]).reduce((function(e,t){return e.includes(t)||e.push(t),e}),[]).forEach((function(t){var n=new Promise((function(e,n){var r=new Image;r.onload=function(){e("image with id="+t+" loaded")},r.src=m(t)}));e.push(n)}))}return Promise.all(e)},n.preloadAnimations=function(){return n.animationsLoadingPromise||(n.animationsLoadingPromise=new Promise((function(e,t){if(n.state.ad){var r=[];n.state.ad.ad.steps.forEach((function(e){r=r.concat(b(e.elements))}));var i=r.map((function(e){var t=[];return n.state.ad.ad.viewports.forEach((function(n){var r=e.styles[n].normal.animationName;void 0!==r&&t.push(r)})),t})).reduce((function(e,t){return e.concat(t)}),[]).reduce((function(e,t){return e.includes(t)||e.push(t),e}),[]);if(!i.length)return void e(null);var o=(a=i,u=n.state.ad.ad.id,window.exitintel.config.cdnURL+"/module/animations/?id="+a.join(",")+"&ad="+u);lt()(o).then((function(t){e(t.json())})).catch((function(){e(null)}))}else t("No ad found");var a,u}))),n.animationsLoadingPromise},n.updateTopLevelFullscreenStatus=function(e,t){var r=!1;n.setState((function(n){var i=n.topLevelElementsStatus.map((function(n){return n.elementId===e&&n.isFullScreen!==t&&(n.isFullScreen=t,r=!0),n}));return-1===i.findIndex((function(t){return t.elementId===e}))&&(i.push({elementId:e,isFullScreen:t}),r=!0),r?{topLevelElementsStatus:i}:null}))},n.goToStep=function(e){n.setState({ad:ft(ft({},n.state.ad),{currentStep:e})})},n.setFlexModeOverride=function(e){n.setState(ft(ft({},n.state),{ad:ft(ft({},n.state.ad),{flexModeOverride:e})}))},n.setAd=function(e){return n.setState({ad:e}),e},n.setAdData=function(e,t){var r=n.state.ad.data;r||(r=[]),n.setState({ad:ft(ft({},n.state.ad),{data:r.filter((function(t){return t.field!==e})).concat([{field:e,value:t}])})})},n.getAdData=function(e){var t,r=[];n.state.ad.ad.steps.forEach((function(e){r=r.concat(b(e.elements))}));var i=r.find((function(t){return t.type==s.ElementTypeEnum.ELEMENT&&t.subType===s.ElementSubTypeEnum.INPUT&&t.name===e}));return i?null===(t=n.state.ad.data.find((function(e){return e.field===i.id})))||void 0===t?void 0:t.value:null},n.rendererRef=r.createRef(),n.fontLoadingPromise=null,n.animationsLoadingPromise=null,st(t.ad.ad.steps),n.state={isPreloading:!0,ad:ft(ft({},t.ad),{visible:!1}),topLevelElementsStatus:[],isLoaded:!1,preventsScrolling:!1},n.show=n.show.bind(n),n.preload(),n}return ct(t,e),t.prototype.checkFullOverlay=function(){},t.prototype.componentDidMount=function(){return dt(this,void 0,void 0,(function(){return pt(this,(function(e){return this.checkFullOverlay(),[2]}))}))},t.prototype.componentDidUpdate=function(e,t){t.ad.visible===this.state.ad.visible&&t.ad.currentStep===this.state.ad.currentStep&&t.ad.preloaded===this.state.ad.preloaded&&t.topLevelElementsStatus===this.state.topLevelElementsStatus||this.checkFullOverlay(),this.rendererRef.current},t.prototype.preloadFonts=function(){return dt(this,void 0,void 0,(function(){var e=this;return pt(this,(function(t){return this.fontLoadingPromise||(this.fontLoadingPromise=dt(e,void 0,void 0,(function(){var e,t,n,r,i,o;return pt(this,(function(a){switch(a.label){case 0:return a.trys.push([0,7,,8]),this.state.ad.ad.fonts.filter((function(e){return e.provider===s.FontProvider.GOOGLE})).length>0?[4,(u=this.state.ad.ad.fonts,et.add({classes:!1,google:{families:u.filter((function(e){return!e.provider||e.provider===s.FontProvider.GOOGLE})).map((function(e){var t;return e.family.replace(/,[^,]*$/,"")+(e.variants?":"+(null===(t=e.variants)||void 0===t?void 0:t.join(",")):"")}))}}))]:[3,2];case 1:a.sent(),a.label=2;case 2:if(!((e=this.state.ad.ad.fonts.filter((function(e){return e.provider===s.FontProvider.ADOBE})).map((function(e){var t;return null===(t=e.adobeVariants)||void 0===t?void 0:t.map((function(e){return e.typekitId}))})).flat())&&e.length>0))return[3,6];t=Array.from(new Set(e)),n=0,r=t,a.label=3;case 3:return n<r.length?(i=r[n],[4,tt(i)]):[3,6];case 4:a.sent(),a.label=5;case 5:return n++,[3,3];case 6:return[3,8];case 7:return o=a.sent(),console.error("Preloading of fonts failed: "+o),[3,8];case 8:return[2]}var u}))}))),[2,this.fontLoadingPromise]}))}))},t.prototype.preloadAcceptDeclineDialog=function(){return dt(this,void 0,void 0,(function(){var e,t;return pt(this,(function(n){switch(n.label){case 0:return e=[],this.state.ad.ad.steps.forEach((function(t){e=e.concat(b(t.elements))})),t=e.filter((function(e){return e.type===s.ElementTypeEnum.ELEMENT&&e.subType===s.ElementSubTypeEnum.BUTTON})),t.filter((function(e){return e.actions&&e.actions.filter((function(e){return e.type===s.ButtonActionType.ACCEPT_DECLINE_PROMPT})).length>0})).length?[4,window.exitintel.asset.load("accept-decline-prompt.css")]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.render=function(){return this.state.ad&&this.state.isLoaded?r.createElement(at,{ref:this.rendererRef,ad:this.state.ad,setAd:this.setAd,setAdData:this.setAdData,goToStep:this.goToStep,updateTopLevelFullscreenStatus:this.updateTopLevelFullscreenStatus,isLoaded:this.state.isLoaded,setFlexModeOverride:this.setFlexModeOverride.bind(this)}):null},t}(r.Component),mt=function(e,t){var n=void 0;return a.a.render(r.createElement(ht,{ref:function(e){n=e},ad:e}),t),n};window.exitintel.ReactDOM=a.a,window.exitintel.rendererV3Bootstrap=mt}]);
            }
            window.exitintelLoaded = true;
        